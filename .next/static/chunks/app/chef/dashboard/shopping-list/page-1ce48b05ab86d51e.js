(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[372,8226],{12518:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>O});var s=r(95155),n=r(12115),a=r(90221),i=r(62177),o=r(55594),l=r(30285),d=r(17759),c=r(62523),u=r(88539),m=r(47262),h=r(85127),p=r(66695),f=r(87481),x=r(50172),g=r(94815),b=r(6273),j=r(34301),v=r(18763),y=r(77223),N=r(88390),A=r(6523),I=r(59576),C=r(56104),w=r(35317),S=r(55028);let D=(0,S.default)(()=>Promise.all([r.e(1345),r.e(4165)]).then(r.bind(r,54165)).then(e=>e.Dialog),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),E=(0,S.default)(()=>Promise.all([r.e(1345),r.e(4165)]).then(r.bind(r,54165)).then(e=>e.DialogContent),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),R=(0,S.default)(()=>Promise.all([r.e(1345),r.e(4165)]).then(r.bind(r,54165)).then(e=>e.DialogHeader),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),k=(0,S.default)(()=>Promise.all([r.e(1345),r.e(4165)]).then(r.bind(r,54165)).then(e=>e.DialogTitle),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),T=(0,S.default)(()=>Promise.all([r.e(1345),r.e(4165)]).then(r.bind(r,54165)).then(e=>e.DialogFooter),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),F=(0,S.default)(()=>Promise.all([r.e(1345),r.e(4165)]).then(r.bind(r,54165)).then(e=>e.DialogClose),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),U=o.Ik({name:o.Yj().min(1,{message:"Item name is required."}),quantity:o.au.number().min(.01,{message:"Quantity must be greater than 0."}),unit:o.Yj().min(1,{message:"Unit is required (e.g., kg, pcs, L)."}),estimatedCost:o.au.number().min(0,{message:"Estimated cost (per unit) must be non-negative."}),notes:o.Yj().optional(),menuId:o.Yj().optional(),eventId:o.Yj().optional()});function O(){let{user:e}=(0,I.A)(),[t,r]=(0,n.useState)([]),[o,S]=(0,n.useState)(!0),[O,_]=(0,n.useState)(!1),[M,P]=(0,n.useState)(!1),[L,B]=(0,n.useState)(null),{toast:z}=(0,f.dj)(),q=(0,i.mN)({resolver:(0,a.u)(U),defaultValues:{name:"",quantity:1,unit:"",estimatedCost:0,notes:"",menuId:"",eventId:""}});(0,n.useEffect)(()=>{if(!e){S(!1),r([]);return}S(!0);let t=(0,w.rJ)(C.db,"users",e.uid,"shoppingListItems"),s=(0,w.P)(t,(0,w.My)("createdAt","desc")),n=(0,w.aQ)(s,e=>{r(e.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt instanceof w.Dc?t.createdAt.toDate():t.createdAt?new Date(t.createdAt):void 0,updatedAt:t.updatedAt instanceof w.Dc?t.updatedAt.toDate():t.updatedAt?new Date(t.updatedAt):void 0}})),S(!1)},e=>{console.error("Error fetching shopping list items:",e),z({title:"Error",description:"Could not fetch shopping list items.",variant:"destructive"}),S(!1)});return()=>n()},[e,z]);let J=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;B(e),e?q.reset({name:e.name,quantity:e.quantity,unit:e.unit,estimatedCost:e.estimatedCost,notes:e.notes||"",menuId:e.menuId||"",eventId:e.eventId||""}):q.reset({name:"",quantity:1,unit:"",estimatedCost:0,notes:"",menuId:"",eventId:""}),P(!0)},Y=async t=>{if(!e)return void z({title:"Error",description:"You must be logged in.",variant:"destructive"});_(!0);let r={...t,chefId:e.uid,purchased:!!L&&L.purchased,updatedAt:(0,w.O5)()};try{if(L){let s=(0,w.H9)(C.db,"users",e.uid,"shoppingListItems",L.id);await (0,w.mZ)(s,r),z({title:"Item Updated",description:'"'.concat(t.name,'" has been updated.')})}else await (0,w.gS)((0,w.rJ)(C.db,"users",e.uid,"shoppingListItems"),{...r,createdAt:(0,w.O5)()}),z({title:"Item Added",description:'"'.concat(t.name,'" has been added.')});q.reset(),B(null),P(!1)}catch(e){console.error("Error saving shopping list item:",e),z({title:"Save Error",description:"Could not save item.",variant:"destructive"})}finally{_(!1)}},$=async r=>{if(!e)return;let s=t.find(e=>e.id===r);if(window.confirm('Are you sure you want to delete "'.concat(null==s?void 0:s.name,'"?'))){_(!0);try{await (0,w.kd)((0,w.H9)(C.db,"users",e.uid,"shoppingListItems",r)),z({title:"Item Deleted",description:'"'.concat(null==s?void 0:s.name,'" removed.'),variant:"destructive"})}catch(e){console.error("Error deleting item:",e),z({title:"Delete Error",description:"Could not delete item.",variant:"destructive"})}finally{_(!1)}}},G=async r=>{if(!e)return;let s=t.find(e=>e.id===r);if(s){let t=!s.purchased;_(!0);try{let s=(0,w.H9)(C.db,"users",e.uid,"shoppingListItems",r);await (0,w.mZ)(s,{purchased:t,updatedAt:(0,w.O5)()})}catch(e){console.error("Error updating purchased status:",e),z({title:"Update Error",description:"Could not update status.",variant:"destructive"})}finally{_(!1)}}},H=(0,n.useMemo)(()=>t.reduce((e,t)=>e+t.estimatedCost*t.quantity,0),[t]),V=(0,n.useMemo)(()=>t.filter(e=>!e.purchased).reduce((e,t)=>e+t.estimatedCost*t.quantity,0),[t]);return o?(0,s.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,s.jsx)(x.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-2",children:"Loading shopping list..."})]}):(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold flex items-center",children:[(0,s.jsx)(g.A,{className:"mr-3 h-8 w-8 text-primary"})," My Shopping List"]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)(l.$,{onClick:()=>{z({title:"Voice Note to Shopping List: Coming Soon!",description:"This feature will allow you to add items by speaking.",duration:5e3})},variant:"outline",disabled:O,children:[(0,s.jsx)(b.A,{className:"mr-2 h-5 w-5"})," Add via Voice Note"]}),(0,s.jsxs)(l.$,{onClick:()=>J(),disabled:O,children:[(0,s.jsx)(j.A,{className:"mr-2 h-5 w-5"})," Add New Item"]})]})]}),M&&(0,s.jsx)(D,{open:M,onOpenChange:e=>{O||P(e)},children:(0,s.jsxs)(E,{className:"sm:max-w-lg",children:[(0,s.jsx)(R,{children:(0,s.jsx)(k,{children:L?"Edit Item":"Add New Shopping List Item"})}),(0,s.jsx)(d.lV,{...q,children:(0,s.jsxs)("form",{onSubmit:q.handleSubmit(Y),className:"space-y-4 p-1",children:[(0,s.jsx)(d.zB,{control:q.control,name:"name",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Item Name"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g., Flour",...t})}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(d.zB,{control:q.control,name:"quantity",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Quantity"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{type:"number",step:"0.01",placeholder:"e.g., 2.5",...t})}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsx)(d.zB,{control:q.control,name:"unit",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Unit"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g., kg, pcs, L",...t})}),(0,s.jsx)(d.C5,{})]})}})]}),(0,s.jsx)(d.zB,{control:q.control,name:"estimatedCost",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Estimated Cost (per unit)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{type:"number",step:"0.01",placeholder:"e.g., 5.99",...t})}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsx)(d.zB,{control:q.control,name:"notes",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Notes (Optional)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(u.T,{placeholder:"e.g., Organic, brand preference",...t})}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(d.zB,{control:q.control,name:"menuId",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Link to Menu ID (Optional)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g., menuXYZ",...t})})]})}}),(0,s.jsx)(d.zB,{control:q.control,name:"eventId",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Link to Event ID (Optional)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g., event123",...t})})]})}})]}),(0,s.jsxs)(T,{children:[(0,s.jsx)(F,{asChild:!0,children:(0,s.jsx)(l.$,{type:"button",variant:"outline",disabled:O,children:"Cancel"})}),(0,s.jsx)(l.$,{type:"submit",disabled:O,children:O?(0,s.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}):L?"Save Changes":"Add Item"})]})]})})]})}),(0,s.jsxs)(p.Zp,{children:[(0,s.jsx)(p.aR,{children:(0,s.jsx)(p.ZB,{children:"Shopping Items"})}),(0,s.jsx)(p.Wu,{children:t.length>0?(0,s.jsxs)(h.XI,{children:[(0,s.jsx)(h.A0,{children:(0,s.jsxs)(h.Hj,{children:[(0,s.jsx)(h.nd,{className:"w-[50px]",children:"Done"}),(0,s.jsx)(h.nd,{children:"Item Name"}),(0,s.jsx)(h.nd,{className:"text-right",children:"Qty"}),(0,s.jsx)(h.nd,{children:"Unit"}),(0,s.jsx)(h.nd,{className:"text-right",children:"Est. Cost (Total)"}),(0,s.jsx)(h.nd,{children:"Notes"}),(0,s.jsx)(h.nd,{children:"Linked To"}),(0,s.jsx)(h.nd,{className:"text-right w-[120px]",children:"Actions"})]})}),(0,s.jsx)(h.BF,{children:t.map(e=>(0,s.jsxs)(h.Hj,{className:e.purchased?"bg-muted/50":"",children:[(0,s.jsx)(h.nA,{children:(0,s.jsx)(m.S,{checked:e.purchased,onCheckedChange:()=>G(e.id),"aria-label":e.purchased?"Mark as not purchased":"Mark as purchased",disabled:O})}),(0,s.jsx)(h.nA,{className:"font-medium ".concat(e.purchased?"line-through text-muted-foreground":""),children:e.name}),(0,s.jsx)(h.nA,{className:"text-right ".concat(e.purchased?"line-through text-muted-foreground":""),children:e.quantity}),(0,s.jsx)(h.nA,{className:"".concat(e.purchased?"line-through text-muted-foreground":""),children:e.unit}),(0,s.jsxs)(h.nA,{className:"text-right ".concat(e.purchased?"line-through text-muted-foreground":""),children:["$",(e.estimatedCost*e.quantity).toFixed(2)]}),(0,s.jsx)(h.nA,{className:"text-xs text-muted-foreground ".concat(e.purchased?"line-through":""),children:e.notes}),(0,s.jsxs)(h.nA,{className:"text-xs",children:[e.menuId&&(0,s.jsxs)("div",{children:["Menu: ",e.menuId.substring(0,6),"..."]}),e.eventId&&(0,s.jsxs)("div",{children:["Event: ",e.eventId.substring(0,6),"..."]}),!e.menuId&&!e.eventId&&(0,s.jsx)("span",{className:"text-muted-foreground/70",children:"N/A"})]}),(0,s.jsxs)(h.nA,{className:"text-right",children:[(0,s.jsxs)(l.$,{variant:"ghost",size:"icon",onClick:()=>J(e),className:"mr-1",disabled:O,children:[(0,s.jsx)(v.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Edit"})]}),(0,s.jsxs)(l.$,{variant:"ghost",size:"icon",onClick:()=>$(e.id),className:"text-destructive hover:text-destructive",disabled:O,children:[(0,s.jsx)(y.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Delete"})]})]})]},e.id))})]}):(0,s.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"Your shopping list is empty. Add some items to get started!"})}),t.length>0&&(0,s.jsxs)(p.wL,{className:"flex flex-col items-end space-y-2 pt-4 border-t",children:[(0,s.jsxs)("div",{className:"text-lg font-semibold flex items-center",children:[(0,s.jsx)(N.A,{className:"mr-1 h-5 w-5 text-green-600","data-ai-hint":"money cost"}),"Remaining Cost: $",V.toFixed(2)]}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center",children:[(0,s.jsx)(N.A,{className:"mr-1 h-4 w-4","data-ai-hint":"money cost"}),"Total Estimated Cost: $",H.toFixed(2)]})]})]}),(0,s.jsx)("div",{className:"flex justify-end mt-6",children:(0,s.jsxs)(l.$,{onClick:()=>{if(0===t.length)return void z({title:"No Data",description:"Shopping list is empty.",variant:"default"});let e=new Blob([["Name,Quantity,Unit,Estimated Cost (Total),Notes,Purchased,Menu ID,Event ID",...t.map(e=>['"'.concat(e.name.replace(/"/g,'""'),'"'),e.quantity,'"'.concat(e.unit.replace(/"/g,'""'),'"'),(e.estimatedCost*e.quantity).toFixed(2),'"'.concat((e.notes||"").replace(/"/g,'""'),'"'),e.purchased?"Yes":"No",'"'.concat((e.menuId||"").replace(/"/g,'""'),'"'),'"'.concat((e.eventId||"").replace(/"/g,'""'),'"')].join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(void 0!==r.download){let t=URL.createObjectURL(e);r.setAttribute("href",t),r.setAttribute("download","shopping_list.csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}z({title:"Export Successful",description:"Shopping list exported to CSV."})},variant:"outline",disabled:0===t.length||O,children:[(0,s.jsx)(A.A,{className:"mr-2 h-5 w-5"})," Export to CSV"]})})]})}},17759:(e,t,r)=>{"use strict";r.d(t,{C5:()=>b,MJ:()=>x,Rr:()=>g,eI:()=>p,lR:()=>f,lV:()=>d,zB:()=>u});var s=r(95155),n=r(12115),a=r(99708),i=r(62177),o=r(59434),l=r(85057);let d=i.Op,c=n.createContext({}),u=e=>{let{...t}=e;return(0,s.jsx)(c.Provider,{value:{name:t.name},children:(0,s.jsx)(i.xI,{...t})})},m=()=>{let e=n.useContext(c),t=n.useContext(h),{getFieldState:r,formState:s}=(0,i.xW)(),a=r(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...a}},h=n.createContext({}),p=n.forwardRef((e,t)=>{let{className:r,...a}=e,i=n.useId();return(0,s.jsx)(h.Provider,{value:{id:i},children:(0,s.jsx)("div",{ref:t,className:(0,o.cn)("space-y-2",r),...a})})});p.displayName="FormItem";let f=n.forwardRef((e,t)=>{let{className:r,...n}=e,{error:a,formItemId:i}=m();return(0,s.jsx)(l.J,{ref:t,className:(0,o.cn)(a&&"text-destructive",r),htmlFor:i,...n})});f.displayName="FormLabel";let x=n.forwardRef((e,t)=>{let{...r}=e,{error:n,formItemId:i,formDescriptionId:o,formMessageId:l}=m();return(0,s.jsx)(a.DX,{ref:t,id:i,"aria-describedby":n?"".concat(o," ").concat(l):"".concat(o),"aria-invalid":!!n,...r})});x.displayName="FormControl";let g=n.forwardRef((e,t)=>{let{className:r,...n}=e,{formDescriptionId:a}=m();return(0,s.jsx)("p",{ref:t,id:a,className:(0,o.cn)("text-sm text-muted-foreground",r),...n})});g.displayName="FormDescription";let b=n.forwardRef((e,t)=>{var r;let{className:n,children:a,...i}=e,{error:l,formMessageId:d}=m(),c=l?String(null!=(r=null==l?void 0:l.message)?r:""):a;return c?(0,s.jsx)("p",{ref:t,id:d,className:(0,o.cn)("text-sm font-medium text-destructive",n),...i,children:c}):null});b.displayName="FormMessage"},30285:(e,t,r)=>{"use strict";r.d(t,{$:()=>d,r:()=>l});var s=r(95155),n=r(12115),a=r(99708),i=r(74466),o=r(59434);let l=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:r,variant:n,size:i,asChild:d=!1,...c}=e,u=d?a.DX:"button";return(0,s.jsx)(u,{className:(0,o.cn)(l({variant:n,size:i,className:r})),ref:t,...c})});d.displayName="Button"},46893:(e,t,r)=>{Promise.resolve().then(r.bind(r,12518))},47262:(e,t,r)=>{"use strict";r.d(t,{S:()=>l});var s=r(95155),n=r(12115),a=r(76981),i=r(10518),o=r(59434);let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)(a.bL,{ref:t,className:(0,o.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...n,children:(0,s.jsx)(a.C1,{className:(0,o.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})})});l.displayName=a.bL.displayName},56104:(e,t,r)=>{"use strict";let s,n,a,i;r.d(t,{IG:()=>a,db:()=>i,j2:()=>n});var o=r(23915),l=r(93004),d=r(90858),c=r(35317);let u={apiKey:'"AIzaSyDNMNa2a-BFUlmQ6PAA2hAIA3j07dYQUWQ",',authDomain:'"findachef2.firebaseapp.com",',projectId:'"findachef2",',storageBucket:'"findachef2.firebasestorage.app",',messagingSenderId:'"738524307993",',appId:'"1:738524307993:web:780dbfa516d646154cc088",',measurementId:'ntId: "G-PFXWD80NBY"'};if(u.apiKey&&u.projectId||(console.error("CRITICAL FIREBASE CONFIG ERROR: NEXT_PUBLIC_FIREBASE_API_KEY or NEXT_PUBLIC_FIREBASE_PROJECT_ID is missing or undefined."),console.error("This will cause Firebase services (Auth, Firestore, Storage) to fail."),console.error("Ensure these are correctly set in your .env.local file (for local development) AND in your Vercel project environment variables (for deployment).")),console.log("Firebase Initializing with Project ID:",u.projectId||"MISSING/UNDEFINED"),console.log("Firebase Using API Key (first 5 chars):",u.apiKey?u.apiKey.substring(0,5)+"...":"API Key Not Found/Defined"),(0,o.Dk)().length)s=(0,o.Dk)()[0];else try{s=(0,o.Wp)(u)}catch(e){console.error("Firebase initializeApp error:",e)}s&&u.apiKey&&u.projectId?(n=(0,l.xI)(s),a=(0,d.c7)(s),i=(0,c.aU)(s)):(console.error("Firebase app was not properly initialized due to missing configuration. Other Firebase services (Auth, Storage, Firestore) will NOT be available."),n=null,a=null,i=null)},59434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>a});var s=r(52596),n=r(39688);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,s.$)(t))}},59576:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,AuthProvider:()=>d});var s=r(95155),n=r(93004),a=r(12115),i=r(56104),o=r(35317);let l=(0,a.createContext)(void 0);function d(e){let{children:t}=e,[r,d]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[m,h]=(0,a.useState)(!0),[p,f]=(0,a.useState)(!0),[x,g]=(0,a.useState)(!1),[b,j]=(0,a.useState)(!1),[v,y]=(0,a.useState)(!1),[N,A]=(0,a.useState)(!1),[I,C]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e;console.log("AuthContext: Setting up onAuthStateChanged listener.");let t=(0,n.hg)(i.j2,async t=>{if(console.log("AuthContext: onAuthStateChanged triggered. CurrentUser UID:",(null==t?void 0:t.uid)||null),u(null),g(!1),j(!1),y(!1),A(!1),C(!1),e&&(console.log("AuthContext: Cleaning up previous Firestore profile listener for old user or on logout."),e(),e=void 0),d(t),t){f(!0),console.log("AuthContext: User found (UID:",t.uid,"). Starting profile and claims loading.");let r=!1;try{console.log("AuthContext: Attempting to fetch ID token result with force refresh for UID:",t.uid);let e=await t.getIdTokenResult(!0);console.log("AuthContext: ID Token Claims for user",t.uid,":",e.claims),r=!!(e.claims&&!0===e.claims.admin),g(r),r?console.log("AuthContext: 'admin' custom claim IS TRUE for user:",t.uid):console.warn("AuthContext: 'admin' custom claim not found or not true for user:",t.uid,"Claims found:",e.claims)}catch(e){console.error("AuthContext: Error fetching ID token result for custom claims for UID:",t.uid,e),g(!1)}try{console.log("AuthContext: Setting up Firestore profile listener for UID:",t.uid);let s=(0,o.H9)(i.db,"users",t.uid);e=(0,o.aQ)(s,e=>{if(e.exists()){let s=e.data(),n={id:e.id,...s,createdAt:s.createdAt instanceof o.Dc?s.createdAt.toDate():s.createdAt?new Date(s.createdAt):void 0,updatedAt:s.updatedAt instanceof o.Dc?s.updatedAt.toDate():s.updatedAt?new Date(s.updatedAt):void 0};console.log("AuthContext: Firestore profile data loaded/updated for UID:",t.uid,"Role:",n.role),u(n);let a="chef"===n.role,i="customer"===n.role,l="admin"===n.role;console.log("AuthContext: Setting isChef based on role:",a),j(a),y(i),l&&!r?console.warn("AuthContext: User has 'admin' role in Firestore, but 'admin' custom claim is missing or false. Custom claims determine admin access."):!l&&r&&console.log("AuthContext: User has 'admin' custom claim, granting admin access. Firestore role is:",n.role),a?(A(n.isApproved||!1),C(n.isSubscribed||!1),console.log("AuthContext: Chef specific flags - Approved:",n.isApproved,"Subscribed:",n.isSubscribed)):(A(!1),C(!1))}else console.warn("AuthContext: No such user profile document in Firestore for UID:",t.uid),u(null),j(!1),y(!1),A(!1),C(!1);f(!1)},e=>{console.error("AuthContext: Error with Firestore profile snapshot listener for UID:",t.uid,e),u(null),j(!1),y(!1),A(!1),C(!1),f(!1)})}catch(e){console.error("AuthContext: Outer error setting up Firestore profile snapshot for UID:",t.uid,e),u(null),j(!1),y(!1),A(!1),C(!1),f(!1)}}else console.log("AuthContext: No current user (logged out). Resetting profile states."),f(!1);h(!1)});return()=>{console.log("AuthContext: Cleaning up onAuthStateChanged listener."),t(),e&&(console.log("AuthContext: Cleaning up profile onSnapshot listener on AuthProvider unmount."),e())}},[]),(0,s.jsx)(l.Provider,{value:{user:r,userProfile:c,loading:m||p,authLoading:m,profileLoading:p,isAdmin:x,isChef:b,isCustomer:v,isChefApproved:N,isChefSubscribed:I},children:t})}function c(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},62523:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var s=r(95155),n=r(12115),a=r(59434);let i=n.forwardRef((e,t)=>{let{className:r,type:n,...i}=e;return(0,s.jsx)("input",{type:n,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},66695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>i,aR:()=>o,wL:()=>u});var s=r(95155),n=r(12115),a=r(59434);let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});i.displayName="Card";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...n})});o.displayName="CardHeader";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});l.displayName="CardTitle";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...n})});d.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...n})});c.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...n})});u.displayName="CardFooter"},85057:(e,t,r)=>{"use strict";r.d(t,{J:()=>d});var s=r(95155),n=r(12115),a=r(40968),i=r(74466),o=r(59434);let l=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)(a.b,{ref:t,className:(0,o.cn)(l(),r),...n})});d.displayName=a.b.displayName},85127:(e,t,r)=>{"use strict";r.d(t,{A0:()=>o,BF:()=>l,Hj:()=>d,XI:()=>i,nA:()=>u,nd:()=>c});var s=r(95155),n=r(12115),a=r(59434);let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,a.cn)("w-full caption-bottom text-sm",r),...n})})});i.displayName="Table";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("thead",{ref:t,className:(0,a.cn)("[&_tr]:border-b",r),...n})});o.displayName="TableHeader";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,a.cn)("[&_tr:last-child]:border-0",r),...n})});l.displayName="TableBody",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,a.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...n})}).displayName="TableFooter";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("tr",{ref:t,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...n})});d.displayName="TableRow";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("th",{ref:t,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...n})});c.displayName="TableHead";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("td",{ref:t,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...n})});u.displayName="TableCell",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("caption",{ref:t,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",r),...n})}).displayName="TableCaption"},87481:(e,t,r)=>{"use strict";r.d(t,{dj:()=>m});var s=r(12115);let n=0,a=new Map,i=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function m(){let[e,t]=s.useState(d);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},88539:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});var s=r(95155),n=r(12115),a=r(59434);let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("textarea",{className:(0,a.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...n})});i.displayName="Textarea"}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7446,9352,4453,4602,65,1342,3336,8441,1684,7358],()=>t(46893)),_N_E=e.O()}]);