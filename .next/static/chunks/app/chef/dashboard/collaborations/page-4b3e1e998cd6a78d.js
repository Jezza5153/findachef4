(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5619],{5196:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},12318:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},12486:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},29854:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var a=r(95155),s=r(12115),i=r(66695),l=r(30285),o=r(91394),n=r(59576),c=r(56104),d=r(35317),u=r(87481),h=r(51154),m=r(54416),f=r(5196),p=r(12486);let x=(0,r(19946).A)("user-minus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var v=r(46973),g=r(12318),b=r(6874),y=r.n(b);function j(){let{user:e,userProfile:t}=(0,n.A)(),{toast:r}=(0,u.dj)(),[b,j]=(0,s.useState)([]),[w,N]=(0,s.useState)([]),[C,A]=(0,s.useState)([]),[k,q]=(0,s.useState)(!0),[E,R]=(0,s.useState)(null),H=(0,s.useCallback)(async t=>{if(!t||0===t.length)return[];let a=[];for(let s of t)if(s!==(null==e?void 0:e.uid))try{let e=(0,d.H9)(c.db,"users",s),t=await (0,d.x7)(e);t.exists()?a.push({id:t.id,...t.data()}):console.warn("Collaboration: Profile not found for ID: ".concat(s))}catch(e){console.error("Collaboration: Error fetching profile for ID ".concat(s,":"),e),r({title:"Error",description:"Could not fetch profile for ID ".concat(s,"."),variant:"destructive"})}return a},[null==e?void 0:e.uid,r]);(0,s.useEffect)(()=>{let a;if(!e||!t){q(!1),j([]),N([]),A([]);return}q(!0);try{let t=(0,d.H9)(c.db,"users",e.uid);a=(0,d.aQ)(t,async e=>{if(e.exists()){let t=e.data();try{let[e,r,a]=await Promise.all([H(t.incomingCollaborationRequests||[]),H(t.outgoingCollaborationRequests||[]),H(t.collaboratorIds||[])]);j(e),N(r),A(a)}catch(e){console.error("Error fetching related profiles:",e),r({title:"Data Load Error",description:"Could not load all collaboration details.",variant:"destructive"})}finally{q(!1)}}else console.warn("CollaborationsPage: Current user profile not found in Firestore."),q(!1)},e=>{console.error("Error listening to user profile for collaborations:",e),r({title:"Error",description:"Could not load real-time collaboration data.",variant:"destructive"}),q(!1)})}catch(e){console.error("Error setting up collaborations listener:",e),r({title:"Setup Error",description:"Failed to initialize collaboration tracking.",variant:"destructive"}),q(!1)}return()=>{a&&a()}},[e,null==t?void 0:t.id,H,r]);let M=async(a,s)=>{if(!e||!t)return void r({title:"Error",description:"User not authenticated.",variant:"destructive"});R(a);let i=(0,d.H9)(c.db,"users",e.uid),l=(0,d.H9)(c.db,"users",a);try{await (0,d.mZ)(i,{incomingCollaborationRequests:(0,d.C3)(a),collaboratorIds:"accept"===s?(0,d.hq)(a):(0,d.C3)(a),updatedAt:(0,d.O5)()}),await (0,d.mZ)(l,{outgoingCollaborationRequests:(0,d.C3)(e.uid),collaboratorIds:"accept"===s?(0,d.hq)(e.uid):(0,d.C3)(a),updatedAt:(0,d.O5)()}).catch(e=>console.warn("Client-side attempt to update target chef's collaboration list failed (expected if no direct write permission or CF not used):",e.message)),r({title:"Request ".concat("accept"===s?"Accepted":"Declined"),description:"You ".concat("accept"===s?"are now collaborators with":"have declined the request from"," the chef.")})}catch(e){console.error("Error ".concat(s,"ing collaboration request:"),e),r({title:"Error",description:"Could not ".concat(s," request. ").concat(e.message),variant:"destructive"})}finally{R(null)}},S=async a=>{if(!e||!t)return void r({title:"Error",description:"User not authenticated.",variant:"destructive"});R(a);let s=(0,d.H9)(c.db,"users",e.uid),i=(0,d.H9)(c.db,"users",a);try{await (0,d.mZ)(s,{outgoingCollaborationRequests:(0,d.C3)(a),updatedAt:(0,d.O5)()}),await (0,d.mZ)(i,{incomingCollaborationRequests:(0,d.C3)(e.uid),updatedAt:(0,d.O5)()}).catch(e=>console.warn("Client-side attempt to update target chef's incoming requests failed:",e.message)),r({title:"Request Cancelled",description:"Your collaboration request has been cancelled."})}catch(e){console.error("Error cancelling outgoing request:",e),r({title:"Error",description:"Could not cancel request. ".concat(e.message),variant:"destructive"})}finally{R(null)}},_=async a=>{if(!e||!t)return void r({title:"Error",description:"User not authenticated.",variant:"destructive"});if(!window.confirm("Are you sure you want to remove this collaborator? This will remove the collaboration for both chefs."))return;R(a);let s=(0,d.H9)(c.db,"users",e.uid),i=(0,d.H9)(c.db,"users",a);try{await (0,d.mZ)(s,{collaboratorIds:(0,d.C3)(a),updatedAt:(0,d.O5)()}),await (0,d.mZ)(i,{collaboratorIds:(0,d.C3)(e.uid),updatedAt:(0,d.O5)()}).catch(e=>console.warn("Client-side attempt to update target chef's collaborator list failed:",e.message)),r({title:"Collaborator Removed",description:"The chef has been removed from your collaborators."})}catch(e){console.error("Error removing collaborator:",e),r({title:"Error",description:"Could not remove collaborator. ".concat(e.message),variant:"destructive"})}finally{R(null)}},$=(e,r)=>{var s,n;return(0,a.jsxs)(i.Zp,{className:"shadow-md",children:[(0,a.jsxs)(i.Wu,{className:"pt-6 flex items-center space-x-4",children:[(0,a.jsxs)(o.eu,{className:"h-16 w-16",children:[(0,a.jsx)(o.BK,{src:e.profilePictureUrl||void 0,alt:e.name,"data-ai-hint":"chef portrait"}),(0,a.jsx)(o.q5,{children:(null==(s=e.name)?void 0:s.substring(0,2).toUpperCase())||"CH"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:null==(n=e.specialties)?void 0:n.slice(0,3).join(", ")})]})]}),(0,a.jsxs)(i.wL,{className:"flex justify-end space-x-2 p-4 border-t",children:["incoming"===r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.$,{size:"sm",variant:"outline",onClick:()=>M(e.id,"decline"),disabled:E===e.id||!(null==t?void 0:t.isAdmin),children:[E===e.id?(0,a.jsx)(h.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(m.A,{className:"h-4 w-4 mr-1"})," Decline"]}),(0,a.jsxs)(l.$,{size:"sm",onClick:()=>M(e.id,"accept"),disabled:E===e.id||!(null==t?void 0:t.isAdmin),children:[E===e.id?(0,a.jsx)(h.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(f.A,{className:"h-4 w-4 mr-1"})," Accept"]})]}),"outgoing"===r&&(0,a.jsxs)(l.$,{size:"sm",variant:"outline",onClick:()=>S(e.id),disabled:E===e.id||!(null==t?void 0:t.isAdmin),children:[E===e.id?(0,a.jsx)(h.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(p.A,{className:"h-4 w-4 mr-1"})," Cancel Request"]}),"collaborator"===r&&(0,a.jsxs)(l.$,{size:"sm",variant:"destructive",onClick:()=>_(e.id),disabled:E===e.id||!(null==t?void 0:t.isAdmin),children:[E===e.id?(0,a.jsx)(h.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(x,{className:"h-4 w-4 mr-1"})," Remove"]})]})]},e.id)};return(null==t?void 0:t.hasCompletedFirstCoOp)||(null==t?void 0:t.isAdmin)?!k||b.length||w.length||C.length?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-2",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold flex items-center",children:[(0,a.jsx)(v.A,{className:"mr-3 h-8 w-8 text-primary","data-ai-hint":"collaboration users"})," Manage Collaborations"]}),(0,a.jsx)(l.$,{asChild:!0,variant:"outline",children:(0,a.jsxs)(y(),{href:"/chef/dashboard/chefs",children:[(0,a.jsx)(g.A,{className:"mr-2 h-4 w-4"})," Find Chefs to Collaborate"]})})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{children:[(0,a.jsx)(i.ZB,{children:"Incoming Collaboration Requests"}),(0,a.jsx)(i.BT,{children:"Review requests from chefs who want to collaborate with you."})]}),(0,a.jsx)(i.Wu,{children:k&&0===b.length?(0,a.jsxs)("div",{className:"text-center p-4",children:[(0,a.jsx)(h.A,{className:"h-6 w-6 animate-spin text-primary"})," Loading requests..."]}):b.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(e=>$(e,"incoming"))}):(0,a.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"No incoming collaboration requests."})})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{children:[(0,a.jsx)(i.ZB,{children:"Outgoing Collaboration Requests"}),(0,a.jsx)(i.BT,{children:"Requests you've sent to other chefs."})]}),(0,a.jsx)(i.Wu,{children:k&&0===w.length?(0,a.jsxs)("div",{className:"text-center p-4",children:[(0,a.jsx)(h.A,{className:"h-6 w-6 animate-spin text-primary"})," Loading requests..."]}):w.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map(e=>$(e,"outgoing"))}):(0,a.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"No outgoing collaboration requests."})})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{children:[(0,a.jsx)(i.ZB,{children:"Your Collaborators"}),(0,a.jsx)(i.BT,{children:"Chefs you are currently collaborating with."})]}),(0,a.jsx)(i.Wu,{children:k&&0===C.length?(0,a.jsxs)("div",{className:"text-center p-4",children:[(0,a.jsx)(h.A,{className:"h-6 w-6 animate-spin text-primary"})," Loading collaborators..."]}):C.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map(e=>$(e,"collaborator"))}):(0,a.jsx)("p",{className:"text-muted-foreground text-center py-4",children:'You have no collaborators yet. Use the "Find Chefs" button to send requests!'})})]})]}):(0,a.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,a.jsx)(h.A,{className:"h-8 w-8 animate-spin text-primary"})," Loading collaboration data..."]}):(0,a.jsxs)("div",{className:"text-center py-10",children:[(0,a.jsx)(v.A,{className:"mx-auto h-12 w-12 text-muted-foreground","data-ai-hint":"collaboration icon"}),(0,a.jsx)("h2",{className:"mt-4 text-xl font-semibold",children:"Unlock Collaborations"}),(0,a.jsxs)("p",{className:"mt-2 text-muted-foreground",children:["The collaboration feature is unlocked after you successfully complete your first co-hosted event.",(0,a.jsx)("br",{})," This helps ensure all collaborating chefs have experience on the platform."]}),(0,a.jsx)(l.$,{asChild:!0,className:"mt-4",children:(0,a.jsx)(y(),{href:"/chef/dashboard/wall",children:"Post or Find Co-Host Events"})})]})}},39033:(e,t,r)=>{"use strict";r.d(t,{c:()=>s});var a=r(12115);function s(e){let t=a.useRef(e);return a.useEffect(()=>{t.current=e}),a.useMemo(()=>(...e)=>t.current?.(...e),[])}},46081:(e,t,r)=>{"use strict";r.d(t,{A:()=>l,q:()=>i});var a=r(12115),s=r(95155);function i(e,t){let r=a.createContext(t),i=e=>{let{children:t,...i}=e,l=a.useMemo(()=>i,Object.values(i));return(0,s.jsx)(r.Provider,{value:l,children:t})};return i.displayName=e+"Provider",[i,function(s){let i=a.useContext(r);if(i)return i;if(void 0!==t)return t;throw Error(`\`${s}\` must be used within \`${e}\``)}]}function l(e,t=[]){let r=[],i=()=>{let t=r.map(e=>a.createContext(e));return function(r){let s=r?.[e]||t;return a.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return i.scopeName=e,[function(t,i){let l=a.createContext(i),o=r.length;r=[...r,i];let n=t=>{let{scope:r,children:i,...n}=t,c=r?.[e]?.[o]||l,d=a.useMemo(()=>n,Object.values(n));return(0,s.jsx)(c.Provider,{value:d,children:i})};return n.displayName=t+"Provider",[n,function(r,s){let n=s?.[e]?.[o]||l,c=a.useContext(n);if(c)return c;if(void 0!==i)return i;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:a})=>{let s=r(e)[`__scope${a}`];return{...t,...s}},{});return a.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(i,...t)]}},46973:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("combine",[["path",{d:"M10 18H5a3 3 0 0 1-3-3v-1",key:"ru65g8"}],["path",{d:"M14 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"e30een"}],["path",{d:"M20 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"2ahx8o"}],["path",{d:"m7 21 3-3-3-3",key:"127cv2"}],["rect",{x:"14",y:"14",width:"8",height:"8",rx:"2",key:"1b0bso"}],["rect",{x:"2",y:"2",width:"8",height:"8",rx:"2",key:"1x09vl"}]])},51154:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},52712:(e,t,r)=>{"use strict";r.d(t,{N:()=>s});var a=r(12115),s=globalThis?.document?a.useLayoutEffect:()=>{}},54416:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},63655:(e,t,r)=>{"use strict";r.d(t,{hO:()=>n,sG:()=>o});var a=r(12115),s=r(47650),i=r(99708),l=r(95155),o=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let r=a.forwardRef((e,r)=>{let{asChild:a,...s}=e,o=a?i.DX:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(o,{...s,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function n(e,t){e&&s.flushSync(()=>e.dispatchEvent(t))}},85977:(e,t,r)=>{"use strict";r.d(t,{H4:()=>j,_V:()=>y,bL:()=>b});var a=r(12115),s=r(46081),i=r(39033),l=r(52712),o=r(63655),n=r(95155),c="Avatar",[d,u]=(0,s.A)(c),[h,m]=d(c),f=a.forwardRef((e,t)=>{let{__scopeAvatar:r,...s}=e,[i,l]=a.useState("idle");return(0,n.jsx)(h,{scope:r,imageLoadingStatus:i,onImageLoadingStatusChange:l,children:(0,n.jsx)(o.sG.span,{...s,ref:t})})});f.displayName=c;var p="AvatarImage",x=a.forwardRef((e,t)=>{let{__scopeAvatar:r,src:s,onLoadingStatusChange:c=()=>{},...d}=e,u=m(p,r),h=function(e,t){let[r,s]=a.useState("idle");return(0,l.N)(()=>{if(!e)return void s("error");let r=!0,a=new window.Image,i=e=>()=>{r&&s(e)};return s("loading"),a.onload=i("loaded"),a.onerror=i("error"),a.src=e,t&&(a.referrerPolicy=t),()=>{r=!1}},[e,t]),r}(s,d.referrerPolicy),f=(0,i.c)(e=>{c(e),u.onImageLoadingStatusChange(e)});return(0,l.N)(()=>{"idle"!==h&&f(h)},[h,f]),"loaded"===h?(0,n.jsx)(o.sG.img,{...d,ref:t,src:s}):null});x.displayName=p;var v="AvatarFallback",g=a.forwardRef((e,t)=>{let{__scopeAvatar:r,delayMs:s,...i}=e,l=m(v,r),[c,d]=a.useState(void 0===s);return a.useEffect(()=>{if(void 0!==s){let e=window.setTimeout(()=>d(!0),s);return()=>window.clearTimeout(e)}},[s]),c&&"loaded"!==l.imageLoadingStatus?(0,n.jsx)(o.sG.span,{...i,ref:t}):null});g.displayName=v;var b=f,y=x,j=g},91394:(e,t,r)=>{"use strict";r.d(t,{BK:()=>n,eu:()=>o,q5:()=>c});var a=r(95155),s=r(12115),i=r(85977),l=r(59434);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(i.bL,{ref:t,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...s})});o.displayName=i.bL.displayName;let n=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(i._V,{ref:t,className:(0,l.cn)("aspect-square h-full w-full",r),...s})});n.displayName=i._V.displayName;let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(i.H4,{ref:t,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...s})});c.displayName=i.H4.displayName},99630:(e,t,r)=>{Promise.resolve().then(r.bind(r,29854))}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7446,9352,5100,4602,6874,5845,8441,1684,7358],()=>t(99630)),_N_E=e.O()}]);