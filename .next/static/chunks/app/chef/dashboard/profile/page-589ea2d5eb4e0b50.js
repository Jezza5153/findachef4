(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4594],{27779:(e,t,l)=>{Promise.resolve().then(l.bind(l,43054))},43054:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>T});var a=l(95155),r=l(90221),o=l(62177),i=l(55594),s=l(30285),n=l(17759),d=l(62523),c=l(88539),u=l(66695),m=l(92593),p=l(12115),h=l(87481),f=l(66766),x=l(50172),g=l(28294),j=l(37607),b=l(50286),y=l(40157);let v=(0,y.A)("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);var C=l(57082);let A=(0,y.A)("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);var N=l(68718);let w=(0,y.A)("Images",[["path",{d:"M18 22H4a2 2 0 0 1-2-2V6",key:"pblm9e"}],["path",{d:"m22 13-1.296-1.296a2.41 2.41 0 0 0-3.408 0L11 18",key:"nf6bnh"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["rect",{width:"16",height:"16",x:"6",y:"2",rx:"2",key:"12espp"}]]);var I=l(59119),U=l(77223),S=l(90010),D=l(59576),R=l(56104),k=l(35317),P=l(90858),F=l(93004);let M=i.Ik({name:i.Yj().min(2,{message:"Name must be at least 2 characters."}),email:i.Yj().email({message:"Invalid email address."}),tagline:i.Yj().max(100,"Tagline cannot exceed 100 characters.").optional(),bio:i.Yj().min(20,{message:"Bio must be at least 20 characters."}).max(500,{message:"Bio cannot exceed 500 characters."}),specialties:i.Yj().min(1,{message:"Please list at least one specialty."}),profilePictureFile:i.Nl(File).optional().refine(e=>!e||e.size<=2097152,"Max file size is 2MB.").refine(e=>!e||["image/jpeg","image/png","image/webp"].includes(e.type),"Only JPG, PNG, WEBP files are allowed."),experienceSummary:i.Yj().optional(),education:i.Yj().max(2e3,"Education summary cannot exceed 2000 characters.").optional(),skills:i.Yj().optional(),portfolioItem1Url:i.Yj().url({message:"Invalid URL for portfolio item 1."}).optional().or(i.eu("")),portfolioItem1Caption:i.Yj().max(150,"Caption for item 1 cannot exceed 150 characters.").optional(),portfolioItem2Url:i.Yj().url({message:"Invalid URL for portfolio item 2."}).optional().or(i.eu("")),portfolioItem2Caption:i.Yj().max(150,"Caption for item 2 cannot exceed 150 characters.").optional(),teamName:i.Yj().optional()});function T(){let{user:e,userProfile:t,loading:l}=(0,D.A)(),[i,y]=(0,p.useState)(null),[T,B]=(0,p.useState)(null),[Y,z]=(0,p.useState)(null),[E,L]=(0,p.useState)(null),[J,V]=(0,p.useState)(null),[O,q]=(0,p.useState)(!0),[G,_]=(0,p.useState)(!1),{toast:H}=(0,h.dj)(),W=(0,o.mN)({resolver:(0,r.u)(M),defaultValues:{name:"",email:"",tagline:"",bio:"",specialties:"",experienceSummary:"",education:"",skills:"",portfolioItem1Url:"",portfolioItem1Caption:"",portfolioItem2Url:"",portfolioItem2Caption:"",teamName:""}});(0,p.useEffect)(()=>{let a=async()=>{if(e&&t){var l,a;y(t),W.reset({name:t.name||e.displayName||"",email:t.email||e.email||"",tagline:t.tagline||"",bio:t.bio||"",specialties:(null==(l=t.specialties)?void 0:l.join(", "))||"",experienceSummary:t.experienceSummary||"",education:t.education||"",skills:(null==(a=t.skills)?void 0:a.join(", "))||"",portfolioItem1Url:t.portfolioItem1Url||"",portfolioItem1Caption:t.portfolioItem1Caption||"",portfolioItem2Url:t.portfolioItem2Url||"",portfolioItem2Caption:t.portfolioItem2Caption||"",teamName:t.teamName||""}),B(t.profilePictureUrl||e.photoURL||null)}else e&&!t&&(W.reset({name:e.displayName||"",email:e.email||""}),B(e.photoURL||null));q(!1)};l||a()},[e,t,l,W]);let Z=e=>{var t;let l=null==(t=e.target.files)?void 0:t[0];if(l){W.setValue("profilePictureFile",l,{shouldValidate:!0}),z(l);let e=new FileReader;e.onloadend=()=>{B(e.result)},e.readAsDataURL(l)}},K=async l=>{if(!e)return void H({title:"Error",description:"You must be logged in to update your profile.",variant:"destructive"});_(!0);let a=(null==i?void 0:i.profilePictureUrl)||e.photoURL||"",r=(null==i?void 0:i.resumeFileUrl)||"";try{var o;if(Y){if((null==i?void 0:i.profilePictureUrl)&&i.profilePictureUrl.startsWith("https://firebasestorage.googleapis.com"))try{let e=(0,P.KR)(R.IG,i.profilePictureUrl);await (0,P.XR)(e).catch(e=>console.warn("Old profile pic not found or cannot be deleted:",e))}catch(e){console.warn("Error deleting old profile picture",e)}let t=Y.name.split(".").pop(),l="users/".concat(e.uid,"/profilePicture.").concat(t),r=(0,P.KR)(R.IG,l),o=(0,P.bp)(r,Y);await new Promise((e,t)=>{o.on("state_changed",null,e=>{console.error("Profile pic upload error",e),t(e)},async()=>{a=await (0,P.qk)(o.snapshot.ref),e()})})}if(E){if((null==i?void 0:i.resumeFileUrl)&&i.resumeFileUrl.startsWith("https://firebasestorage.googleapis.com"))try{let e=(0,P.KR)(R.IG,i.resumeFileUrl);await (0,P.XR)(e).catch(e=>console.warn("Old resume not found or cannot be deleted:",e))}catch(e){console.warn("Error deleting old resume file",e)}let t=E.name.split(".").pop()||"pdf",l="users/".concat(e.uid,"/resume.").concat(t),a=(0,P.KR)(R.IG,l),o=(0,P.bp)(a,E);await new Promise((e,t)=>{o.on("state_changed",null,e=>{console.error("Resume upload error",e),t(e)},async()=>{r=await (0,P.qk)(o.snapshot.ref),e()})})}let s={name:l.name,email:e.email,tagline:l.tagline,bio:l.bio,specialties:l.specialties.split(",").map(e=>e.trim()).filter(e=>e),profilePictureUrl:a,experienceSummary:(null==J?void 0:J.experience)||l.experienceSummary,education:(null==J?void 0:J.education)||l.education,skills:(null==J?void 0:J.skills)||(null==(o=l.skills)?void 0:o.split(",").map(e=>e.trim()).filter(e=>e))||[],portfolioItem1Url:l.portfolioItem1Url,portfolioItem1Caption:l.portfolioItem1Caption,portfolioItem2Url:l.portfolioItem2Url,portfolioItem2Caption:l.portfolioItem2Caption,resumeFileUrl:r,updatedAt:(0,k.O5)(),role:"chef",...(null==i?void 0:i.abn)&&{abn:i.abn},...(null==i?void 0:i.teamName)&&{teamName:i.teamName},...(null==i?void 0:i.teamId)&&{teamId:i.teamId},...(null==i?void 0:i.hasCompletedFirstCoOp)!==void 0&&{hasCompletedFirstCoOp:i.hasCompletedFirstCoOp},...(null==i?void 0:i.collaboratorIds)&&{collaboratorIds:i.collaboratorIds},...(null==i?void 0:i.incomingCollaborationRequests)&&{incomingCollaborationRequests:i.incomingCollaborationRequests},...(null==i?void 0:i.outgoingCollaborationRequests)&&{outgoingCollaborationRequests:i.outgoingCollaborationRequests},...(null==i?void 0:i.isApproved)!==void 0&&{isApproved:i.isApproved},...(null==i?void 0:i.isSubscribed)!==void 0&&{isSubscribed:i.isSubscribed},...(null==i?void 0:i.trustScore)!==void 0&&{trustScore:i.trustScore},...(null==i?void 0:i.trustScoreBasis)&&{trustScoreBasis:i.trustScoreBasis}};(null==i?void 0:i.createdAt)||(null==t?void 0:t.createdAt)||(s.createdAt=(0,k.O5)());let n=(0,k.H9)(R.db,"users",e.uid);await (0,k.BN)(n,s,{merge:!0}),(e.displayName!==l.name||a&&e.photoURL!==a)&&await (0,F.r7)(e,{displayName:l.name,photoURL:a}),y(t=>({...t,...s,id:e.uid,email:e.email})),z(null),L(null),H({title:"Profile Updated Successfully",description:"Your chef profile has been saved."})}catch(e){console.error("Error updating profile:",e),H({title:"Update Failed",description:"Could not save your profile. Please try again.",variant:"destructive"})}finally{_(!1)}};return l||O?(0,a.jsxs)("div",{className:"flex h-screen items-center justify-center",children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"})," Loading Profile..."]}):e?(0,a.jsx)("div",{className:"space-y-8",children:(0,a.jsxs)(u.Zp,{className:"shadow-lg",children:[(0,a.jsxs)(u.aR,{children:[(0,a.jsxs)(u.ZB,{className:"text-2xl font-bold flex items-center",children:[(0,a.jsx)(g.A,{className:"mr-3 h-7 w-7 text-primary","data-ai-hint":"user profile"})," Your Chef Profile"]}),(0,a.jsx)(u.BT,{children:"Manage your public-facing profile information, portfolio, and resume."})]}),(0,a.jsx)(u.Wu,{children:(0,a.jsx)(n.lV,{...W,children:(0,a.jsxs)("form",{onSubmit:W.handleSubmit(K),className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-start",children:[(0,a.jsxs)("div",{className:"md:col-span-1 flex flex-col items-center",children:[(0,a.jsx)(f.default,{src:T||"https://placehold.co/150x150.png",alt:W.getValues("name")||"Chef",width:150,height:150,className:"rounded-full object-cover shadow-md mb-4","data-ai-hint":"chef portrait",unoptimized:null==T?void 0:T.startsWith("blob:")},T),(0,a.jsx)(n.zB,{control:W.control,name:"profilePictureFile",render:()=>(0,a.jsxs)(n.eI,{className:"w-full",children:[(0,a.jsx)(n.MJ,{children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.p,{type:"file",accept:"image/jpeg,image/png,image/webp",onChange:Z,className:"hidden",id:"profilePictureUpdate",disabled:G}),(0,a.jsx)(s.$,{type:"button",variant:"outline",asChild:!0,className:"w-full",disabled:G,children:(0,a.jsxs)("label",{htmlFor:"profilePictureUpdate",className:"cursor-pointer flex items-center justify-center",children:[(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"})," Change Photo"]})})]})}),(0,a.jsx)(n.C5,{className:"text-center"})]})})]}),(0,a.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,a.jsx)(n.zB,{control:W.control,name:"name",render:e=>{let{field:t}=e;return(0,a.jsxs)(n.eI,{children:[(0,a.jsx)(n.lR,{children:"Full Name"}),(0,a.jsx)(n.MJ,{children:(0,a.jsx)(d.p,{placeholder:"e.g., Julia Child",...t,disabled:G})}),(0,a.jsx)(n.C5,{})]})}}),(0,a.jsx)(n.zB,{control:W.control,name:"email",render:e=>{let{field:t}=e;return(0,a.jsxs)(n.eI,{children:[(0,a.jsx)(n.lR,{children:"Email Address"}),(0,a.jsx)(n.MJ,{children:(0,a.jsx)(d.p,{type:"email",placeholder:"you@example.com",...t,readOnly:!0,disabled:!0})}),(0,a.jsx)(n.C5,{})]})}}),(0,a.jsx)(n.zB,{control:W.control,name:"tagline",render:e=>{let{field:t}=e;return(0,a.jsxs)(n.eI,{children:[(0,a.jsx)(n.lR,{children:"Tagline / Professional Title"}),(0,a.jsx)(n.MJ,{children:(0,a.jsx)(d.p,{placeholder:"e.g., Master of French Cuisine, Private Chef",...t,disabled:G})}),(0,a.jsx)(n.Rr,{children:"A short, catchy title for your profile."}),(0,a.jsx)(n.C5,{})]})}})]})]}),(0,a.jsx)(n.zB,{control:W.control,name:"bio",render:e=>{let{field:t}=e;return(0,a.jsxs)(n.eI,{children:[(0,a.jsx)(n.lR,{children:"Short Bio"}),(0,a.jsx)(n.MJ,{children:(0,a.jsx)(c.T,{placeholder:"Tell us about your culinary passion...",className:"min-h-[100px]",...t,disabled:G})}),(0,a.jsx)(n.Rr,{children:"This will be shown on your public profile. Max 500 characters."}),(0,a.jsx)(n.C5,{})]})}}),(0,a.jsx)(n.zB,{control:W.control,name:"specialties",render:e=>{let{field:t}=e;return(0,a.jsxs)(n.eI,{children:[(0,a.jsx)(n.lR,{children:"Specialties / Cuisine Types (Tags)"}),(0,a.jsx)(n.MJ,{children:(0,a.jsx)(d.p,{placeholder:"e.g., Italian, French, Pastry",...t,disabled:G})}),(0,a.jsx)(n.Rr,{children:"Comma-separated list of your culinary specialties."}),(0,a.jsx)(n.C5,{})]})}}),(0,a.jsxs)("div",{className:"pt-4 border-t",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[(0,a.jsx)(b.A,{className:"mr-2 h-5 w-5 text-primary","data-ai-hint":"team users"})," Team Affiliation"]}),(0,a.jsx)(n.zB,{control:W.control,name:"teamName",render:e=>{let{field:t}=e;return(0,a.jsxs)(n.eI,{children:[(0,a.jsx)(n.lR,{children:"Current Chef Alliance / Collaboration Group"}),(0,a.jsx)(n.MJ,{children:(0,a.jsx)(d.p,{...t,readOnly:!0,disabled:!0,placeholder:"Not part of an alliance"})}),(0,a.jsx)(n.Rr,{children:"Indicate if you're part of a regular Chef Alliance or Collaboration Group. This helps in co-hosting and showcasing joint event types. (Full alliance management features are planned for the future)."}),(0,a.jsx)(n.C5,{})]})}})]}),(0,a.jsxs)("div",{className:"pt-4 border-t",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[(0,a.jsx)(v,{className:"mr-2 h-5 w-5 text-primary","data-ai-hint":"education cap"})," Education"]}),(0,a.jsx)(n.zB,{control:W.control,name:"education",render:e=>{let{field:t}=e;return(0,a.jsxs)(n.eI,{children:[(0,a.jsx)(n.MJ,{children:(0,a.jsx)(c.T,{placeholder:"Your education summary will appear here (from resume or manual input)...",className:"min-h-[80px] bg-muted/30",...t,disabled:G})}),(0,a.jsx)(n.Rr,{children:"This field can be auto-filled by resume parsing or edited manually."}),(0,a.jsx)(n.C5,{})]})}})]}),(0,a.jsxs)("div",{className:"pt-4 border-t",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[(0,a.jsx)(C.A,{className:"mr-2 h-5 w-5 text-primary","data-ai-hint":"work briefcase"})," Experience Summary"]}),(0,a.jsx)(n.zB,{control:W.control,name:"experienceSummary",render:e=>{let{field:t}=e;return(0,a.jsxs)(n.eI,{children:[(0,a.jsx)(n.MJ,{children:(0,a.jsx)(c.T,{placeholder:"Your professional experience summary will appear here after resume parsing...",className:"min-h-[120px] bg-muted/30",...t,disabled:G})}),(0,a.jsx)(n.Rr,{children:"This field can be auto-filled by resume parsing or edited manually."}),(0,a.jsx)(n.C5,{})]})}})]}),(0,a.jsxs)("div",{className:"pt-4 border-t",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[(0,a.jsx)(A,{className:"mr-2 h-5 w-5 text-primary","data-ai-hint":"idea lightbulb"})," Skills"]}),(0,a.jsx)(n.zB,{control:W.control,name:"skills",render:e=>{let{field:t}=e;return(0,a.jsxs)(n.eI,{children:[(0,a.jsx)(n.MJ,{children:(0,a.jsx)(d.p,{placeholder:"Your skills will appear here, comma-separated...",className:"bg-muted/30",...t,disabled:G})}),(0,a.jsx)(n.Rr,{children:"This field can be auto-filled by resume parsing or edited manually. Comma-separated."}),(0,a.jsx)(n.C5,{})]})}})]}),(0,a.jsxs)("div",{className:"pt-4 border-t",children:[(0,a.jsxs)(s.$,{type:"button",variant:"outline",size:"sm",className:"w-full sm:w-auto mb-4",onClick:()=>{(null==i?void 0:i.resumeFileUrl)?window.open(i.resumeFileUrl,"_blank"):H({title:"Resume Not Available",description:"No resume file has been uploaded yet.",variant:"default"})},disabled:!(null==i?void 0:i.resumeFileUrl)||G,children:[(0,a.jsx)(N.A,{className:"mr-2 h-4 w-4"})," Download Current Resume"]}),(0,a.jsx)(m.X,{onResumeParsed:e=>{var t;V(e.parsedData),W.setValue("experienceSummary",e.parsedData.experience||"",{shouldValidate:!0}),W.setValue("skills",(null==(t=e.parsedData.skills)?void 0:t.join(", "))||"",{shouldValidate:!0}),e.parsedData.education&&W.setValue("education",e.parsedData.education,{shouldValidate:!0}),L(e.file),H({title:"Resume Processed",description:"Resume details populated. Save profile to upload the new file."})},initialData:J||void 0})]}),(0,a.jsxs)("div",{className:"pt-4 border-t",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,a.jsx)(w,{className:"mr-2 h-5 w-5 text-primary","data-ai-hint":"gallery images"})," Portfolio (Max 2 items)"]}),(0,a.jsx)("div",{className:"space-y-6",children:[1,2].map(e=>(0,a.jsxs)("div",{className:"p-4 border rounded-md shadow-sm bg-muted/20 space-y-4",children:[(0,a.jsxs)("h4",{className:"font-medium text-md",children:["Portfolio Item ",e]}),(0,a.jsx)(n.zB,{control:W.control,name:"portfolioItem".concat(e,"Url"),render:e=>{let{field:t}=e;return(0,a.jsxs)(n.eI,{children:[(0,a.jsx)(n.lR,{children:"Image URL"}),(0,a.jsx)(n.MJ,{children:(0,a.jsx)(d.p,{placeholder:"https://example.com/your-dish.jpg",...t,disabled:G})}),(0,a.jsx)(n.C5,{})]})}}),W.watch("portfolioItem".concat(e,"Url"))&&(0,a.jsx)(f.default,{src:W.watch("portfolioItem".concat(e,"Url"))||"https://placehold.co/300x200.png",alt:"Portfolio Item ".concat(e," Preview"),width:300,height:200,className:"rounded-md object-cover border shadow-sm","data-ai-hint":"food photography",onError:e=>{e.target.src="https://placehold.co/300x200.png?text=Invalid+URL"}}),(0,a.jsx)(n.zB,{control:W.control,name:"portfolioItem".concat(e,"Caption"),render:e=>{let{field:t}=e;return(0,a.jsxs)(n.eI,{children:[(0,a.jsx)(n.lR,{children:"Caption (Optional)"}),(0,a.jsx)(n.MJ,{children:(0,a.jsx)(d.p,{placeholder:"e.g., My Signature Dish",...t,disabled:G})}),(0,a.jsx)(n.C5,{})]})}})]},e))})]}),(0,a.jsx)("div",{className:"pt-6 border-t flex flex-col sm:flex-row items-center justify-center",children:(0,a.jsxs)(s.$,{type:"submit",size:"lg",className:"w-full sm:w-auto",disabled:G||O||l,children:[G?(0,a.jsx)(x.A,{className:"mr-2 h-5 w-5 animate-spin"}):(0,a.jsx)(I.A,{className:"mr-2 h-5 w-5"}),G?"Saving...":"Save Profile Changes"]})})]})})}),(0,a.jsx)(u.wL,{className:"border-t pt-6",children:(0,a.jsxs)(S.AlertDialog,{children:[(0,a.jsx)(S.AlertDialogTrigger,{asChild:!0,children:(0,a.jsxs)(s.$,{variant:"destructive",className:"w-full sm:w-auto",disabled:G,children:[(0,a.jsx)(U.A,{className:"mr-2 h-4 w-4"})," Delete My Account"]})}),(0,a.jsxs)(S.AlertDialogContent,{children:[(0,a.jsxs)(S.AlertDialogHeader,{children:[(0,a.jsx)(S.AlertDialogTitle,{children:"Are you absolutely sure?"}),(0,a.jsx)(S.AlertDialogDescription,{children:"This action cannot be undone. This will permanently delete your account and remove your data from our servers. You will receive an email confirmation once the process is complete, as per our data retention policy."})]}),(0,a.jsxs)(S.AlertDialogFooter,{children:[(0,a.jsx)(S.AlertDialogCancel,{children:"Cancel"}),(0,a.jsx)(S.AlertDialogAction,{onClick:()=>{H({title:"Account Deletion Request Submitted",description:"Your request to delete your account has been received and will be processed according to our data retention policy.",duration:7e3})},children:"Yes, delete my account"})]})]})]})})]})}):(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:"Please log in to view your profile."})}},50286:(e,t,l)=>{"use strict";l.d(t,{A:()=>a});let a=(0,l(40157).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},57082:(e,t,l)=>{"use strict";l.d(t,{A:()=>a});let a=(0,l(40157).A)("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]])},59576:(e,t,l)=>{"use strict";l.d(t,{A:()=>c,AuthProvider:()=>d});var a=l(95155),r=l(93004),o=l(12115),i=l(56104),s=l(35317);let n=(0,o.createContext)(void 0);function d(e){let{children:t}=e,[l,d]=(0,o.useState)(null),[c,u]=(0,o.useState)(null),[m,p]=(0,o.useState)(!0),[h,f]=(0,o.useState)(!0),[x,g]=(0,o.useState)(!1),[j,b]=(0,o.useState)(!1),[y,v]=(0,o.useState)(!1),[C,A]=(0,o.useState)(!1),[N,w]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{let e;console.log("AuthContext: Setting up onAuthStateChanged listener.");let t=(0,r.hg)(i.j2,async t=>{if(console.log("AuthContext: onAuthStateChanged triggered. CurrentUser UID:",(null==t?void 0:t.uid)||null),u(null),g(!1),b(!1),v(!1),A(!1),w(!1),e&&(console.log("AuthContext: Cleaning up previous Firestore profile listener for old user or on logout."),e(),e=void 0),d(t),t){f(!0),console.log("AuthContext: User found (UID:",t.uid,"). Starting profile and claims loading.");let l=!1;try{console.log("AuthContext: Attempting to fetch ID token result with force refresh for UID:",t.uid);let e=await t.getIdTokenResult(!0);console.log("AuthContext: ID Token Claims for user",t.uid,":",e.claims),l=!!(e.claims&&!0===e.claims.admin),g(l),l?console.log("AuthContext: 'admin' custom claim IS TRUE for user:",t.uid):console.warn("AuthContext: 'admin' custom claim not found or not true for user:",t.uid,"Claims found:",e.claims)}catch(e){console.error("AuthContext: Error fetching ID token result for custom claims for UID:",t.uid,e),g(!1)}try{console.log("AuthContext: Setting up Firestore profile listener for UID:",t.uid);let a=(0,s.H9)(i.db,"users",t.uid);e=(0,s.aQ)(a,e=>{if(e.exists()){let a=e.data(),r={id:e.id,...a,createdAt:a.createdAt instanceof s.Dc?a.createdAt.toDate():a.createdAt?new Date(a.createdAt):void 0,updatedAt:a.updatedAt instanceof s.Dc?a.updatedAt.toDate():a.updatedAt?new Date(a.updatedAt):void 0};console.log("AuthContext: Firestore profile data loaded/updated for UID:",t.uid,"Role:",r.role),u(r);let o="chef"===r.role,i="customer"===r.role,n="admin"===r.role;console.log("AuthContext: Setting isChef based on role:",o),b(o),v(i),n&&!l?console.warn("AuthContext: User has 'admin' role in Firestore, but 'admin' custom claim is missing or false. Custom claims determine admin access."):!n&&l&&console.log("AuthContext: User has 'admin' custom claim, granting admin access. Firestore role is:",r.role),o?(A(r.isApproved||!1),w(r.isSubscribed||!1),console.log("AuthContext: Chef specific flags - Approved:",r.isApproved,"Subscribed:",r.isSubscribed)):(A(!1),w(!1))}else console.warn("AuthContext: No such user profile document in Firestore for UID:",t.uid),u(null),b(!1),v(!1),A(!1),w(!1);f(!1)},e=>{console.error("AuthContext: Error with Firestore profile snapshot listener for UID:",t.uid,e),u(null),b(!1),v(!1),A(!1),w(!1),f(!1)})}catch(e){console.error("AuthContext: Outer error setting up Firestore profile snapshot for UID:",t.uid,e),u(null),b(!1),v(!1),A(!1),w(!1),f(!1)}}else console.log("AuthContext: No current user (logged out). Resetting profile states."),f(!1);p(!1)});return()=>{console.log("AuthContext: Cleaning up onAuthStateChanged listener."),t(),e&&(console.log("AuthContext: Cleaning up profile onSnapshot listener on AuthProvider unmount."),e())}},[]),(0,a.jsx)(n.Provider,{value:{user:l,userProfile:c,loading:m||h,authLoading:m,profileLoading:h,isAdmin:x,isChef:j,isCustomer:y,isChefApproved:C,isChefSubscribed:N},children:t})}function c(){let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},68718:(e,t,l)=>{"use strict";l.d(t,{A:()=>a});let a=(0,l(40157).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},90010:(e,t,l)=>{"use strict";l.r(t),l.d(t,{AlertDialog:()=>n,AlertDialogAction:()=>g,AlertDialogCancel:()=>j,AlertDialogContent:()=>m,AlertDialogDescription:()=>x,AlertDialogFooter:()=>h,AlertDialogHeader:()=>p,AlertDialogOverlay:()=>u,AlertDialogPortal:()=>c,AlertDialogTitle:()=>f,AlertDialogTrigger:()=>d});var a=l(95155),r=l(12115),o=l(17649),i=l(59434),s=l(30285);let n=o.bL,d=o.l9,c=o.ZL,u=r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,a.jsx)(o.hJ,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",l),...r,ref:t})});u.displayName=o.hJ.displayName;let m=r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsx)(o.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",l),...r})]})});m.displayName=o.UC.displayName;let p=e=>{let{className:t,...l}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...l})};p.displayName="AlertDialogHeader";let h=e=>{let{className:t,...l}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...l})};h.displayName="AlertDialogFooter";let f=r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,a.jsx)(o.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold",l),...r})});f.displayName=o.hE.displayName;let x=r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,a.jsx)(o.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",l),...r})});x.displayName=o.VY.displayName;let g=r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,a.jsx)(o.rc,{ref:t,className:(0,i.cn)((0,s.r)(),l),...r})});g.displayName=o.rc.displayName;let j=r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,a.jsx)(o.ZD,{ref:t,className:(0,i.cn)((0,s.r)({variant:"outline"}),"mt-2 sm:mt-0",l),...r})});j.displayName=o.ZD.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7446,9352,4453,4602,1345,6766,65,1342,7649,2160,4286,8441,1684,7358],()=>t(27779)),_N_E=e.O()}]);