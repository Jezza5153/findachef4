(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9667],{15263:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>C});var a=i(95155),n=i(12115),s=i(90221),r=i(62177),d=i(55594),l=i(30285),o=i(17759),u=i(66695),c=i(76252),m=i(87481),p=i(51154),f=i(49523),h=i(49103),g=i(59576),x=i(56104),b=i(35317),v=i(90858),y=i(34477);y.callServer,y.findSourceMapURL;var j=i(79737),I=i(55028);let w=(0,I.default)(()=>Promise.all([i.e(1345),i.e(4165)]).then(i.bind(i,54165)).then(e=>e.Dialog),{loadableGenerated:{webpack:()=>[54165]},ssr:!1,loading:()=>(0,a.jsx)("p",{children:"Loading dialog..."})}),A=(0,I.default)(()=>Promise.all([i.e(1345),i.e(4165)]).then(i.bind(i,54165)).then(e=>e.DialogContent),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),N=(0,I.default)(()=>Promise.all([i.e(1345),i.e(4165)]).then(i.bind(i,54165)).then(e=>e.DialogHeader),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),P=(0,I.default)(()=>Promise.all([i.e(1345),i.e(4165)]).then(i.bind(i,54165)).then(e=>e.DialogTitle),{loadableGenerated:{webpack:()=>[54165]},ssr:!1});(0,I.default)(()=>Promise.all([i.e(1345),i.e(4165)]).then(i.bind(i,54165)).then(e=>e.DialogFooter),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),(0,I.default)(()=>Promise.all([i.e(1345),i.e(4165)]).then(i.bind(i,54165)).then(e=>e.DialogClose),{loadableGenerated:{webpack:()=>[54165]},ssr:!1});let S=(0,I.default)(()=>Promise.all([i.e(1345),i.e(4165)]).then(i.bind(i,54165)).then(e=>e.DialogDescription),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),D=d.Ik({id:d.Yj().default(()=>(0,j.A)()),name:d.Yj().min(1,{message:"Ingredient name is required."}),quantity:d.au.number().min(.01,{message:"Quantity must be positive."}),unit:d.Yj().min(1,{message:"Unit is required."}),costPerUnit:d.au.number().min(0,{message:"Cost per unit must be non-negative."}).default(0),totalCost:d.au.number().optional(),notes:d.Yj().max(200,"Notes too long").optional().default("")}),M=d.Ik({title:d.Yj().min(3,{message:"Menu title must be at least 3 characters."}),description:d.Yj().min(10,{message:"Description must be at least 10 characters."}).max(500,"Max 500 characters"),cuisine:d.Yj().min(2,{message:"Cuisine type is required."}),pricePerHead:d.au.number().min(0,{message:"Price must be a positive number."}),pax:d.au.number().min(1,{message:"PAX must be at least 1."}).default(1),costPrice:d.au.number().min(0,{message:"Cost price must be non-negative."}).default(0),dietaryInfo:d.YO(d.Yj()).optional().default([]),isPublic:d.zM().default(!1),menuImageFile:d.Nl(File).optional().refine(e=>!e||e.size<=2097152,"Max image size is 2MB.").refine(e=>!e||["image/jpeg","image/png","image/webp"].includes(e.type),"Only JPG, PNG, WEBP files are allowed."),dataAiHint:d.Yj().max(40,"Hint should be brief, max 2 words.").optional().default(""),menuIngredients:d.YO(D).optional().default([])});function C(){let{user:e,userProfile:t,isChefSubscribed:i,authLoading:d}=(0,g.A)(),[y,I]=(0,n.useState)([]),[D,C]=(0,n.useState)(!0),[E,T]=(0,n.useState)(!1),[O,F]=(0,n.useState)(!1),[k,_]=(0,n.useState)(null),[Y,R]=(0,n.useState)(null),[H,G]=(0,n.useState)(null),[U,q]=(0,n.useState)(!1),{toast:L}=(0,m.dj)(),J=(0,r.mN)({resolver:(0,s.u)(M),defaultValues:{title:"",description:"",cuisine:"",pricePerHead:0,dietaryInfo:[],isPublic:!1,menuImageFile:void 0,pax:1,costPrice:0,dataAiHint:"",menuIngredients:[]}}),{fields:z,append:V,remove:B,replace:W}=(0,r.jz)({control:J.control,name:"menuIngredients"}),X=J.watch("menuIngredients"),Q=J.watch("pax"),Z=(0,n.useMemo)(()=>(null==X?void 0:X.reduce((e,t)=>e+(Number(t.quantity)||0)*(Number(t.costPerUnit)||0),0))||0,[X]);(0,n.useMemo)(()=>Z/Math.max(1,Number(Q)||1),[Z,Q]),(0,n.useEffect)(()=>{if(d||!e){C(!1),d||e||I([]);return}C(!0);let t=(0,b.rJ)(x.db,"menus"),i=(0,b.P)(t,(0,b._M)("chefId","==",e.uid),(0,b.My)("createdAt","desc")),a=(0,b.aQ)(i,e=>{I(e.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt instanceof b.Dc?t.createdAt.toDate():t.createdAt?new Date(t.createdAt):void 0,updatedAt:t.updatedAt instanceof b.Dc?t.updatedAt.toDate():t.updatedAt?new Date(t.updatedAt):void 0}})),C(!1)},e=>{L({title:"Error Fetching Menus",description:"Could not fetch your menus: ".concat(e.message),variant:"destructive"}),I([]),C(!1)});return()=>a()},[e,d,L]);let $=e=>{let t=y.find(t=>t.id===e);if(t){var i;_(t),J.reset({title:t.title,description:t.description,cuisine:t.cuisine,pricePerHead:t.pricePerHead||0,pax:t.pax||1,costPrice:t.costPrice||0,dietaryInfo:t.dietaryInfo||[],isPublic:t.isPublic,menuImageFile:void 0,dataAiHint:t.dataAiHint||"",menuIngredients:(null==(i=t.menuIngredients)?void 0:i.map(e=>({...e,id:e.id||(0,j.A)()})))||[]}),G(t.imageUrl||null),R(null),F(!0)}else L({title:"Error",description:"Could not find menu to edit.",variant:"destructive"})},K=async t=>{if(!e)return void L({title:"Authentication Error",description:"You must be logged in.",variant:"destructive"});let i=y.find(e=>e.id===t);if(!i)return void L({title:"Error",description:"Menu not found.",variant:"destructive"});if(window.confirm('Are you sure you want to delete the menu "'.concat(null==i?void 0:i.title,'"?'))){T(!0);try{if(i.imageUrl&&i.imageUrl.startsWith("https://firebasestorage.googleapis.com"))try{let e=(0,v.KR)(x.IG,i.imageUrl);await (0,v.XR)(e)}catch(e){}await (0,b.kd)((0,b.H9)(x.db,"menus",t)),L({title:"Menu Deleted",description:'"'.concat(null==i?void 0:i.title,'" has been deleted.'),variant:"destructive"})}catch(e){L({title:"Delete Error",description:"Could not delete menu: ".concat(e.message),variant:"destructive"})}finally{T(!1)}}},ee=(0,n.useCallback)(async t=>{if(!e)return void L({title:"Not Logged In",description:"Please log in to add items to your shopping list.",variant:"destructive"});if(!t.menuIngredients||0===t.menuIngredients.length)return void L({title:"No Ingredients",description:"This menu has no ingredients listed to add to the shopping list.",variant:"default"});T(!0);try{let i=(0,b.wP)(x.db),a=(0,b.rJ)(x.db,"users/".concat(e.uid,"/shoppingListItems"));t.menuIngredients.forEach(n=>{if(!n.name||!n.quantity||!n.unit)return;let s=(0,b.H9)(a),r={chefId:e.uid,name:n.name,quantity:Number(n.quantity)||1,unit:n.unit,estimatedCost:Number(n.costPerUnit)||0,notes:"For menu: ".concat(t.title,". ").concat(n.notes||"").trim(),purchased:!1,menuId:t.id};i.set(s,{...r,createdAt:(0,b.O5)(),updatedAt:(0,b.O5)()})}),await i.commit(),L({title:"Added to Shopping List",description:'Ingredients from "'.concat(t.title,'" added.')})}catch(e){L({title:"Error",description:"Could not add items to shopping list: ".concat(e.message),variant:"destructive"})}finally{T(!1)}},[e,L]),et=()=>{if(!e)return void L({title:"Login Required",description:"Please log in to create menus.",variant:"destructive"});J.reset({title:"",description:"",cuisine:"",pricePerHead:0,dietaryInfo:[],isPublic:!1,menuImageFile:void 0,pax:1,costPrice:0,dataAiHint:"",menuIngredients:[]}),_(null),R(null),G(null),W([]),F(!0)};return d||D?(0,a.jsxs)("div",{className:"flex justify-center items-center min-h-[calc(100vh-200px)]",children:[(0,a.jsx)(p.A,{className:"h-12 w-12 animate-spin text-primary","data-ai-hint":"loading spinner"}),(0,a.jsx)("p",{className:"ml-3 text-lg",children:"Loading your menus..."})]}):e?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-2",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold flex items-center",children:[(0,a.jsx)(f.A,{className:"mr-3 h-8 w-8 text-primary","data-ai-hint":"notebook icon"})," Manage Your Menus"]}),(0,a.jsxs)(l.$,{onClick:et,disabled:E||U,children:[(0,a.jsx)(h.A,{className:"mr-2 h-5 w-5"})," Add New Menu"]})]}),w&&O&&(0,a.jsx)(w,{open:O,onOpenChange:e=>{(E||U)&&e||(F(e),e||(R(null),G(null),J.reset(),_(null),W([])))},children:(0,a.jsxs)(A,{className:"sm:max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(N,{children:[(0,a.jsx)(P,{children:k?"Edit Menu":"Create New Menu"}),S&&(0,a.jsx)(S,{children:"Fill in the details for your menu item. Use the AI assist for help with descriptions!"})]}),(0,a.jsx)(o.lV,{...J})]})}),y.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map(e=>(0,a.jsx)(c.Y,{menu:e,onEdit:()=>$(e.id),onDelete:()=>K(e.id),onAddToShoppingList:ee,isChefOwner:!0,showChefDetails:!1},e.id))}):!D&&(0,a.jsxs)(u.Zp,{className:"text-center py-12 border-dashed",children:[(0,a.jsxs)(u.aR,{children:[(0,a.jsx)(f.A,{className:"mx-auto h-12 w-12 text-muted-foreground mb-3","data-ai-hint":"notebook empty"}),(0,a.jsx)(u.ZB,{children:"No Menus Yet"})]}),(0,a.jsxs)(u.Wu,{children:[(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"You haven't created any menus. Get started by adding your first one!"}),(0,a.jsxs)(l.$,{onClick:et,disabled:E||U,children:[(0,a.jsx)(h.A,{className:"mr-2 h-5 w-5"})," Create Your First Menu"]})]})]})]}):(0,a.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:"Please log in to manage your menus."})}},17759:(e,t,i)=>{"use strict";i.d(t,{C5:()=>b,MJ:()=>g,Rr:()=>x,eI:()=>f,lR:()=>h,lV:()=>o,zB:()=>c});var a=i(95155),n=i(12115),s=i(99708),r=i(62177),d=i(59434),l=i(85057);let o=r.Op,u=n.createContext({}),c=e=>{let{...t}=e;return(0,a.jsx)(u.Provider,{value:{name:t.name},children:(0,a.jsx)(r.xI,{...t})})},m=()=>{let e=n.useContext(u),t=n.useContext(p),{getFieldState:i,formState:a}=(0,r.xW)(),s=i(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:d}=t;return{id:d,name:e.name,formItemId:"".concat(d,"-form-item"),formDescriptionId:"".concat(d,"-form-item-description"),formMessageId:"".concat(d,"-form-item-message"),...s}},p=n.createContext({}),f=n.forwardRef((e,t)=>{let{className:i,...s}=e,r=n.useId();return(0,a.jsx)(p.Provider,{value:{id:r},children:(0,a.jsx)("div",{ref:t,className:(0,d.cn)("space-y-2",i),...s})})});f.displayName="FormItem";let h=n.forwardRef((e,t)=>{let{className:i,...n}=e,{error:s,formItemId:r}=m();return(0,a.jsx)(l.J,{ref:t,className:(0,d.cn)(s&&"text-destructive",i),htmlFor:r,...n})});h.displayName="FormLabel";let g=n.forwardRef((e,t)=>{let{...i}=e,{error:n,formItemId:r,formDescriptionId:d,formMessageId:l}=m();return(0,a.jsx)(s.DX,{ref:t,id:r,"aria-describedby":n?"".concat(d," ").concat(l):"".concat(d),"aria-invalid":!!n,...i})});g.displayName="FormControl";let x=n.forwardRef((e,t)=>{let{className:i,...n}=e,{formDescriptionId:s}=m();return(0,a.jsx)("p",{ref:t,id:s,className:(0,d.cn)("text-sm text-muted-foreground",i),...n})});x.displayName="FormDescription";let b=n.forwardRef((e,t)=>{var i;let{className:n,children:s,...r}=e,{error:l,formMessageId:o}=m(),u=l?String(null!=(i=null==l?void 0:l.message)?i:""):s;return u?(0,a.jsx)("p",{ref:t,id:o,className:(0,d.cn)("text-sm font-medium text-destructive",n),...r,children:u}):null});b.displayName="FormMessage"},40452:(e,t,i)=>{Promise.resolve().then(i.bind(i,15263))},85057:(e,t,i)=>{"use strict";i.d(t,{J:()=>o});var a=i(95155),n=i(12115),s=i(40968),r=i(74466),d=i(59434);let l=(0,r.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=n.forwardRef((e,t)=>{let{className:i,...n}=e;return(0,a.jsx)(s.b,{ref:t,className:(0,d.cn)(l(),i),...n})});o.displayName=s.b.displayName},87481:(e,t,i)=>{"use strict";i.d(t,{dj:()=>m});var a=i(12115);let n=0,s=new Map,r=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),u({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},d=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:i}=t;return i?r(i):e.toasts.forEach(e=>{r(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===i||void 0===i?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],o={toasts:[]};function u(e){o=d(o,e),l.forEach(e=>{e(o)})}function c(e){let{...t}=e,i=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>u({type:"DISMISS_TOAST",toastId:i});return u({type:"ADD_TOAST",toast:{...t,id:i,open:!0,onOpenChange:e=>{e||a()}}}),{id:i,dismiss:a,update:e=>u({type:"UPDATE_TOAST",toast:{...e,id:i}})}}function m(){let[e,t]=a.useState(o);return a.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:c,dismiss:e=>u({type:"DISMISS_TOAST",toastId:e})}}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7446,9352,5100,4602,6766,7322,5816,4123,8441,1684,7358],()=>t(40452)),_N_E=e.O()}]);