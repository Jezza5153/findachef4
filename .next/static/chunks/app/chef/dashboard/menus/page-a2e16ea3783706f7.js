(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9667],{15263:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>_});var s=i(95155),n=i(12115),r=i(90221),a=i(62177),l=i(55594),o=i(30285),d=i(17759),c=i(62523),u=i(88539),m=i(80333),p=i(47262),g=i(66695),h=i(76252),x=i(87481),f=i(50172),b=i(72233),j=i(34301),v=i(74601),y=i(23422),I=i(79503),N=i(35297),w=i(11133),A=i(46102),C=i(59576),M=i(56104),P=i(35317),k=i(90858),R=i(66766),S=i(34477);let D=(0,S.createServerReference)("407b8f0736cd0bf4772ca42b28564d4c17ea7e5c2f",S.callServer,void 0,S.findSourceMapURL,"assistMenuItem");var F=i(79737),T=i(55028);let E=(0,T.default)(()=>Promise.all([i.e(1345),i.e(6546)]).then(i.bind(i,54165)).then(e=>e.Dialog),{loadableGenerated:{webpack:()=>[54165]},ssr:!1,loading:()=>(0,s.jsxs)("div",{className:"p-4 text-center",children:[(0,s.jsx)(f.A,{className:"h-6 w-6 animate-spin inline-block"})," Loading Dialog..."]})}),U=(0,T.default)(()=>Promise.all([i.e(1345),i.e(6546)]).then(i.bind(i,54165)).then(e=>e.DialogContent),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),H=(0,T.default)(()=>Promise.all([i.e(1345),i.e(6546)]).then(i.bind(i,54165)).then(e=>e.DialogHeader),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),O=(0,T.default)(()=>Promise.all([i.e(1345),i.e(6546)]).then(i.bind(i,54165)).then(e=>e.DialogTitle),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),z=(0,T.default)(()=>Promise.all([i.e(1345),i.e(6546)]).then(i.bind(i,54165)).then(e=>e.DialogFooter),{loadableGenerated:{webpack:()=>[54165]},ssr:!1}),B=(0,T.default)(()=>Promise.all([i.e(1345),i.e(6546)]).then(i.bind(i,54165)).then(e=>e.DialogClose),{loadableGenerated:{webpack:()=>[54165]},ssr:!1});(0,T.default)(()=>Promise.all([i.e(1345),i.e(6546)]).then(i.bind(i,54165)).then(e=>e.DialogDescription),{loadableGenerated:{webpack:()=>[54165]},ssr:!1});let J=[{value:"Vegetarian",label:"Vegetarian"},{value:"Vegan",label:"Vegan"},{value:"Gluten-Free",label:"Gluten-Free"},{value:"Dairy-Free",label:"Dairy-Free"},{value:"Nut-Free",label:"Nut-Free"}],V=l.Ik({id:l.Yj(),name:l.Yj().min(1,{message:"Ingredient name is required."}),quantity:l.au.number().min(.01,{message:"Quantity must be positive."}),unit:l.Yj().min(1,{message:"Unit is required."}),costPerUnit:l.au.number().min(0,{message:"Cost per unit must be non-negative."}),totalCost:l.au.number().optional(),notes:l.Yj().optional()}),Y=l.Ik({title:l.Yj().min(3,{message:"Title must be at least 3 characters."}),description:l.Yj().min(10,{message:"Description must be at least 10 characters."}),cuisine:l.Yj().min(2,{message:"Cuisine type is required."}),pricePerHead:l.au.number().min(0,{message:"Sale price must be a positive number."}),pax:l.au.number().min(1,{message:"PAX must be at least 1."}).optional(),costPrice:l.au.number().min(0,{message:"Cost price must be positive."}).optional(),dietaryInfo:l.YO(l.Yj()).optional(),isPublic:l.zM().default(!1),menuImageFile:l.Nl(File).optional().refine(e=>!e||e.size<=2097152,"Max image size is 2MB.").refine(e=>!e||["image/jpeg","image/png","image/webp"].includes(e.type),"Only JPG, PNG, WEBP files are allowed."),dataAiHint:l.Yj().optional().max(30,"Hint should be brief, max 2 words."),menuIngredients:l.YO(V).optional()});function _(){let{user:e,userProfile:t,isChefSubscribed:i}=(0,C.A)(),[l,S]=(0,n.useState)([]),[T,V]=(0,n.useState)(!0),[_,G]=(0,n.useState)(!1),[L,q]=(0,n.useState)(!1),[$,X]=(0,n.useState)(null),[W,Z]=(0,n.useState)(null),[K,Q]=(0,n.useState)(null),[ee,et]=(0,n.useState)(!1),{toast:ei}=(0,x.dj)(),es=(0,a.mN)({resolver:(0,r.u)(Y),defaultValues:{title:"",description:"",cuisine:"",pricePerHead:0,dietaryInfo:[],isPublic:!1,menuImageFile:void 0,pax:1,costPrice:0,dataAiHint:"",menuIngredients:[]}}),{fields:en,append:er,remove:ea,replace:el}=(0,a.jz)({control:es.control,name:"menuIngredients"}),eo=es.watch("menuIngredients"),ed=es.watch("pax"),ec=(0,n.useMemo)(()=>(null==eo?void 0:eo.reduce((e,t)=>e+(Number(t.quantity)||0)*(Number(t.costPerUnit)||0),0))||0,[eo]),eu=(0,n.useMemo)(()=>ec/Math.max(1,Number(ed)||1),[ec,ed]);(0,n.useEffect)(()=>{let t;if(e){V(!0);let i=(0,P.rJ)(M.db,"menus"),s=(0,P.P)(i,(0,P._M)("chefId","==",e.uid),(0,P.My)("createdAt","desc"));try{t=(0,P.aQ)(s,e=>{let t=e.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt instanceof P.Dc?t.createdAt.toDate():t.createdAt?new Date(t.createdAt):void 0,updatedAt:t.updatedAt instanceof P.Dc?t.updatedAt.toDate():t.updatedAt?new Date(t.updatedAt):void 0}});S(t),V(!1)},e=>{console.error("Error fetching menus:",e),ei({title:"Error",description:"Could not fetch your menus.",variant:"destructive"}),V(!1)})}catch(e){console.error("Error setting up menu listener:",e),ei({title:"Setup Error",description:"Failed to initialize menu tracking.",variant:"destructive"}),V(!1)}}else V(!1),S([]);return()=>{t&&t()}},[e,ei]);let em=e=>{var t;let i=null==(t=e.target.files)?void 0:t[0];if(i){es.setValue("menuImageFile",i,{shouldValidate:!0}),Z(i);let e=new FileReader;e.onloadend=()=>{Q(e.result)},e.readAsDataURL(i)}else es.setValue("menuImageFile",void 0),Z(null),Q((null==$?void 0:$.imageUrl)||null)},ep=async s=>{if(!e||!t)return void ei({title:"Authentication Error",description:"You must be logged in to manage menus.",variant:"destructive"});if(s.isPublic&&!i&&!t.isAdmin)return void ei({title:"Subscription Required",description:"An active subscription is needed to publish menus publicly.",variant:"destructive"});G(!0);let n=(null==$?void 0:$.imageUrl)||"",r=(null==$?void 0:$.id)||(0,P.H9)((0,P.rJ)(M.db,"menus")).id;try{var a;if(W){if((null==$?void 0:$.imageUrl)&&$.imageUrl.startsWith("https://firebasestorage.googleapis.com"))try{let e=(0,k.KR)(M.IG,$.imageUrl);await (0,k.XR)(e),console.log("MenuManagement: Deleted old menu image.")}catch(e){"storage/object-not-found"!==e.code&&console.warn("MenuManagement: Could not delete old menu image during update:",e.message)}let t=W.name.split(".").pop()||"jpg",i="users/".concat(e.uid,"/menus/").concat(r,"/image.").concat(t),s=(0,k.KR)(M.IG,i);ei({title:"Uploading image...",description:"Please wait."});let a=(0,k.bp)(s,W);await new Promise((e,t)=>{a.on("state_changed",null,e=>{console.error("Menu image upload error:",e),ei({title:"Upload Failed",description:"Image upload failed: ".concat(e.message),variant:"destructive"}),t(e)},async()=>{try{n=await (0,k.qk)(a.snapshot.ref),console.log("MenuManagement: New image uploaded, URL:",n),e()}catch(e){console.error("Error getting download URL for menu image:",e),ei({title:"Upload Failed",description:"Failed to get image URL: ".concat(e.message),variant:"destructive"}),t(e)}})})}let i=(null==(a=s.menuIngredients)?void 0:a.map(e=>({...e,totalCost:(Number(e.quantity)||0)*(Number(e.costPerUnit)||0)})))||[],l=i.reduce((e,t)=>e+(t.totalCost||0),0),o=Math.max(1,Number(s.pax)||1),d={title:s.title,description:s.description,cuisine:s.cuisine,pricePerHead:s.pricePerHead,pax:s.pax,costPrice:s.costPrice,dietaryInfo:s.dietaryInfo||[],isPublic:s.isPublic,imageUrl:n,dataAiHint:s.dataAiHint,chefId:e.uid,chefName:t.name||e.displayName||"Chef",chefProfilePictureUrl:t.profilePictureUrl||e.photoURL||void 0,menuIngredients:i,calculatedTotalIngredientCost:l,calculatedCostPricePerHead:l/o,adminStatus:(null==$?void 0:$.adminStatus)||"pending",updatedAt:(0,P.O5)()};if($){let e=(0,P.H9)(M.db,"menus",$.id);await (0,P.mZ)(e,d),ei({title:"Menu Updated",description:'"'.concat(s.title,'" has been successfully updated.')})}else{d.id=r,d.createdAt=(0,P.O5)();let e=(0,P.H9)(M.db,"menus",r);await (0,P.BN)(e,d),ei({title:"Menu Created",description:'"'.concat(s.title,'" has been successfully created.')})}es.reset(),X(null),q(!1),Z(null),Q(null),el([])}catch(e){console.error("Menu save operation failed:",e),ei({title:"Save Failed",description:"Could not save menu: ".concat(e.message),variant:"destructive"})}finally{G(!1)}},eg=e=>{let t=l.find(t=>t.id===e);if(t){var i;X(t),es.reset({title:t.title,description:t.description,cuisine:t.cuisine,pricePerHead:t.pricePerHead||0,pax:t.pax||1,costPrice:t.costPrice||0,dietaryInfo:t.dietaryInfo||[],isPublic:t.isPublic,menuImageFile:void 0,dataAiHint:t.dataAiHint||"",menuIngredients:(null==(i=t.menuIngredients)?void 0:i.map(e=>({...e,id:e.id||(0,F.A)()})))||[]}),Q(t.imageUrl||null),Z(null),q(!0)}},eh=async t=>{if(!e)return void ei({title:"Authentication Error",description:"You must be logged in.",variant:"destructive"});let i=l.find(e=>e.id===t);if(!i)return void ei({title:"Error",description:"Menu not found.",variant:"destructive"});if(window.confirm('Are you sure you want to delete the menu "'.concat(null==i?void 0:i.title,'"?'))){G(!0);try{if(i.imageUrl&&i.imageUrl.startsWith("https://firebasestorage.googleapis.com"))try{let e=(0,k.KR)(M.IG,i.imageUrl);await (0,k.XR)(e),console.log("MenuManagement: Deleted menu image from storage.")}catch(e){"storage/object-not-found"!==e.code&&console.warn("MenuManagement: Could not delete menu image from storage during menu deletion:",e.message)}await (0,P.kd)((0,P.H9)(M.db,"menus",t)),ei({title:"Menu Deleted",description:'"'.concat(null==i?void 0:i.title,'" has been deleted.'),variant:"destructive"})}catch(e){console.error("Error deleting menu:",e),ei({title:"Delete Error",description:"Could not delete menu. ".concat(e.message),variant:"destructive"})}finally{G(!1)}}},ex=(0,n.useCallback)(async t=>{if(!e)return void ei({title:"Not Logged In",description:"Please log in to add items to your shopping list.",variant:"destructive"});if(!t.menuIngredients||0===t.menuIngredients.length)return void ei({title:"No Ingredients",description:"This menu has no ingredients listed to add to the shopping list.",variant:"default"});G(!0);try{let i=(0,P.wP)(M.db),s=(0,P.rJ)(M.db,"users/".concat(e.uid,"/shoppingListItems"));t.menuIngredients.forEach(n=>{let r=(0,P.H9)(s),a={chefId:e.uid,name:n.name,quantity:n.quantity,unit:n.unit,estimatedCost:n.costPerUnit,notes:"For menu: ".concat(t.title,". ").concat(n.notes||"").trim(),purchased:!1,menuId:t.id};i.set(r,{...a,createdAt:(0,P.O5)(),updatedAt:(0,P.O5)()})}),await i.commit(),ei({title:"Added to Shopping List",description:'Ingredients from "'.concat(t.title,'" added.')})}catch(e){console.error("Error adding to shopping list:",e),ei({title:"Error",description:"Could not add items to shopping list. ".concat(e.message),variant:"destructive"})}finally{G(!1)}},[e,ei]),ef=()=>{es.reset({title:"",description:"",cuisine:"",pricePerHead:0,dietaryInfo:[],isPublic:!1,menuImageFile:void 0,pax:1,costPrice:0,dataAiHint:"",menuIngredients:[]}),X(null),Z(null),Q(null),el([]),q(!0)},eb=async()=>{let{title:e,description:t,cuisine:i,menuIngredients:s}=es.getValues();if(!e||!i)return void ei({title:"Missing Information for AI",description:"Please provide at least a Menu Title and Cuisine Type for AI assistance.",variant:"destructive"});et(!0),ei({title:"AI Menu Assist",description:"Generating suggestions..."});try{let n=null==s?void 0:s.map(e=>e.name).filter(Boolean).join(", "),r={menuTitle:e,cuisine:i};t&&(r.currentDescription=t),n&&(r.keyIngredients=n);let a=await D(r);a&&a.suggestedDescription?(es.setValue("description",a.suggestedDescription,{shouldValidate:!0}),ei({title:"AI Suggestion Applied",description:"Description updated with AI suggestion."})):ei({title:"AI Menu Assist",description:"Could not generate a suggestion at this time.",variant:"default"})}catch(t){console.error("Error with AI Menu Assist:",t);let e="Failed to get AI suggestions. ".concat(t.message);t.message&&t.message.toLowerCase().includes("api key not valid")&&(e="AI Service Error: Invalid API Key for menu assist."),ei({title:"AI Error",description:e,variant:"destructive"})}finally{et(!1)}};return T?(0,s.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,s.jsx)(f.A,{className:"h-8 w-8 animate-spin text-primary","data-ai-hint":"loading spinner"})," Loading menus..."]}):(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-2",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold flex items-center",children:[(0,s.jsx)(b.A,{className:"mr-3 h-8 w-8 text-primary","data-ai-hint":"notebook icon"})," Manage Your Menus"]}),(0,s.jsxs)(o.$,{onClick:ef,disabled:_||ee,children:[(0,s.jsx)(j.A,{className:"mr-2 h-5 w-5"})," Add New Menu"]})]}),L&&E&&U&&H&&O&&z&&B&&(0,s.jsx)(E,{open:L,onOpenChange:e=>{(_||ee)&&e||(q(e),e||(Z(null),Q(null),es.reset(),X(null),el([])))},children:(0,s.jsxs)(U,{className:"sm:max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)(H,{children:(0,s.jsx)(O,{children:$?"Edit Menu":"Create New Menu"})}),(0,s.jsx)(d.lV,{...es,children:(0,s.jsxs)("form",{onSubmit:es.handleSubmit(ep),className:"space-y-6 p-1",children:[(0,s.jsx)(d.zB,{control:es.control,name:"title",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Menu Title"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g., Summer BBQ Special",...t})}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsx)(d.zB,{control:es.control,name:"cuisine",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Cuisine Type"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g., Mexican, Thai, Fusion",...t})}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsx)(d.zB,{control:es.control,name:"description",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Description"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(u.T,{placeholder:"Detailed description of the menu...",...t,className:"min-h-[100px]"})}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsxs)(o.$,{type:"button",variant:"outline",onClick:eb,size:"sm",className:"w-full",disabled:ee||_,children:[ee?(0,s.jsx)(f.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(v.A,{className:"mr-2 h-4 w-4"}),ee?"Getting Suggestion...":"AI Assist: Enhance Description"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsx)(d.zB,{control:es.control,name:"pricePerHead",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Sale Price per Head ($)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{type:"number",step:"0.01",placeholder:"75.00",...t})}),(0,s.jsx)(d.Rr,{children:"The price customers will pay."}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsx)(d.zB,{control:es.control,name:"pax",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Serves (PAX)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{type:"number",placeholder:"e.g., 10",...t,defaultValue:1})}),(0,s.jsx)(d.Rr,{children:"Number of people this menu typically serves. Affects per-head cost calculation."}),(0,s.jsx)(d.C5,{})]})}})]}),(0,s.jsx)(d.zB,{control:es.control,name:"menuImageFile",render:e=>{let{fieldState:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Menu Image (Optional)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{type:"file",accept:"image/jpeg,image/png,image/webp",onChange:em,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary/10 file:text-primary hover:file:bg-primary/20"})}),K&&(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(R.default,{src:K,alt:"Menu image preview",width:200,height:150,className:"rounded-md object-cover","data-ai-hint":"menu food"})}),(0,s.jsx)(d.Rr,{children:"A captivating image for your menu (max 2MB, JPG/PNG/WEBP)."}),t.error&&(0,s.jsx)(d.C5,{children:t.error.message})]})}}),(0,s.jsx)(d.zB,{control:es.control,name:"dataAiHint",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Image Description Hint (for AI)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g., italian food, pasta dish",...t})}),(0,s.jsx)(d.Rr,{children:"One or two keywords to help AI understand the image content (max 2 words)."}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold flex items-center",children:[(0,s.jsx)(y.A,{className:"mr-2 h-5 w-5","data-ai-hint":"calculator math"}),"Ingredients & Costing"]}),en.map((e,t)=>(0,s.jsxs)(g.Zp,{className:"p-4 space-y-3 bg-muted/30",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)(d.lR,{children:["Ingredient ",t+1]}),(0,s.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>ea(t),className:"text-destructive hover:text-destructive",children:(0,s.jsx)(I.A,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,s.jsx)(d.zB,{control:es.control,name:"menuIngredients.".concat(t,".name"),render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{className:"col-span-2 md:col-span-1",children:[(0,s.jsx)(d.lR,{className:"text-xs",children:"Name"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g., Flour",...t})}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsx)(d.zB,{control:es.control,name:"menuIngredients.".concat(t,".quantity"),render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{className:"text-xs",children:"Qty"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{type:"number",step:"0.01",placeholder:"2.5",...t})}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsx)(d.zB,{control:es.control,name:"menuIngredients.".concat(t,".unit"),render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{className:"text-xs",children:"Unit"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"kg, pcs, L",...t})}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsx)(d.zB,{control:es.control,name:"menuIngredients.".concat(t,".costPerUnit"),render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{className:"text-xs",children:"Cost/Unit ($)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{type:"number",step:"0.01",placeholder:"5.99",...t})}),(0,s.jsx)(d.C5,{})]})}})]}),(0,s.jsx)(d.zB,{control:es.control,name:"menuIngredients.".concat(t,".notes"),render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{className:"text-xs",children:"Notes (Optional)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"Brand, specific type",...t})})]})}}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Total for this ingredient: $ ",((Number(es.getValues("menuIngredients.".concat(t,".quantity")))||0)*(Number(es.getValues("menuIngredients.".concat(t,".costPerUnit")))||0)).toFixed(2)]})]},e.id)),(0,s.jsxs)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>er({id:(0,F.A)(),name:"",quantity:1,unit:"",costPerUnit:0,notes:""}),children:[(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4"})," Add Ingredient"]}),(0,s.jsxs)("div",{className:"mt-4 p-3 bg-secondary rounded-md space-y-1 text-sm",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Total Ingredient Cost for Menu:"})," $",ec.toFixed(2)]}),(0,s.jsxs)("p",{children:[(0,s.jsxs)("strong",{children:["Calculated Cost per Head (for ",es.getValues("pax")||1," PAX):"]})," $",eu.toFixed(2)]})]}),(0,s.jsx)(d.zB,{control:es.control,name:"costPrice",render:e=>{let{field:t}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Final Determined Cost Price per Head ($)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{type:"number",step:"0.01",placeholder:"30.00",...t,value:t.value||0})}),(0,s.jsx)(d.Rr,{children:"Your internal cost per serving. You can use the calculated value above or enter your own."}),(0,s.jsx)(d.C5,{})]})}}),(0,s.jsx)(o.$,{type:"button",variant:"link",size:"sm",className:"p-0 h-auto",onClick:()=>es.setValue("costPrice",parseFloat(eu.toFixed(2))),disabled:0===eu&&0===ec||isNaN(eu),children:"Use Calculated Cost per Head"})]}),(0,s.jsxs)(d.eI,{className:"pt-4 border-t",children:[(0,s.jsx)(d.lR,{children:"Dietary Information (Flags)"}),(0,s.jsx)(a.xI,{name:"dietaryInfo",control:es.control,render:e=>{let{field:t}=e;return(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:J.map(e=>{var i;return(0,s.jsxs)(d.eI,{className:"flex flex-row items-start space-x-3 space-y-0",children:[(0,s.jsx)(d.MJ,{children:(0,s.jsx)(p.S,{checked:null==(i=t.value)?void 0:i.includes(e.value),onCheckedChange:i=>i?t.onChange([...t.value||[],e.value]):t.onChange((t.value||[]).filter(t=>t!==e.value))})}),(0,s.jsx)(d.lR,{className:"font-normal",children:e.label})]},e.value)})})}}),(0,s.jsx)(d.C5,{})]}),(0,s.jsx)(d.zB,{control:es.control,name:"isPublic",render:e=>{let{field:n}=e;return(0,s.jsxs)(d.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-4 shadow-sm",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(d.lR,{className:"text-base",children:"Publish Menu"}),(0,s.jsxs)(d.Rr,{children:["Make this menu visible to customers on the public menu listings.",!i&&n.value&&!(null==t?void 0:t.isAdmin)&&" Public visibility requires an active subscription.",!i&&!n.value&&!(null==t?void 0:t.isAdmin)&&" Publishing public menus requires an active subscription."]})]}),(0,s.jsx)(A.Bc,{children:(0,s.jsxs)(A.m_,{delayDuration:100,children:[(0,s.jsx)(A.k$,{asChild:!0,children:(0,s.jsx)(d.MJ,{children:(0,s.jsx)(m.d,{checked:n.value,onCheckedChange:e=>{if(e&&!i&&!(null==t?void 0:t.isAdmin))return void ei({title:"Subscription Required",description:"You need an active subscription to publish menus publicly.",variant:"destructive"});n.onChange(e)},disabled:_||ee||n.value&&!i&&!(null==t?void 0:t.isAdmin)&&!n.value})})}),!i&&!(null==t?void 0:t.isAdmin)&&(0,s.jsx)(A.ZI,{children:(0,s.jsxs)("p",{className:"flex items-center",children:[(0,s.jsx)(w.A,{className:"mr-2 h-4 w-4"}),"Subscription required to publish publicly."]})})]})})]})}}),(0,s.jsxs)(z,{children:[(0,s.jsx)(B,{asChild:!0,children:(0,s.jsx)(o.$,{type:"button",variant:"outline",disabled:_||ee,children:"Cancel"})}),(0,s.jsx)(o.$,{type:"submit",disabled:_||ee||es.getValues("isPublic")&&!i&&!(null==t?void 0:t.isAdmin),children:_?(0,s.jsx)(f.A,{className:"mr-2 h-4 w-4 animate-spin"}):$?"Save Changes":"Create Menu"})]})]})})]})}),l.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(e=>(0,s.jsx)(h.Y,{menu:e,onEdit:()=>eg(e.id),onDelete:()=>eh(e.id),onAddToShoppingList:ex,isChefOwner:!0,showChefDetails:!1},e.id))}):!T&&(0,s.jsxs)(g.Zp,{className:"text-center py-12 border-dashed",children:[(0,s.jsxs)(g.aR,{children:[(0,s.jsx)(b.A,{className:"mx-auto h-12 w-12 text-muted-foreground mb-3","data-ai-hint":"notebook empty"}),(0,s.jsx)(g.ZB,{children:"No Menus Yet"})]}),(0,s.jsxs)(g.Wu,{children:[(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"You haven't created any menus. Get started by adding your first one!"}),(0,s.jsxs)(o.$,{onClick:ef,children:[(0,s.jsx)(j.A,{className:"mr-2 h-5 w-5"})," Create Your First Menu"]})]})]})]})}},17759:(e,t,i)=>{"use strict";i.d(t,{C5:()=>b,MJ:()=>x,Rr:()=>f,eI:()=>g,lR:()=>h,lV:()=>d,zB:()=>u});var s=i(95155),n=i(12115),r=i(99708),a=i(62177),l=i(59434),o=i(85057);let d=a.Op,c=n.createContext({}),u=e=>{let{...t}=e;return(0,s.jsx)(c.Provider,{value:{name:t.name},children:(0,s.jsx)(a.xI,{...t})})},m=()=>{let e=n.useContext(c),t=n.useContext(p),{getFieldState:i,formState:s}=(0,a.xW)(),r=i(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=t;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...r}},p=n.createContext({}),g=n.forwardRef((e,t)=>{let{className:i,...r}=e,a=n.useId();return(0,s.jsx)(p.Provider,{value:{id:a},children:(0,s.jsx)("div",{ref:t,className:(0,l.cn)("space-y-2",i),...r})})});g.displayName="FormItem";let h=n.forwardRef((e,t)=>{let{className:i,...n}=e,{error:r,formItemId:a}=m();return(0,s.jsx)(o.J,{ref:t,className:(0,l.cn)(r&&"text-destructive",i),htmlFor:a,...n})});h.displayName="FormLabel";let x=n.forwardRef((e,t)=>{let{...i}=e,{error:n,formItemId:a,formDescriptionId:l,formMessageId:o}=m();return(0,s.jsx)(r.DX,{ref:t,id:a,"aria-describedby":n?"".concat(l," ").concat(o):"".concat(l),"aria-invalid":!!n,...i})});x.displayName="FormControl";let f=n.forwardRef((e,t)=>{let{className:i,...n}=e,{formDescriptionId:r}=m();return(0,s.jsx)("p",{ref:t,id:r,className:(0,l.cn)("text-sm text-muted-foreground",i),...n})});f.displayName="FormDescription";let b=n.forwardRef((e,t)=>{var i;let{className:n,children:r,...a}=e,{error:o,formMessageId:d}=m(),c=o?String(null!=(i=null==o?void 0:o.message)?i:""):r;return c?(0,s.jsx)("p",{ref:t,id:d,className:(0,l.cn)("text-sm font-medium text-destructive",n),...a,children:c}):null});b.displayName="FormMessage"},40452:(e,t,i)=>{Promise.resolve().then(i.bind(i,15263))},46102:(e,t,i)=>{"use strict";i.d(t,{Bc:()=>l,ZI:()=>c,k$:()=>d,m_:()=>o});var s=i(95155),n=i(12115),r=i(89613),a=i(59434);let l=r.Kq,o=r.bL,d=r.l9,c=n.forwardRef((e,t)=>{let{className:i,sideOffset:n=4,...l}=e;return(0,s.jsx)(r.UC,{ref:t,sideOffset:n,className:(0,a.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",i),...l})});c.displayName=r.UC.displayName},47262:(e,t,i)=>{"use strict";i.d(t,{S:()=>o});var s=i(95155),n=i(12115),r=i(76981),a=i(10518),l=i(59434);let o=n.forwardRef((e,t)=>{let{className:i,...n}=e;return(0,s.jsx)(r.bL,{ref:t,className:(0,l.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",i),...n,children:(0,s.jsx)(r.C1,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(a.A,{className:"h-4 w-4"})})})});o.displayName=r.bL.displayName},62523:(e,t,i)=>{"use strict";i.d(t,{p:()=>a});var s=i(95155),n=i(12115),r=i(59434);let a=n.forwardRef((e,t)=>{let{className:i,type:n,...a}=e;return(0,s.jsx)("input",{type:n,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i),ref:t,...a})});a.displayName="Input"},80333:(e,t,i)=>{"use strict";i.d(t,{d:()=>l});var s=i(95155),n=i(12115),r=i(4884),a=i(59434);let l=n.forwardRef((e,t)=>{let{className:i,...n}=e;return(0,s.jsx)(r.bL,{className:(0,a.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",i),...n,ref:t,children:(0,s.jsx)(r.zi,{className:(0,a.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});l.displayName=r.bL.displayName},85057:(e,t,i)=>{"use strict";i.d(t,{J:()=>d});var s=i(95155),n=i(12115),r=i(40968),a=i(74466),l=i(59434);let o=(0,a.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:i,...n}=e;return(0,s.jsx)(r.b,{ref:t,className:(0,l.cn)(o(),i),...n})});d.displayName=r.b.displayName},87481:(e,t,i)=>{"use strict";i.d(t,{dj:()=>m});var s=i(12115);let n=0,r=new Map,a=e=>{if(r.has(e))return;let t=setTimeout(()=>{r.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:i}=t;return i?a(i):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===i||void 0===i?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=l(d,e),o.forEach(e=>{e(d)})}function u(e){let{...t}=e,i=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:i});return c({type:"ADD_TOAST",toast:{...t,id:i,open:!0,onOpenChange:e=>{e||s()}}}),{id:i,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:i}})}}function m(){let[e,t]=s.useState(d);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},88539:(e,t,i)=>{"use strict";i.d(t,{T:()=>a});var s=i(95155),n=i(12115),r=i(59434);let a=n.forwardRef((e,t)=>{let{className:i,...n}=e;return(0,s.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i),ref:t,...n})});a.displayName="Textarea"}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7446,9352,4453,4602,6766,65,1342,5740,9613,9434,4123,8441,1684,7358],()=>t(40452)),_N_E=e.O()}]);