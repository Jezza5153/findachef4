(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4051],{26126:(e,t,a)=>{"use strict";a.d(t,{E:()=>n});var s=a(95155);a(12115);var l=a(74466),r=a(59434);let i=(0,l.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:a,...l}=e;return(0,s.jsx)("div",{className:(0,r.cn)(i({variant:a}),t),...l})}},54165:(e,t,a)=>{"use strict";a.r(t),a.d(t,{Dialog:()=>o,DialogClose:()=>m,DialogContent:()=>x,DialogDescription:()=>g,DialogFooter:()=>h,DialogHeader:()=>f,DialogOverlay:()=>u,DialogPortal:()=>c,DialogTitle:()=>p,DialogTrigger:()=>d});var s=a(95155),l=a(12115),r=a(15452),i=a(54416),n=a(59434);let o=r.bL,d=r.l9,c=r.ZL,m=r.bm,u=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.hJ,{ref:t,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l})});u.displayName=r.hJ.displayName;let x=l.forwardRef((e,t)=>{let{className:a,children:l,...o}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(r.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[l,(0,s.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(i.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});x.displayName=r.UC.displayName;let f=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};f.displayName="DialogHeader";let h=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};h.displayName="DialogFooter";let p=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",a),...l})});p.displayName=r.hE.displayName;let g=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...l})});g.displayName=r.VY.displayName},62523:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var s=a(95155),l=a(12115),r=a(59434);let i=l.forwardRef((e,t)=>{let{className:a,type:l,...i}=e;return(0,s.jsx)("input",{type:l,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...i})});i.displayName="Input"},69513:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>L});var s=a(95155),l=a(12115),r=a(59576),i=a(56104),n=a(35317),o=a(30285),d=a(62523),c=a(26126),m=a(66695),u=a(54165),x=a(14541),f=a(34869),h=a(32919),p=a(8593),g=a(4516),v=a(55868),N=a(17580),j=a(51154),b=a(81497),y=a(85388),w=a(66766),D=a(87481),C=a(35695);let A="Both",P="Chef Wall",k="Customer Wall",E=[A,P,k],T=[k];function L(){let{user:e,userProfile:t,isChef:a,isChefSubscribed:L,isCustomer:S,loading:W}=(0,r.A)(),I=(0,C.useRouter)(),{toast:F}=(0,D.dj)(),[M,R]=(0,l.useState)(k);(0,l.useEffect)(()=>{a&&R(A),S&&R(k)},[a,S]);let[O,B]=(0,l.useState)([]),[H,J]=(0,l.useState)([]),[U,z]=(0,l.useState)(!0),[_,$]=(0,l.useState)(""),[q,Z]=(0,l.useState)(null),[G,V]=(0,l.useState)(!1),[Y,Q]=(0,l.useState)([]),[K,X]=(0,l.useState)(""),[ee,et]=(0,l.useState)(!1),[ea,es]=(0,l.useState)(!1);(0,l.useEffect)(()=>{W||e||I.replace("/login?redirect=/wall")},[W,e,I]),(0,l.useEffect)(()=>{if(!e)return;z(!0);let t=(0,n.P)((0,n.rJ)(i.db,"chefWallEvents"),(0,n.My)("eventDateTime","asc"));a||(t=(0,n.P)((0,n.rJ)(i.db,"chefWallEvents"),(0,n._M)("isPublic","==",!0),(0,n.My)("eventDateTime","asc")));let s=(0,n.aQ)(t,e=>{B(e.docs.map(e=>{var t,a,s,l;return{id:e.id,...e.data(),eventDateTime:e.data().eventDateTime instanceof n.Dc?e.data().eventDateTime.toDate().toISOString():e.data().eventDateTime,createdAt:(null==(a=e.data().createdAt)||null==(t=a.toDate)?void 0:t.call(a))||null,updatedAt:(null==(l=e.data().updatedAt)||null==(s=l.toDate)?void 0:s.call(l))||null}})),z(!1)});return()=>s()},[e,a]),(0,l.useEffect)(()=>{if(!e)return;z(!0);let t=(0,n.P)((0,n.rJ)(i.db,"customerWallRequests"),(0,n.My)("createdAt","desc")),a=(0,n.aQ)(t,e=>{J(e.docs.map(e=>{var t,a,s,l;return{id:e.id,...e.data(),createdAt:(null==(a=e.data().createdAt)||null==(t=a.toDate)?void 0:t.call(a))||null,updatedAt:(null==(l=e.data().updatedAt)||null==(s=l.toDate)?void 0:s.call(l))||null}})),z(!1)});return()=>a()},[e]);let el=(0,l.useMemo)(()=>O.filter(e=>{var t,a,s;let l=_.toLowerCase();return(null==(t=e.title)?void 0:t.toLowerCase().includes(l))||(null==(a=e.description)?void 0:a.toLowerCase().includes(l))||(null==(s=e.location)?void 0:s.toLowerCase().includes(l))||e.chefName&&e.chefName.toLowerCase().includes(l)||e.tags&&e.tags.some(e=>e.toLowerCase().includes(l))}),[O,_]),er=(0,l.useMemo)(()=>H.filter(e=>{var t,a,s;let l=_.toLowerCase();return(null==(t=e.title)?void 0:t.toLowerCase().includes(l))||(null==(a=e.description)?void 0:a.toLowerCase().includes(l))||(null==(s=e.location)?void 0:s.toLowerCase().includes(l))||e.customerName&&e.customerName.toLowerCase().includes(l)||e.tags&&e.tags.some(e=>e.toLowerCase().includes(l))}),[H,_]);function ei(e){if(!e)return"Date TBD";try{let t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";return(0,y.GP)(t,"MMM d, yyyy 'at' h:mm a")}catch(t){return String(e)}}async function en(e){et(!0);try{let t=(0,n.P)((0,n.rJ)(i.db,"wallPosts/".concat(e,"/comments")),(0,n.My)("createdAt","asc")),a=await (0,n.GG)(t);Q(a.docs.map(e=>({id:e.id,...e.data()})))}catch(e){Q([])}finally{et(!1)}}async function eo(){if(e&&q&&K.trim()){et(!0);try{await (0,n.gS)((0,n.rJ)(i.db,"wallPosts/".concat(q.id,"/comments")),{userId:e.uid,userName:e.displayName||e.email||"User",userAvatar:e.photoURL||"",comment:K,createdAt:(0,n.O5)()}),X(""),en(q.id)}catch(e){F({title:"Error",description:"Failed to post comment.",variant:"destructive"})}finally{et(!1)}}}async function ed(t){if(!e){F({title:"Login Required",description:"Please log in to book this event.",variant:"destructive"}),I.push("/login?redirect=/wall");return}es(!0);try{let a=t.eventDateTime instanceof n.Dc?t.eventDateTime:n.Dc.fromDate(new Date(t.eventDateTime)),s={customerId:e.uid,chefId:t.chefId,chefName:t.chefName,chefAvatarUrl:t.chefAvatarUrl,eventTitle:t.title,eventDate:a,pax:1,totalPrice:t.pricePerPerson,pricePerHead:t.pricePerPerson,status:"confirmed",menuTitle:"Event: ".concat(t.title),location:t.location,chefWallEventId:t.id,createdAt:(0,n.O5)(),updatedAt:(0,n.O5)()},l=(0,n.H9)((0,n.rJ)(i.db,"bookings")),r=(0,n.H9)(i.db,"users/".concat(t.chefId,"/calendarEvents"),l.id),o=(0,n.wP)(i.db);o.set(l,s),o.set(r,{id:l.id,chefId:t.chefId,date:a,title:"Booking: ".concat(t.title),customerName:e.displayName||"Customer",pax:1,menuName:s.menuTitle,pricePerHead:s.pricePerHead||0,location:s.location,notes:"Booked from Chef's Wall. Wall Event ID: ".concat(t.id),status:"Confirmed",isWallEvent:!0,bookingId:l.id,createdAt:(0,n.O5)(),updatedAt:(0,n.O5)()}),await o.commit(),F({title:"Event Booked!",description:"You've successfully booked \"".concat(t.title,'".')})}catch(e){F({title:"Booking Failed",description:"Could not book the event. Please try again.",variant:"destructive"})}finally{es(!1)}}function ec(e){var t;let{post:a}=e,l="pricePerPerson"in a;return(0,s.jsxs)(m.Zp,{className:"shadow-lg flex flex-col overflow-hidden hover:shadow-xl transition-shadow duration-200",children:[l&&a.imageUrl?(0,s.jsx)(w.default,{src:a.imageUrl,alt:a.title,width:600,height:300,className:"w-full h-48 object-cover","data-ai-hint":a.dataAiHint||"event food crowd"}):(0,s.jsx)("div",{className:"w-full h-48 bg-muted flex items-center justify-center text-muted-foreground",children:(0,s.jsx)(x.A,{className:"h-16 w-16 opacity-50"})}),(0,s.jsxs)(m.aR,{className:"pb-2 pt-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)(m.ZB,{className:"text-xl",children:a.title}),l?(0,s.jsxs)(c.E,{variant:a.isPublic?"default":"secondary",className:"text-xs",children:[a.isPublic?(0,s.jsx)(f.A,{className:"mr-1 h-3 w-3"}):(0,s.jsx)(h.A,{className:"mr-1 h-3 w-3"}),a.isPublic?"Public":"Private"]}):null]}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:l?"Posted by: ".concat(a.chefName):"Customer: ".concat(a.customerName)})]}),(0,s.jsxs)(m.Wu,{className:"space-y-2 text-sm flex-grow pt-2",children:[(0,s.jsx)("p",{className:"line-clamp-3 text-foreground/80",children:a.description}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(p.A,{className:"mr-2 h-4 w-4 text-primary"}),ei(a.eventDateTime)]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(g.A,{className:"mr-2 h-4 w-4 text-primary"})," ",a.location]}),l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(v.A,{className:"mr-2 h-4 w-4 text-green-600"})," $",null==(t=a.pricePerPerson)?void 0:t.toFixed(2),"/person"]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4 text-primary"})," Max ",a.maxPax," guests"]})]}),a.tags&&a.tags.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:a.tags.map(e=>(0,s.jsx)(c.E,{variant:"outline",className:"text-xs",children:e},e))})]}),(0,s.jsxs)(m.wL,{className:"p-4 border-t bg-muted/20 flex gap-2",children:[(0,s.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>{Z(a),V(!0),"id"in a&&en(a.id)},className:"flex-1",children:[(0,s.jsx)(Info,{className:"mr-1 h-4 w-4"})," Details"]}),l&&a.isPublic&&(0,s.jsxs)(o.$,{variant:"default",size:"sm",onClick:()=>ed(a),disabled:ea,className:"flex-1",children:[ea?(0,s.jsx)(j.A,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Book"]})]})]})}return W||U?(0,s.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,s.jsx)(j.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-2",children:"Loading Wall..."})]}):(0,s.jsxs)("div",{className:"container mx-auto py-8 px-2",children:[(0,s.jsxs)("header",{className:"mb-8 text-center",children:[(0,s.jsxs)("h1",{className:"text-4xl font-bold tracking-tight text-foreground flex items-center justify-center",children:[(0,s.jsx)(x.A,{className:"mr-3 h-8 w-8 text-primary"})," FindAChef Wall"]}),(0,s.jsx)("p",{className:"mt-2 text-foreground/70",children:"Browse and join chef events or customer experiences."})]}),(0,s.jsx)(function(){let e=a?E:T;return(0,s.jsx)("div",{className:"flex mb-8 gap-2 justify-center",children:e.map(e=>(0,s.jsx)(o.$,{variant:M===e?"default":"outline",onClick:()=>R(e),children:e},e))})},{}),(0,s.jsxs)(m.Zp,{className:"mb-8 p-4 shadow-md",children:[(0,s.jsx)("label",{htmlFor:"search-events",className:"block text-sm font-medium text-foreground mb-1",children:"Search Wall"}),(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)(d.p,{id:"search-events",type:"text",placeholder:"Search by title, location, or tags...",value:_,onChange:e=>$(e.target.value),className:"pl-10"})})]}),(M===A||M===P)&&a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold my-4",children:"Chef Wall Events"}),el.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:el.map(e=>(0,s.jsx)(ec,{post:e},e.id))}):(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No chef events found."})]}),(M===A||M===k)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold my-4",children:"Customer Wall Requests"}),er.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:er.map(e=>(0,s.jsx)(ec,{post:e},e.id))}):(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No customer requests found."})]}),q&&(0,s.jsx)(u.Dialog,{open:G,onOpenChange:V,children:(0,s.jsxs)(u.DialogContent,{className:"sm:max-w-lg",children:[(0,s.jsx)(u.DialogHeader,{children:(0,s.jsx)(u.DialogTitle,{className:"text-2xl",children:q.title})}),(0,s.jsxs)("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto p-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-foreground/90",children:q.description}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:[q.location," | ",ei(("eventDateTime"in q,q.eventDateTime))]}),q.tags&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:q.tags.map(e=>(0,s.jsx)(c.E,{variant:"secondary",className:"text-xs",children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-sm font-semibold mb-2 flex items-center",children:[(0,s.jsx)(b.A,{className:"mr-2 h-4 w-4"}),"Comments"]}),(0,s.jsx)("div",{className:"max-h-40 overflow-y-auto bg-muted/30 rounded-md p-2 mb-2",children:ee?(0,s.jsx)(j.A,{className:"h-4 w-4 animate-spin"}):0===Y.length?(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"No comments yet."}):Y.map(e=>(0,s.jsxs)("div",{className:"mb-1",children:[(0,s.jsxs)("span",{className:"font-semibold text-xs",children:[e.userName,":"]})," ",(0,s.jsx)("span",{className:"text-xs",children:e.comment})]},e.id))}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d.p,{value:K,onChange:e=>X(e.target.value),placeholder:"Write a comment...",className:"flex-1",disabled:!e||ee}),(0,s.jsx)(o.$,{size:"sm",onClick:eo,disabled:!K.trim()||ee||!e,children:"Post"})]})]})]}),(0,s.jsx)(u.DialogFooter,{children:(0,s.jsx)(u.DialogClose,{asChild:!0,children:(0,s.jsx)(o.$,{type:"button",variant:"outline",children:"Close"})})})]})})]})}},79768:(e,t,a)=>{Promise.resolve().then(a.bind(a,69513))}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7446,9352,5100,4602,1345,6766,3067,5388,2989,8226,8441,1684,7358],()=>t(79768)),_N_E=e.O()}]);