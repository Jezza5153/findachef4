(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[187],{8417:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>A});var o=r(95155),s=r(12115),n=r(50172),a=r(10469),i=r(28294),l=r(73672),u=r(15121),c=r(89807),d=r(30534),h=r(94063),f=r(59576),p=r(87481);let m=(0,r(55028).default)(()=>Promise.all([r.e(9352),r.e(1345),r.e(6874),r.e(5740),r.e(7649),r.e(9613),r.e(3166),r.e(8447)]).then(r.bind(r,80897)).then(e=>e.DashboardLayout),{loadableGenerated:{webpack:()=>[80897]},ssr:!1,loading:()=>(0,o.jsxs)("div",{className:"flex h-screen items-center justify-center",children:[(0,o.jsx)(n.A,{className:"h-12 w-12 animate-spin text-primary"})," Loading Dashboard..."]})}),g=[{href:"/customer/dashboard",label:"Overview",icon:(0,o.jsx)(a.A,{}),matchExact:!0},{href:"/customer/dashboard/profile",label:"My Profile",icon:(0,o.jsx)(i.A,{})},{href:"/customer/requests/new",label:"Make a Request",icon:(0,o.jsx)(l.A,{})},{href:"/customer/menus",label:"Browse Chef Menus",icon:(0,o.jsx)(u.A,{})},{href:"/customer/wall",label:"Browse Chef Events",icon:(0,o.jsx)(c.A,{})},{href:"/customer/dashboard/events",label:"My Booked Events",icon:(0,o.jsx)(d.A,{})},{href:"/customer/dashboard/messages",label:"Messages",icon:(0,o.jsx)(h.A,{})}];function A(e){let{children:t}=e,{user:r,loading:a,isCustomer:i,profileLoading:l}=(0,f.A)(),{toast:u}=(0,p.dj)(),c=a||l;return((0,s.useEffect)(()=>{if(!c){if(!r){console.log("CustomerDashboardLayout: No user, redirecting to login."),window.location.href="/login?redirect=/customer/dashboard";return}if(!i){u({title:"Access Denied",description:"This dashboard is for customers.",variant:"destructive"}),console.log("CustomerDashboardLayout: User exists but is not a customer, redirecting to login."),window.location.href="/login";return}}},[r,c,i,u]),c)?(0,o.jsxs)("div",{className:"flex h-screen items-center justify-center",children:[(0,o.jsx)(n.A,{className:"h-12 w-12 animate-spin text-primary","data-ai-hint":"loading spinner"}),(0,o.jsx)("p",{className:"ml-3 text-lg",children:"Loading Customer Dashboard..."})]}):r&&i?(0,o.jsx)(m,{navItems:g,children:t}):(0,o.jsxs)("div",{className:"flex h-screen items-center justify-center",children:[(0,o.jsx)(n.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,o.jsx)("p",{className:"ml-3 text-lg",children:"Verifying access..."})]})}},10255:(e,t,r)=>{"use strict";function o(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return o}}),r(95155),r(47650),r(85744),r(20589)},10469:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let o=(0,r(40157).A)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},15121:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let o=(0,r(40157).A)("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]])},17828:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return o}});let o=(0,r(64054).createAsyncLocalStorage)()},28294:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let o=(0,r(40157).A)("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]])},30534:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let o=(0,r(40157).A)("CalendarCheck2",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]])},36645:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});let o=r(88229)._(r(67357));function s(e,t){var r;let s={};"function"==typeof e&&(s.loader=e);let n={...s,...t};return(0,o.default)({...n,modules:null==(r=n.loadableGenerated)?void 0:r.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},50172:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let o=(0,r(40157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},55028:(e,t,r)=>{"use strict";r.d(t,{default:()=>s.a});var o=r(36645),s=r.n(o)},56104:(e,t,r)=>{"use strict";let o,s,n,a;r.d(t,{IG:()=>n,db:()=>a,j2:()=>s});var i=r(23915),l=r(93004),u=r(90858),c=r(35317);let d={apiKey:'"AIzaSyDNMNa2a-BFUlmQ6PAA2hAIA3j07dYQUWQ",',authDomain:'"findachef2.firebaseapp.com",',projectId:'"findachef2",',storageBucket:'"findachef2.firebasestorage.app",',messagingSenderId:'"738524307993",',appId:'"1:738524307993:web:780dbfa516d646154cc088",',measurementId:'ntId: "G-PFXWD80NBY"'};if(d.apiKey&&d.projectId||(console.error("CRITICAL FIREBASE CONFIG ERROR: NEXT_PUBLIC_FIREBASE_API_KEY or NEXT_PUBLIC_FIREBASE_PROJECT_ID is missing or undefined."),console.error("This will cause Firebase services (Auth, Firestore, Storage) to fail."),console.error("Ensure these are correctly set in your .env.local file (for local development) AND in your Vercel project environment variables (for deployment).")),console.log("Firebase Initializing with Project ID:",d.projectId||"MISSING/UNDEFINED"),console.log("Firebase Using API Key (first 5 chars):",d.apiKey?d.apiKey.substring(0,5)+"...":"API Key Not Found/Defined"),(0,i.Dk)().length)o=(0,i.Dk)()[0];else try{o=(0,i.Wp)(d)}catch(e){console.error("Firebase initializeApp error:",e)}o&&d.apiKey&&d.projectId?(s=(0,l.xI)(o),n=(0,u.c7)(o),a=(0,c.aU)(o)):(console.error("Firebase app was not properly initialized due to missing configuration. Other Firebase services (Auth, Storage, Firestore) will NOT be available."),s=null,n=null,a=null)},59576:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,AuthProvider:()=>u});var o=r(95155),s=r(93004),n=r(12115),a=r(56104),i=r(35317);let l=(0,n.createContext)(void 0);function u(e){let{children:t}=e,[r,u]=(0,n.useState)(null),[c,d]=(0,n.useState)(null),[h,f]=(0,n.useState)(!0),[p,m]=(0,n.useState)(!0),[g,A]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1),[x,v]=(0,n.useState)(!1),[S,j]=(0,n.useState)(!1),[C,I]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e;console.log("AuthContext: Setting up onAuthStateChanged listener.");let t=(0,s.hg)(a.j2,async t=>{if(console.log("AuthContext: onAuthStateChanged triggered. CurrentUser UID:",(null==t?void 0:t.uid)||null),d(null),A(!1),b(!1),v(!1),j(!1),I(!1),e&&(console.log("AuthContext: Cleaning up previous Firestore profile listener for old user or on logout."),e(),e=void 0),u(t),t){m(!0),console.log("AuthContext: User found (UID:",t.uid,"). Starting profile and claims loading.");let r=!1;try{console.log("AuthContext: Attempting to fetch ID token result with force refresh for UID:",t.uid);let e=await t.getIdTokenResult(!0);console.log("AuthContext: ID Token Claims for user",t.uid,":",e.claims),r=!!(e.claims&&!0===e.claims.admin),A(r),r?console.log("AuthContext: 'admin' custom claim IS TRUE for user:",t.uid):console.warn("AuthContext: 'admin' custom claim not found or not true for user:",t.uid,"Claims found:",e.claims)}catch(e){console.error("AuthContext: Error fetching ID token result for custom claims for UID:",t.uid,e),A(!1)}try{console.log("AuthContext: Setting up Firestore profile listener for UID:",t.uid);let o=(0,i.H9)(a.db,"users",t.uid);e=(0,i.aQ)(o,e=>{if(e.exists()){let o=e.data(),s={id:e.id,...o,createdAt:o.createdAt instanceof i.Dc?o.createdAt.toDate():o.createdAt?new Date(o.createdAt):void 0,updatedAt:o.updatedAt instanceof i.Dc?o.updatedAt.toDate():o.updatedAt?new Date(o.updatedAt):void 0};console.log("AuthContext: Firestore profile data loaded/updated for UID:",t.uid,"Role:",s.role),d(s);let n="chef"===s.role,a="customer"===s.role,l="admin"===s.role;console.log("AuthContext: Setting isChef based on role:",n),b(n),v(a),l&&!r?console.warn("AuthContext: User has 'admin' role in Firestore, but 'admin' custom claim is missing or false. Custom claims determine admin access."):!l&&r&&console.log("AuthContext: User has 'admin' custom claim, granting admin access. Firestore role is:",s.role),n?(j(s.isApproved||!1),I(s.isSubscribed||!1),console.log("AuthContext: Chef specific flags - Approved:",s.isApproved,"Subscribed:",s.isSubscribed)):(j(!1),I(!1))}else console.warn("AuthContext: No such user profile document in Firestore for UID:",t.uid),d(null),b(!1),v(!1),j(!1),I(!1);m(!1)},e=>{console.error("AuthContext: Error with Firestore profile snapshot listener for UID:",t.uid,e),d(null),b(!1),v(!1),j(!1),I(!1),m(!1)})}catch(e){console.error("AuthContext: Outer error setting up Firestore profile snapshot for UID:",t.uid,e),d(null),b(!1),v(!1),j(!1),I(!1),m(!1)}}else console.log("AuthContext: No current user (logged out). Resetting profile states."),m(!1);f(!1)});return()=>{console.log("AuthContext: Cleaning up onAuthStateChanged listener."),t(),e&&(console.log("AuthContext: Cleaning up profile onSnapshot listener on AuthProvider unmount."),e())}},[]),(0,o.jsx)(l.Provider,{value:{user:r,userProfile:c,loading:h||p,authLoading:h,profileLoading:p,isAdmin:g,isChef:y,isCustomer:x,isChefApproved:S,isChefSubscribed:C},children:t})}function c(){let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},62146:(e,t,r)=>{"use strict";function o(e){let{reason:t,children:r}=e;return r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return o}}),r(45262)},64054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{bindSnapshot:function(){return a},createAsyncLocalStorage:function(){return n},createSnapshot:function(){return i}});let r=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class o{disable(){throw r}getStore(){}run(){throw r}exit(){throw r}enterWith(){throw r}static bind(e){return e}}let s="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function n(){return s?new s:new o}function a(e){return s?s.bind(e):o.bind(e)}function i(){return s?s.snapshot():function(e,...t){return e(...t)}}},66150:(e,t,r)=>{Promise.resolve().then(r.bind(r,8417))},67357:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let o=r(95155),s=r(12115),n=r(62146);function a(e){return{default:e&&"default"in e?e.default:e}}r(10255);let i={loader:()=>Promise.resolve(a(()=>null)),loading:null,ssr:!0},l=function(e){let t={...i,...e},r=(0,s.lazy)(()=>t.loader().then(a)),l=t.loading;function u(e){let a=l?(0,o.jsx)(l,{isLoading:!0,pastDelay:!0,error:null}):null,i=!t.ssr||!!t.loading,u=i?s.Suspense:s.Fragment,c=t.ssr?(0,o.jsxs)(o.Fragment,{children:[null,(0,o.jsx)(r,{...e})]}):(0,o.jsx)(n.BailoutToCSR,{reason:"next/dynamic",children:(0,o.jsx)(r,{...e})});return(0,o.jsx)(u,{...i?{fallback:a}:{},children:c})}return u.displayName="LoadableComponent",u}},73672:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let o=(0,r(40157).A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},85744:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return o.workAsyncStorageInstance}});let o=r(17828)},87481:(e,t,r)=>{"use strict";r.d(t,{dj:()=>h});var o=r(12115);let s=0,n=new Map,a=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?a(r):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],u={toasts:[]};function c(e){u=i(u,e),l.forEach(e=>{e(u)})}function d(e){let{...t}=e,r=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),o=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||o()}}}),{id:r,dismiss:o,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function h(){let[e,t]=o.useState(u);return o.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},89807:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let o=(0,r(40157).A)("CalendarSearch",[["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 11.75V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h7.25",key:"1jrsq6"}],["path",{d:"m22 22-1.875-1.875",key:"13zax7"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}]])},94063:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let o=(0,r(40157).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7446,4453,4602,8441,1684,7358],()=>t(66150)),_N_E=e.O()}]);