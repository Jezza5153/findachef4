(()=>{var e={};e.id=9667,e.ids=[9667],e.modules={643:e=>{"use strict";e.exports=require("node:perf_hooks")},1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},7252:e=>{"use strict";e.exports=require("express")},9795:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/chef/dashboard/menus/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/chef/dashboard/menus/page.tsx","default")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},16141:e=>{"use strict";e.exports=require("node:zlib")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},19063:e=>{"use strict";e.exports=require("require-in-the-middle")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19185:e=>{"use strict";e.exports=require("dgram")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37067:e=>{"use strict";e.exports=require("node:http")},37366:e=>{"use strict";e.exports=require("dns")},37830:e=>{"use strict";e.exports=require("node:stream/web")},44708:e=>{"use strict";e.exports=require("node:https")},45132:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var r=s(65239),i=s(48088),n=s(88170),a=s.n(n),o=s(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let d={children:["",{children:["chef",{children:["dashboard",{children:["menus",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9795)),"/home/user/studio/src/app/chef/dashboard/menus/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,16963)),"/home/user/studio/src/app/chef/dashboard/layout.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,32416)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/home/user/studio/src/app/chef/dashboard/menus/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/chef/dashboard/menus/page",pathname:"/chef/dashboard/menus",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},47002:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=47002,e.exports=t},54379:e=>{"use strict";e.exports=require("node:path")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},55628:(e,t,s)=>{Promise.resolve().then(s.bind(s,84054))},56801:e=>{"use strict";e.exports=require("import-in-the-middle")},57075:e=>{"use strict";e.exports=require("node:stream")},57975:e=>{"use strict";e.exports=require("node:util")},58450:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(82614).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},65313:(e,t,s)=>{"use strict";s.r(t),s.d(t,{"407b8f0736cd0bf4772ca42b28564d4c17ea7e5c2f":()=>d});var r=s(91199);s(42087);var i=s(95427),n=s(37612),a=s(33331);let o=n.z.object({menuTitle:n.z.string().describe("The title of the menu item."),currentDescription:n.z.string().optional().describe("The current description of the menu item (if any)."),cuisine:n.z.string().describe("The cuisine type of the menu item."),keyIngredients:n.z.string().optional().describe("Optional: Comma-separated key ingredients to highlight or consider.")}),l=n.z.object({suggestedDescription:n.z.string().describe("A suggested, enhanced description for the menu item.")});async function d(e){return u(e)}let c=i.ai.definePrompt({name:"menuItemAssistPrompt",input:{schema:o},output:{schema:l},prompt:`You are a creative culinary writer and menu consultant.
A chef needs help refining the description for their menu item.

Menu Item Title: {{{menuTitle}}}
Cuisine Type: {{{cuisine}}}
{{#if currentDescription}}Current Description: {{{currentDescription}}}{{/if}}
{{#if keyIngredients}}Key Ingredients to consider: {{{keyIngredients}}}{{/if}}

Based on this information, please craft a compelling and appealing new description for this menu item.
The description should be concise yet evocative, highlighting its best qualities.
If a current description is provided, aim to enhance it or offer a fresh perspective.
Focus on sensory details, unique aspects, or the story behind the dish if applicable.

Return ONLY the suggested description in the 'suggestedDescription' field of the JSON output.
Do not add any preamble or explanation, just the description text.
For example:
If the current description is "Chicken with rice", and title is "Lemon Herb Chicken", cuisine "Mediterranean", ingredients "lemon, oregano, thyme".
A good suggested description might be: "Tender, pan-seared chicken breast marinated in a vibrant blend of fresh lemon, oregano, and thyme, served alongside fluffy basmati rice. A Mediterranean classic, bursting with zesty and herbaceous flavors."
`}),u=i.ai.defineFlow({name:"menuItemAssistFlow",inputSchema:o,outputSchema:l},async e=>{let{output:t}=await c(e);return t});(0,a.D)([d]),(0,r.A)(d,"407b8f0736cd0bf4772ca42b28564d4c17ea7e5c2f",null)},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},73496:e=>{"use strict";e.exports=require("http2")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},74998:e=>{"use strict";e.exports=require("perf_hooks")},77030:e=>{"use strict";e.exports=require("node:net")},77598:e=>{"use strict";e.exports=require("node:crypto")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},79748:e=>{"use strict";e.exports=require("fs/promises")},81630:e=>{"use strict";e.exports=require("http")},82978:(e,t,s)=>{"use strict";s.d(t,{S:()=>C});var r=s(60687),i=s(43210),n=s(98599),a=s(11273),o=s(70569),l=s(65551),d=s(83721),c=s(18853),u=s(46059),p=s(14163),m="Checkbox",[h,x]=(0,a.A)(m),[g,f]=h(m),b=i.forwardRef((e,t)=>{let{__scopeCheckbox:s,name:a,checked:d,defaultChecked:c,required:u,disabled:m,value:h="on",onCheckedChange:x,form:f,...b}=e,[y,j]=i.useState(null),P=(0,n.s)(t,e=>j(e)),k=i.useRef(!1),C=!y||f||!!y.closest("form"),[N=!1,A]=(0,l.i)({prop:d,defaultProp:c,onChange:x}),M=i.useRef(N);return i.useEffect(()=>{let e=y?.form;if(e){let t=()=>A(M.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[y,A]),(0,r.jsxs)(g,{scope:s,state:N,disabled:m,children:[(0,r.jsx)(p.sG.button,{type:"button",role:"checkbox","aria-checked":I(N)?"mixed":N,"aria-required":u,"data-state":w(N),"data-disabled":m?"":void 0,disabled:m,value:h,...b,ref:P,onKeyDown:(0,o.m)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,o.m)(e.onClick,e=>{A(e=>!!I(e)||!e),C&&(k.current=e.isPropagationStopped(),k.current||e.stopPropagation())})}),C&&(0,r.jsx)(v,{control:y,bubbles:!k.current,name:a,value:h,checked:N,required:u,disabled:m,form:f,style:{transform:"translateX(-100%)"},defaultChecked:!I(c)&&c})]})});b.displayName=m;var y="CheckboxIndicator",j=i.forwardRef((e,t)=>{let{__scopeCheckbox:s,forceMount:i,...n}=e,a=f(y,s);return(0,r.jsx)(u.C,{present:i||I(a.state)||!0===a.state,children:(0,r.jsx)(p.sG.span,{"data-state":w(a.state),"data-disabled":a.disabled?"":void 0,...n,ref:t,style:{pointerEvents:"none",...e.style}})})});j.displayName=y;var v=e=>{let{control:t,checked:s,bubbles:n=!0,defaultChecked:a,...o}=e,l=i.useRef(null),u=(0,d.Z)(s),p=(0,c.X)(t);i.useEffect(()=>{let e=l.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(u!==s&&t){let r=new Event("click",{bubbles:n});e.indeterminate=I(s),t.call(e,!I(s)&&s),e.dispatchEvent(r)}},[u,s,n]);let m=i.useRef(!I(s)&&s);return(0,r.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??m.current,...o,tabIndex:-1,ref:l,style:{...e.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function I(e){return"indeterminate"===e}function w(e){return I(e)?"indeterminate":e?"checked":"unchecked"}var P=s(58450),k=s(4780);let C=i.forwardRef(({className:e,...t},s)=>(0,r.jsx)(b,{ref:s,className:(0,k.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:(0,r.jsx)(j,{className:(0,k.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(P.A,{className:"h-4 w-4"})})}));C.displayName=b.displayName},84054:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Z});var r=s(60687),i=s(43210),n=s(63442),a=s(27605),o=s(45880),l=s(29523),d=s(71669),c=s(89667),u=s(34729),p=s(27479),m=s(82978),h=s(44493),x=s(11529),g=s(29867),f=s(11516),b=s(71757),y=s(35265),j=s(24555),v=s(82614);let I=(0,v.A)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),w=(0,v.A)("PackageMinus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),P=(0,v.A)("PackagePlus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);var k=s(72963),C=s(76242),N=s(18780),A=s(33784),M=s(75535),q=s(70146),R=s(30474),E=s(6475);let S=(0,E.createServerReference)("407b8f0736cd0bf4772ca42b28564d4c17ea7e5c2f",E.callServer,void 0,E.findSourceMapURL,"assistMenuItem");var U=s(77598),D=s.n(U);let $={randomUUID:D().randomUUID},F=new Uint8Array(256),G=F.length,z=[];for(let e=0;e<256;++e)z.push((e+256).toString(16).slice(1));let _=function(e,t,s){if($.randomUUID&&!t&&!e)return $.randomUUID();let r=(e=e||{}).random||(e.rng||function(){return G>F.length-16&&(D().randomFillSync(F),G=0),F.slice(G,G+=16)})();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){s=s||0;for(let e=0;e<16;++e)t[s+e]=r[e];return t}return function(e,t=0){return(z[e[t+0]]+z[e[t+1]]+z[e[t+2]]+z[e[t+3]]+"-"+z[e[t+4]]+z[e[t+5]]+"-"+z[e[t+6]]+z[e[t+7]]+"-"+z[e[t+8]]+z[e[t+9]]+"-"+z[e[t+10]]+z[e[t+11]]+z[e[t+12]]+z[e[t+13]]+z[e[t+14]]+z[e[t+15]]).toLowerCase()}(r)};var O=s(30036);let H=(0,O.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/menus/page.tsx -> @/components/ui/dialog"]},ssr:!1}),Y=(0,O.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/menus/page.tsx -> @/components/ui/dialog"]},ssr:!1}),B=(0,O.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/menus/page.tsx -> @/components/ui/dialog"]},ssr:!1}),T=(0,O.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/menus/page.tsx -> @/components/ui/dialog"]},ssr:!1}),J=(0,O.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/menus/page.tsx -> @/components/ui/dialog"]},ssr:!1}),L=(0,O.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/menus/page.tsx -> @/components/ui/dialog"]},ssr:!1}),V=[{value:"Vegetarian",label:"Vegetarian"},{value:"Vegan",label:"Vegan"},{value:"Gluten-Free",label:"Gluten-Free"},{value:"Dairy-Free",label:"Dairy-Free"},{value:"Nut-Free",label:"Nut-Free"}],K=o.Ik({id:o.Yj(),name:o.Yj().min(1,{message:"Ingredient name is required."}),quantity:o.au.number().min(.01,{message:"Quantity must be positive."}),unit:o.Yj().min(1,{message:"Unit is required."}),costPerUnit:o.au.number().min(0,{message:"Cost per unit must be non-negative."}),totalCost:o.au.number().optional(),notes:o.Yj().optional()}),X=o.Ik({title:o.Yj().min(3,{message:"Title must be at least 3 characters."}),description:o.Yj().min(10,{message:"Description must be at least 10 characters."}),cuisine:o.Yj().min(2,{message:"Cuisine type is required."}),pricePerHead:o.au.number().min(0,{message:"Sale price must be a positive number."}),pax:o.au.number().min(1,{message:"PAX must be at least 1."}).optional(),costPrice:o.au.number().min(0,{message:"Cost price must be positive."}).optional(),dietaryInfo:o.YO(o.Yj()).optional(),isPublic:o.zM().default(!1),menuImageFile:o.Nl(File).optional().refine(e=>!e||e.size<=2097152,"Max image size is 2MB.").refine(e=>!e||["image/jpeg","image/png","image/webp"].includes(e.type),"Only JPG, PNG, WEBP files are allowed."),dataAiHint:o.Yj().optional().max(30,"Hint should be brief, max 2 words."),menuIngredients:o.YO(K).optional()});function Z(){let{user:e,userProfile:t,isChefSubscribed:s}=(0,N.A)(),[o,v]=(0,i.useState)([]),[E,U]=(0,i.useState)(!0),[D,$]=(0,i.useState)(!1),[F,G]=(0,i.useState)(!1),[z,O]=(0,i.useState)(null),[K,Z]=(0,i.useState)(null),[W,Q]=(0,i.useState)(null),[ee,et]=(0,i.useState)(!1),{toast:es}=(0,g.dj)(),er=(0,a.mN)({resolver:(0,n.u)(X),defaultValues:{title:"",description:"",cuisine:"",pricePerHead:0,dietaryInfo:[],isPublic:!1,menuImageFile:void 0,pax:1,costPrice:0,dataAiHint:"",menuIngredients:[]}}),{fields:ei,append:en,remove:ea}=(0,a.jz)({control:er.control,name:"menuIngredients"}),eo=er.watch("menuIngredients"),el=er.watch("pax"),ed=(0,i.useMemo)(()=>eo?.reduce((e,t)=>e+(Number(t.quantity)||0)*(Number(t.costPerUnit)||0),0)||0,[eo]),ec=(0,i.useMemo)(()=>ed/Math.max(1,Number(el)||1),[ed,el]),eu=e=>{let t=e.target.files?.[0];if(t){er.setValue("menuImageFile",t,{shouldValidate:!0}),Z(t);let e=new FileReader;e.onloadend=()=>{Q(e.result)},e.readAsDataURL(t)}else er.setValue("menuImageFile",void 0),Z(null),Q(z?.imageUrl||null)},ep=async s=>{if(!e||!t)return void es({title:"Authentication Error",description:"You must be logged in to manage menus.",variant:"destructive"});$(!0);let r=z?.imageUrl||"",i=z?.id||(0,M.H9)((0,M.rJ)(A.db,"menus")).id;try{if(K){if(z&&z.imageUrl&&z.imageUrl.startsWith("https://firebasestorage.googleapis.com"))try{let e=(0,q.KR)(A.IG,z.imageUrl);await (0,q.XR)(e).catch(e=>console.warn("Old image not found or could not be deleted for menu:",e))}catch(e){console.warn("Error deleting old menu image:",e)}let t=K.name.split(".").pop(),s=`users/${e.uid}/menus/${i}/image.${t}`,n=(0,q.KR)(A.IG,s);es({title:"Uploading image...",description:"Please wait."});let a=(0,q.bp)(n,K);await new Promise((e,t)=>{a.on("state_changed",null,e=>{console.error("Menu image upload error:",e),t(e)},async()=>{r=await (0,q.qk)(a.snapshot.ref),e()})})}let n=s.menuIngredients?.map(e=>({...e,totalCost:(Number(e.quantity)||0)*(Number(e.costPerUnit)||0)}))||[],a=n.reduce((e,t)=>e+(t.totalCost||0),0),o=Math.max(1,Number(s.pax)||1),l={title:s.title,description:s.description,cuisine:s.cuisine,pricePerHead:s.pricePerHead,pax:s.pax,costPrice:s.costPrice,dietaryInfo:s.dietaryInfo||[],isPublic:s.isPublic,imageUrl:r,dataAiHint:s.dataAiHint,chefId:e.uid,chefName:t.name||e.displayName||"Chef",chefProfilePictureUrl:t.profilePictureUrl||e.photoURL||void 0,menuIngredients:n,calculatedTotalIngredientCost:a,calculatedCostPricePerHead:a/o,adminStatus:z?.adminStatus||"pending",updatedAt:(0,M.O5)()};if(z){let e=(0,M.H9)(A.db,"menus",z.id);await (0,M.mZ)(e,l),es({title:"Menu Updated",description:`"${s.title}" has been successfully updated.`})}else{let e=(0,M.H9)(A.db,"menus",i);await (0,M.BN)(e,{...l,id:e.id,createdAt:(0,M.O5)()}),es({title:"Menu Created",description:`"${s.title}" has been successfully created.`})}er.reset(),O(null),G(!1),Z(null),Q(null)}catch(e){console.error("Error saving menu:",e),es({title:"Save Failed",description:"Could not save your menu. Please try again.",variant:"destructive"})}finally{$(!1)}},em=e=>{let t=o.find(t=>t.id===e);t&&(O(t),er.reset({title:t.title,description:t.description,cuisine:t.cuisine,pricePerHead:t.pricePerHead||0,pax:t.pax||1,costPrice:t.costPrice||0,dietaryInfo:t.dietaryInfo||[],isPublic:t.isPublic,menuImageFile:void 0,dataAiHint:t.dataAiHint||"",menuIngredients:t.menuIngredients?.map(e=>({...e,id:e.id||_()}))||[]}),Q(t.imageUrl||null),Z(null),G(!0))},eh=async t=>{if(!e)return;let s=o.find(e=>e.id===t);if(s&&window.confirm(`Are you sure you want to delete the menu "${s?.title}"?`)){$(!0);try{if(s.imageUrl&&s.imageUrl.startsWith("https://firebasestorage.googleapis.com"))try{let e=(0,q.KR)(A.IG,s.imageUrl);await (0,q.XR)(e)}catch(e){console.warn("Could not delete menu image from storage:",s.imageUrl,e)}await (0,M.kd)((0,M.H9)(A.db,"menus",t)),es({title:"Menu Deleted",description:`"${s?.title}" has been deleted.`,variant:"destructive"})}catch(e){console.error("Error deleting menu:",e),es({title:"Delete Error",description:"Could not delete menu.",variant:"destructive"})}finally{$(!1)}}},ex=async t=>{if(!e)return void es({title:"Not Logged In",description:"Please log in to add items to your shopping list.",variant:"destructive"});let s=t.costPrice??t.calculatedCostPricePerHead??0,r=t.pax??1,i={chefId:e.uid,name:`Ingredients for ${t.title}`,quantity:r,unit:"Servings",estimatedCost:s*r,notes:`For menu: ${t.title} (ID: ${t.id}). Cost per head: $${s.toFixed(2)} for ${r} PAX.`,purchased:!1,menuId:t.id};try{let t=(0,M.rJ)(A.db,`users/${e.uid}/shoppingListItems`);await (0,M.gS)(t,{...i,createdAt:(0,M.O5)(),updatedAt:(0,M.O5)()}),es({title:"Added to Shopping List",description:`"${i.name}" added.`})}catch(e){console.error("Error adding to shopping list:",e),es({title:"Error",description:"Could not add item to shopping list.",variant:"destructive"})}},eg=()=>{er.reset({title:"",description:"",cuisine:"",pricePerHead:0,dietaryInfo:[],isPublic:!1,menuImageFile:void 0,pax:1,costPrice:0,dataAiHint:"",menuIngredients:[]}),O(null),Z(null),Q(null),G(!0)},ef=async()=>{let{title:e,description:t,cuisine:s,menuIngredients:r}=er.getValues();if(!e||!s)return void es({title:"Missing Information for AI",description:"Please provide at least a Menu Title and Cuisine Type for AI assistance.",variant:"destructive"});et(!0),es({title:"AI Menu Assist",description:"Generating suggestions..."});try{let i=r?.map(e=>e.name).filter(Boolean).join(", "),n=await S({menuTitle:e,currentDescription:t,cuisine:s,keyIngredients:i});n&&n.suggestedDescription?(er.setValue("description",n.suggestedDescription,{shouldValidate:!0}),es({title:"AI Suggestion Applied",description:"Description updated with AI suggestion."})):es({title:"AI Menu Assist",description:"Could not generate a suggestion at this time.",variant:"default"})}catch(e){console.error("Error with AI Menu Assist:",e),es({title:"AI Error",description:"Failed to get AI suggestions.",variant:"destructive"})}finally{et(!1)}};return E?(0,r.jsxs)("div",{className:"flex h-screen items-center justify-center",children:[(0,r.jsx)(f.A,{className:"h-8 w-8 animate-spin"})," Loading menus..."]}):(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold flex items-center",children:[(0,r.jsx)(b.A,{className:"mr-3 h-8 w-8 text-primary"})," Manage Your Menus"]}),(0,r.jsxs)(l.$,{onClick:eg,disabled:D,children:[(0,r.jsx)(y.A,{className:"mr-2 h-5 w-5"})," Add New Menu"]})]}),(0,r.jsx)(H,{open:F,onOpenChange:e=>{(D||ee)&&e||(G(e),e||(Z(null),Q(null),er.reset(),O(null)))},children:(0,r.jsxs)(Y,{className:"sm:max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)(B,{children:(0,r.jsx)(T,{children:z?"Edit Menu":"Create New Menu"})}),(0,r.jsx)(d.lV,{...er,children:(0,r.jsxs)("form",{onSubmit:er.handleSubmit(ep),className:"space-y-6 p-1",children:[(0,r.jsx)(d.zB,{control:er.control,name:"title",render:({field:e})=>(0,r.jsxs)(d.eI,{children:[(0,r.jsx)(d.lR,{children:"Menu Title"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(c.p,{placeholder:"e.g., Summer BBQ Special",...e})}),(0,r.jsx)(d.C5,{})]})}),(0,r.jsx)(d.zB,{control:er.control,name:"cuisine",render:({field:e})=>(0,r.jsxs)(d.eI,{children:[(0,r.jsx)(d.lR,{children:"Cuisine Type"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(c.p,{placeholder:"e.g., Mexican, Thai, Fusion",...e})}),(0,r.jsx)(d.C5,{})]})}),(0,r.jsx)(d.zB,{control:er.control,name:"description",render:({field:e})=>(0,r.jsxs)(d.eI,{children:[(0,r.jsx)(d.lR,{children:"Description"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(u.T,{placeholder:"Detailed description of the menu...",...e,className:"min-h-[100px]"})}),(0,r.jsx)(d.C5,{})]})}),(0,r.jsxs)(l.$,{type:"button",variant:"outline",onClick:ef,size:"sm",className:"w-full",disabled:ee||D,children:[ee?(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,r.jsx)(j.A,{className:"mr-2 h-4 w-4"}),ee?"Getting Suggestion...":"AI Assist: Enhance Description"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(d.zB,{control:er.control,name:"pricePerHead",render:({field:e})=>(0,r.jsxs)(d.eI,{children:[(0,r.jsx)(d.lR,{children:"Sale Price per Head ($)"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(c.p,{type:"number",step:"0.01",placeholder:"75.00",...e})}),(0,r.jsx)(d.Rr,{children:"The price customers will pay."}),(0,r.jsx)(d.C5,{})]})}),(0,r.jsx)(d.zB,{control:er.control,name:"pax",render:({field:e})=>(0,r.jsxs)(d.eI,{children:[(0,r.jsx)(d.lR,{children:"Serves (PAX)"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(c.p,{type:"number",placeholder:"e.g., 10",...e,defaultValue:1})}),(0,r.jsx)(d.Rr,{children:"Number of people this menu typically serves. Affects per-head cost calculation."}),(0,r.jsx)(d.C5,{})]})})]}),(0,r.jsx)(d.zB,{control:er.control,name:"menuImageFile",render:()=>(0,r.jsxs)(d.eI,{children:[(0,r.jsx)(d.lR,{children:"Menu Image (Optional)"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(c.p,{type:"file",accept:"image/jpeg,image/png,image/webp",onChange:eu,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary/10 file:text-primary hover:file:bg-primary/20"})}),W&&(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(R.default,{src:W,alt:"Menu image preview",width:200,height:150,className:"rounded-md object-cover","data-ai-hint":"menu food"})}),(0,r.jsx)(d.Rr,{children:"A captivating image for your menu (max 2MB, JPG/PNG/WEBP)."}),(0,r.jsx)(d.C5,{})]})}),(0,r.jsx)(d.zB,{control:er.control,name:"dataAiHint",render:({field:e})=>(0,r.jsxs)(d.eI,{children:[(0,r.jsx)(d.lR,{children:"Image Description Hint (for AI)"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(c.p,{placeholder:"e.g., italian food, pasta dish",...e})}),(0,r.jsx)(d.Rr,{children:"One or two keywords to help AI understand the image content (max 2 words)."}),(0,r.jsx)(d.C5,{})]})}),(0,r.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold flex items-center",children:[(0,r.jsx)(I,{className:"mr-2 h-5 w-5"}),"Ingredients & Costing"]}),ei.map((e,t)=>(0,r.jsxs)(h.Zp,{className:"p-4 space-y-3 bg-muted/30",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)(d.lR,{children:["Ingredient ",t+1]}),(0,r.jsx)(l.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>ea(t),className:"text-destructive hover:text-destructive",children:(0,r.jsx)(w,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,r.jsx)(d.zB,{control:er.control,name:`menuIngredients.${t}.name`,render:({field:e})=>(0,r.jsxs)(d.eI,{className:"col-span-2 md:col-span-1",children:[(0,r.jsx)(d.lR,{className:"text-xs",children:"Name"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(c.p,{placeholder:"e.g., Flour",...e})}),(0,r.jsx)(d.C5,{})]})}),(0,r.jsx)(d.zB,{control:er.control,name:`menuIngredients.${t}.quantity`,render:({field:e})=>(0,r.jsxs)(d.eI,{children:[(0,r.jsx)(d.lR,{className:"text-xs",children:"Qty"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(c.p,{type:"number",step:"0.01",placeholder:"2.5",...e})}),(0,r.jsx)(d.C5,{})]})}),(0,r.jsx)(d.zB,{control:er.control,name:`menuIngredients.${t}.unit`,render:({field:e})=>(0,r.jsxs)(d.eI,{children:[(0,r.jsx)(d.lR,{className:"text-xs",children:"Unit"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(c.p,{placeholder:"kg, pcs, L",...e})}),(0,r.jsx)(d.C5,{})]})}),(0,r.jsx)(d.zB,{control:er.control,name:`menuIngredients.${t}.costPerUnit`,render:({field:e})=>(0,r.jsxs)(d.eI,{children:[(0,r.jsx)(d.lR,{className:"text-xs",children:"Cost/Unit ($)"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(c.p,{type:"number",step:"0.01",placeholder:"5.99",...e})}),(0,r.jsx)(d.C5,{})]})})]}),(0,r.jsx)(d.zB,{control:er.control,name:`menuIngredients.${t}.notes`,render:({field:e})=>(0,r.jsxs)(d.eI,{children:[(0,r.jsx)(d.lR,{className:"text-xs",children:"Notes (Optional)"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(c.p,{placeholder:"Brand, specific type",...e})})]})}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Total for this ingredient: $ ",((Number(er.getValues(`menuIngredients.${t}.quantity`))||0)*(Number(er.getValues(`menuIngredients.${t}.costPerUnit`))||0)).toFixed(2)]})]},e.id)),(0,r.jsxs)(l.$,{type:"button",variant:"outline",size:"sm",onClick:()=>en({id:_(),name:"",quantity:1,unit:"",costPerUnit:0,notes:""}),children:[(0,r.jsx)(P,{className:"mr-2 h-4 w-4"})," Add Ingredient"]}),(0,r.jsxs)("div",{className:"mt-4 p-3 bg-secondary rounded-md space-y-1 text-sm",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Total Ingredient Cost for Menu:"})," $",ed.toFixed(2)]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:["Calculated Cost per Head (for ",er.getValues("pax")||1," PAX):"]})," $",ec.toFixed(2)]})]}),(0,r.jsx)(d.zB,{control:er.control,name:"costPrice",render:({field:e})=>(0,r.jsxs)(d.eI,{children:[(0,r.jsx)(d.lR,{children:"Final Determined Cost Price per Head ($)"}),(0,r.jsx)(d.MJ,{children:(0,r.jsx)(c.p,{type:"number",step:"0.01",placeholder:"30.00",...e})}),(0,r.jsx)(d.Rr,{children:"Your internal cost per serving. You can use the calculated value above or enter your own."}),(0,r.jsx)(d.C5,{})]})}),(0,r.jsx)(l.$,{type:"button",variant:"link",size:"sm",className:"p-0 h-auto",onClick:()=>er.setValue("costPrice",parseFloat(ec.toFixed(2))),disabled:0===ec&&0===ed,children:"Use Calculated Cost per Head"})]}),(0,r.jsxs)(d.eI,{className:"pt-4 border-t",children:[(0,r.jsx)(d.lR,{children:"Dietary Information (Flags)"}),(0,r.jsx)(a.xI,{name:"dietaryInfo",control:er.control,render:({field:e})=>(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:V.map(t=>(0,r.jsxs)(d.eI,{className:"flex flex-row items-start space-x-3 space-y-0",children:[(0,r.jsx)(d.MJ,{children:(0,r.jsx)(m.S,{checked:e.value?.includes(t.value),onCheckedChange:s=>s?e.onChange([...e.value||[],t.value]):e.onChange((e.value||[]).filter(e=>e!==t.value))})}),(0,r.jsx)(d.lR,{className:"font-normal",children:t.label})]},t.value))})}),(0,r.jsx)(d.C5,{})]}),(0,r.jsx)(d.zB,{control:er.control,name:"isPublic",render:({field:e})=>(0,r.jsxs)(d.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-4 shadow-sm",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(d.lR,{className:"text-base",children:"Publish Menu"}),(0,r.jsxs)(d.Rr,{children:["Make this menu visible to customers on the public menu listings.",!s&&e.value&&" Public visibility requires an active subscription.",!s&&!e.value&&" Publishing public menus requires an active subscription."]})]}),(0,r.jsx)(C.Bc,{children:(0,r.jsxs)(C.m_,{delayDuration:100,children:[(0,r.jsx)(C.k$,{asChild:!0,children:(0,r.jsx)(d.MJ,{children:(0,r.jsx)(p.d,{checked:e.value,onCheckedChange:t=>{if(t&&!s)return void es({title:"Subscription Required",description:"You need an active subscription to publish menus publicly.",variant:"destructive"});e.onChange(t)},disabled:D||e.value&&!s})})}),!s&&(0,r.jsx)(C.ZI,{children:(0,r.jsxs)("p",{className:"flex items-center",children:[(0,r.jsx)(k.A,{className:"mr-2 h-4 w-4"}),"Subscription required to publish publicly."]})})]})})]})}),(0,r.jsxs)(J,{children:[(0,r.jsx)(L,{asChild:!0,children:(0,r.jsx)(l.$,{type:"button",variant:"outline",disabled:D||ee,children:"Cancel"})}),(0,r.jsx)(l.$,{type:"submit",disabled:D||ee||er.getValues("isPublic")&&!s,children:D?(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4 animate-spin"}):z?"Save Changes":"Create Menu"})]})]})})]})}),o.length>0?(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(e=>(0,r.jsx)(x.Y,{menu:e,onEdit:()=>em(e.id),onDelete:()=>eh(e.id),onAddToShoppingList:()=>ex(e),isChefOwner:!0,showChefDetails:!1},e.id))}):!E&&(0,r.jsxs)(h.Zp,{className:"text-center py-12 border-dashed",children:[(0,r.jsxs)(h.aR,{children:[(0,r.jsx)(b.A,{className:"mx-auto h-12 w-12 text-muted-foreground mb-3","data-ai-hint":"notebook empty"}),(0,r.jsx)(h.ZB,{children:"No Menus Yet"})]}),(0,r.jsxs)(h.Wu,{children:[(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"You haven't created any menus. Get started by adding your first one!"}),(0,r.jsxs)(l.$,{onClick:eg,children:[(0,r.jsx)(y.A,{className:"mr-2 h-5 w-5"})," Create Your First Menu"]})]})]})]})}},84297:e=>{"use strict";e.exports=require("async_hooks")},91645:e=>{"use strict";e.exports=require("net")},92076:(e,t,s)=>{Promise.resolve().then(s.bind(s,9795))},94735:e=>{"use strict";e.exports=require("events")},95427:(e,t,s)=>{"use strict";s.d(t,{ai:()=>n});var r=s(37612),i=s(56758);process.env.GOOGLE_API_KEY?console.log("Genkit: GOOGLE_API_KEY found (first 5 chars):",process.env.GOOGLE_API_KEY.substring(0,5)+"..."):console.warn("Genkit: GOOGLE_API_KEY is NOT defined in environment variables. AI features requiring this key will fail.");let n=(0,r.genkit)({plugins:[(0,i.YF)({})]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[4447,8176,1658,474,3033,2105,5509,9345,6632,9989,2628,1529,1591],()=>s(45132));module.exports=r})();