(()=>{var e={};e.id=3128,e.ids=[3128],e.modules={643:e=>{"use strict";e.exports=require("node:perf_hooks")},954:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=r(65239),a=r(48088),i=r(88170),n=r.n(i),o=r(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d={children:["",{children:["chef",{children:["dashboard",{children:["receipts",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,93993)),"/home/user/studio/src/app/chef/dashboard/receipts/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,16963)),"/home/user/studio/src/app/chef/dashboard/layout.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,32416)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/home/user/studio/src/app/chef/dashboard/receipts/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/chef/dashboard/receipts/page",pathname:"/chef/dashboard/receipts",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},6211:(e,t,r)=>{"use strict";r.d(t,{A0:()=>o,BF:()=>l,Hj:()=>d,XI:()=>n,nA:()=>u,nd:()=>c});var s=r(60687),a=r(43210),i=r(4780);let n=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:r,className:(0,i.cn)("w-full caption-bottom text-sm",e),...t})}));n.displayName="Table";let o=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("thead",{ref:r,className:(0,i.cn)("[&_tr]:border-b",e),...t}));o.displayName="TableHeader";let l=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("tbody",{ref:r,className:(0,i.cn)("[&_tr:last-child]:border-0",e),...t}));l.displayName="TableBody",a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("tfoot",{ref:r,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t})).displayName="TableFooter";let d=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("tr",{ref:r,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));d.displayName="TableRow";let c=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("th",{ref:r,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));c.displayName="TableHead";let u=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("td",{ref:r,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));u.displayName="TableCell",a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("caption",{ref:r,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption"},7252:e=>{"use strict";e.exports=require("express")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},15079:(e,t,r)=>{"use strict";r.d(t,{bq:()=>p,eb:()=>f,gC:()=>x,l6:()=>c,yv:()=>u});var s=r(60687),a=r(43210),i=r(24182),n=r(61662),o=r(89743),l=r(58450),d=r(4780);let c=i.bL;i.YJ;let u=i.WT,p=a.forwardRef(({className:e,children:t,...r},a)=>(0,s.jsxs)(i.l9,{ref:a,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,(0,s.jsx)(i.In,{asChild:!0,children:(0,s.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]}));p.displayName=i.l9.displayName;let m=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.PP,{ref:r,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,s.jsx)(o.A,{className:"h-4 w-4"})}));m.displayName=i.PP.displayName;let h=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.wn,{ref:r,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})}));h.displayName=i.wn.displayName;let x=a.forwardRef(({className:e,children:t,position:r="popper",...a},n)=>(0,s.jsx)(i.ZL,{children:(0,s.jsxs)(i.UC,{ref:n,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...a,children:[(0,s.jsx)(m,{}),(0,s.jsx)(i.LM,{className:(0,d.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),(0,s.jsx)(h,{})]})}));x.displayName=i.UC.displayName,a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.JU,{ref:r,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t})).displayName=i.JU.displayName;let f=a.forwardRef(({className:e,children:t,...r},a)=>(0,s.jsxs)(i.q7,{ref:a,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(i.VF,{children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})}),(0,s.jsx)(i.p4,{children:t})]}));f.displayName=i.q7.displayName,a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.wv,{ref:r,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=i.wv.displayName},16141:e=>{"use strict";e.exports=require("node:zlib")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},18329:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},19063:e=>{"use strict";e.exports=require("require-in-the-middle")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19185:e=>{"use strict";e.exports=require("dgram")},19771:e=>{"use strict";e.exports=require("process")},20620:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},21820:e=>{"use strict";e.exports=require("os")},26373:(e,t,r)=>{"use strict";r.d(t,{V:()=>d});var s=r(60687);r(43210);var a=r(43967),i=r(74158),n=r(40871),o=r(4780),l=r(29523);function d({className:e,classNames:t,showOutsideDays:r=!0,...d}){return(0,s.jsx)(n.hv,{showOutsideDays:r,className:(0,o.cn)("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,o.cn)((0,l.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,o.cn)((0,l.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({className:e,...t})=>(0,s.jsx)(a.A,{className:(0,o.cn)("h-4 w-4",e),...t}),IconRight:({className:e,...t})=>(0,s.jsx)(i.A,{className:(0,o.cn)("h-4 w-4",e),...t})},...d})}d.displayName="Calendar"},26622:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},28399:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]])},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30036:(e,t,r)=>{"use strict";r.d(t,{default:()=>a.a});var s=r(49587),a=r.n(s)},33559:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"40927f8807ec76451e0441317d257c24c9ce49bc73":()=>x,"40dc12ff6aade17c2b480cff9632b0364b2480bd8f":()=>c});var s=r(91199);r(42087);var a=r(95427),i=r(37612),n=r(33331);let o=["Ingredient","Equipment","Tax","BAS","Travel","Other"],l=i.z.object({receiptImageUri:i.z.string().describe("A receipt image as a data URI that must include a MIME type and use Base64 encoding. Expected format: 'data:<mimetype>;base64,<encoded_data>'.")}),d=i.z.object({vendor:i.z.string().optional().describe("The vendor name extracted from the receipt."),date:i.z.string().optional().describe("The transaction date (YYYY-MM-DD) from the receipt."),totalAmount:i.z.number().optional().describe("The total amount from the receipt."),suggestedCostType:i.z.enum(o).optional().describe(`The suggested cost category for this receipt (e.g., ${o.join(", ")}).`)});async function c(e){return p(e)}let u=a.ai.definePrompt({name:"receiptParserPrompt",input:{schema:l},output:{schema:d},prompt:`You are an expert receipt analysis AI. Analyze the provided receipt image.
Extract the following information:
1.  Vendor Name (e.g., "SuperMart", "Kitchen Supplies Co.")
2.  Transaction Date (format as YYYY-MM-DD)
3.  Total Amount (as a number, e.g., 125.50)
4.  Suggested Cost Type: Based on the vendor and items (if visible), suggest one of the following cost types: ${o.join(", ")}.

Receipt Image: {{media url=receiptImageUri}}

Return the extracted information in the specified JSON format. If a field cannot be determined, omit it or set it to null where appropriate based on the schema.
`}),p=a.ai.defineFlow({name:"receiptParserFlow",inputSchema:l,outputSchema:d},async e=>{let{output:t}=await u(e);return t});(0,n.D)([c]),(0,s.A)(c,"40dc12ff6aade17c2b480cff9632b0364b2480bd8f",null);let m=i.z.object({region:i.z.string().min(2,{message:"Region is required."}).describe("The chef's country or region for tax context (e.g., Australia, California, UK)."),query:i.z.string().min(10,{message:"Query must be at least 10 characters."}).describe("The chef's specific tax-related question.")}),h=i.z.object({advice:i.z.string().describe("Generated tax advice based on the region and query."),disclaimer:i.z.string().describe("Standard disclaimer about the advice not being professional financial counsel.")});async function x(e){return g(e)}let f=a.ai.definePrompt({name:"taxAdvicePrompt",input:{schema:m},output:{schema:h},prompt:`You are an AI assistant providing general tax information for chefs.
The chef is in the region: {{{region}}}.
Their question is: "{{{query}}}"

Provide helpful, general tax-related advice relevant to their query and region.

IMPORTANT: Always include the following disclaimer at the end of your advice:
"Disclaimer: This information is for general guidance only and not professional tax or financial advice. Consult with a qualified professional for advice tailored to your specific situation."

Structure your response as a JSON object with "advice" and "disclaimer" fields.
`}),g=a.ai.defineFlow({name:"taxAdviceFlow",inputSchema:m,outputSchema:h},async e=>{let{output:t}=await f(e),r="Disclaimer: This information is for general guidance only and not professional tax or financial advice. Consult with a qualified professional for advice tailored to your specific situation.";return t?.disclaimer?t.disclaimer!==r?{advice:t.advice,disclaimer:`${t.disclaimer} ${r}`.trim()}:t:{advice:t?.advice||"Could not generate advice at this time.",disclaimer:r}});(0,n.D)([x]),(0,s.A)(x,"40927f8807ec76451e0441317d257c24c9ce49bc73",null)},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37067:e=>{"use strict";e.exports=require("node:http")},37366:e=>{"use strict";e.exports=require("dns")},37830:e=>{"use strict";e.exports=require("node:stream/web")},38229:(e,t,r)=>{Promise.resolve().then(r.bind(r,59489))},41968:(e,t)=>{"use strict";function r(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"encodeURIPath",{enumerable:!0,get:function(){return r}})},44708:e=>{"use strict";e.exports=require("node:https")},46679:(e,t,r)=>{"use strict";r.d(t,{D:()=>a});var s=r(47138);function a(e){let t=(0,s.a)(e);return t.setHours(23,59,59,999),t}},47002:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=47002,e.exports=t},49587:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a}});let s=r(14985)._(r(64963));function a(e,t){var r;let a={};"function"==typeof e&&(a.loader=e);let i={...a,...t};return(0,s.default)({...i,modules:null==(r=i.loadableGenerated)?void 0:r.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},54379:e=>{"use strict";e.exports=require("node:path")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56780:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let s=r(81208);function a(e){let{reason:t,children:r}=e;throw Object.defineProperty(new s.BailoutToCSRError(t),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})}},56801:e=>{"use strict";e.exports=require("import-in-the-middle")},57075:e=>{"use strict";e.exports=require("node:stream")},57207:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},57975:e=>{"use strict";e.exports=require("node:util")},59489:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>es});var s=r(60687),a=r(43210),i=r(63442),n=r(27605),o=r(45880),l=r(29523),d=r(71669),c=r(89667),u=r(34729),p=r(6211),m=r(44493),h=r(15079),x=r(26373),f=r(84401),g=r(91821),j=r(29867),v=r(4780),y=r(37074),b=r(46679),w=r(73437),N=r(11516),A=r(36644),C=r(35265),R=r(82614);let P=(0,R.A)("MessageCircleQuestion",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),k=(0,R.A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var I=r(26622),T=r(78726);let _=(0,R.A)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var q=r(24555),M=r(36558),E=r(91840),O=r(57207),F=r(99196),S=r(20620),D=r(30474),U=r(6475);let z=(0,U.createServerReference)("40dc12ff6aade17c2b480cff9632b0364b2480bd8f",U.callServer,void 0,U.findSourceMapURL,"receiptParserFlow"),G=(0,U.createServerReference)("40927f8807ec76451e0441317d257c24c9ce49bc73",U.callServer,void 0,U.findSourceMapURL,"getTaxAdvice");var $=r(18780),L=r(33784),B=r(75535),V=r(70146),Y=r(30036);let W=(0,Y.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/receipts/page.tsx -> @/components/ui/dialog"]},ssr:!1}),J=(0,Y.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/receipts/page.tsx -> @/components/ui/dialog"]},ssr:!1}),H=(0,Y.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/receipts/page.tsx -> @/components/ui/dialog"]},ssr:!1}),Z=(0,Y.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/receipts/page.tsx -> @/components/ui/dialog"]},ssr:!1}),K=(0,Y.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/receipts/page.tsx -> @/components/ui/dialog"]},ssr:!1}),X=(0,Y.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/receipts/page.tsx -> @/components/ui/dialog"]},ssr:!1}),Q=(0,Y.default)(async()=>{},{loadableGenerated:{modules:["app/chef/dashboard/receipts/page.tsx -> @/components/ui/dialog"]},ssr:!1}),ee=["Ingredient","Equipment","Tax","BAS","Travel","Other"],et=o.Ik({vendor:o.Yj().min(1,{message:"Vendor name is required."}),date:o.p6({required_error:"Receipt date is required."}),totalAmount:o.au.number().min(.01,{message:"Total amount must be greater than 0."}),assignedToEventId:o.Yj().optional(),assignedToMenuId:o.Yj().optional(),costType:o.k5(ee,{required_error:"Cost type is required."}),notes:o.Yj().optional()}),er=o.Ik({region:o.Yj().min(2,{message:"Region is required (e.g., Australia, California)."}),query:o.Yj().min(10,{message:"Please enter a specific tax question (min 10 characters)."})});function es(){let{user:e}=(0,$.A)(),[t,r]=(0,a.useState)([]),[o,R]=(0,a.useState)(!0),[U,Y]=(0,a.useState)(!1),[es,ea]=(0,a.useState)(!1),[ei,en]=(0,a.useState)(null),[eo,el]=(0,a.useState)(!1),[ed,ec]=(0,a.useState)(null),[eu,ep]=(0,a.useState)(null),[em,eh]=(0,a.useState)(null),[ex,ef]=(0,a.useState)(!1),[eg,ej]=(0,a.useState)(!1),[ev,ey]=(0,a.useState)(!1),[eb,ew]=(0,a.useState)(null),[eN,eA]=(0,a.useState)(!1),eC=(0,a.useRef)(null),eR=(0,a.useRef)(null),eP=(0,a.useRef)(null),[ek,eI]=(0,a.useState)("all"),[eT,e_]=(0,a.useState)(void 0),[eq,eM]=(0,a.useState)(void 0),{toast:eE}=(0,j.dj)(),eO=(0,n.mN)({resolver:(0,i.u)(et),defaultValues:{vendor:"",date:new Date,totalAmount:0,assignedToEventId:"",assignedToMenuId:"",costType:void 0,notes:""}}),eF=(0,n.mN)({resolver:(0,i.u)(er),defaultValues:{region:"",query:""}}),eS=(0,a.useMemo)(()=>t.filter(e=>{let t="all"===ek||e.costType===ek,r=(0,y.o)(new Date(e.date)),s=!eT||r>=(0,y.o)(eT),a=!eq||r<=(0,b.D)(eq);return t&&s&&a}),[t,ek,eT,eq]),eD=(e=null)=>{en(e),ep(e?.imageUrl||null),eh(e?.fileName||null),ef(!1),e?eO.reset({vendor:e.vendor,date:e.date?new Date(e.date):new Date,totalAmount:e.totalAmount,assignedToEventId:e.assignedToEventId||"",assignedToMenuId:e.assignedToMenuId||"",costType:e.costType,notes:e.notes||""}):eO.reset({vendor:"",date:new Date,totalAmount:0,assignedToEventId:"",assignedToMenuId:"",costType:void 0,notes:""}),ea(!0)},eU=async()=>{if(!eu)return void eE({title:"No Image",description:"Please capture or upload an image first.",variant:"destructive"});ej(!0),eE({title:"AI Processing",description:"Analyzing receipt image..."});try{let e=await z({receiptImageUri:eu});if(e){if(e.vendor&&eO.setValue("vendor",e.vendor),e.date)try{let t=new Date(e.date.replace(/-/g,"/"));isNaN(t.getTime())?(console.warn("AI returned unparsable date format for receipt:",e.date),eE({title:"AI Autofill",description:"Could not parse date from AI. Please set manually.",variant:"default"})):eO.setValue("date",t)}catch(t){console.warn("AI returned invalid date format for receipt:",e.date,t),eE({title:"AI Autofill",description:"Error processing date from AI. Please set manually.",variant:"default"})}void 0!==e.totalAmount&&null!==e.totalAmount&&eO.setValue("totalAmount",e.totalAmount),e.suggestedCostType&&eO.setValue("costType",e.suggestedCostType),eE({title:"AI Autofill Complete",description:"Fields populated. Please review."})}else eE({title:"AI Autofill",description:"Could not extract all information. Please fill manually.",variant:"default"})}catch(e){console.error("Error parsing receipt with AI:",e),eE({title:"AI Error",description:"Failed to process receipt with AI.",variant:"destructive"})}finally{ej(!1)}},ez=e=>{let t=atob(e.split(",")[1]),r=e.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(t.length),a=new Uint8Array(s);for(let e=0;e<t.length;e++)a[e]=t.charCodeAt(e);return new Blob([s],{type:r})},eG=async t=>{if(!e)return void eE({title:"Error",description:"You must be logged in.",variant:"destructive"});if(!eu&&!ei?.imageUrl)return void eE({title:"Image Required",description:"Please capture or upload a receipt image.",variant:"destructive"});Y(!0);let r=ei?.imageUrl||"",s=em||ei?.fileName||`receipt_${Date.now()}.jpg`;try{let a=ei?.id||(0,B.H9)((0,B.rJ)(L.db,"temp")).id;if(eu&&(!ei||eu!==ei.imageUrl)){if(ei?.imageUrl&&ei.imageUrl.startsWith("https://firebasestorage.googleapis.com"))try{let e=(0,V.KR)(L.IG,ei.imageUrl);await (0,V.XR)(e).catch(e=>console.warn("Old image not found or could not be deleted for receipt:",e))}catch(e){console.warn("Error deleting old receipt image:",e)}let t=ez(eu),i=`users/${e.uid}/receipts/${a}/${s.replace(/[^a-zA-Z0-9.]/g,"_")}`,n=(0,V.KR)(L.IG,i),o=(0,V.bp)(n,t);await new Promise((e,t)=>{o.on("state_changed",e=>{},e=>{console.error("Receipt image upload error:",e),t(e)},async()=>{r=await (0,V.qk)(o.snapshot.ref),e()})})}let i={...t,chefId:e.uid,date:B.Dc.fromDate(t.date),imageUrl:r,fileName:s,updatedAt:(0,B.O5)()},n=(0,B.H9)(L.db,"users",e.uid,"receipts",a);ei?(await (0,B.mZ)(n,i),eE({title:"Receipt Updated",description:`Receipt from "${t.vendor}" has been updated.`})):(i.createdAt=(0,B.O5)(),await (0,B.BN)(n,{...i,id:n.id}),eE({title:"Receipt Added",description:`Receipt from "${t.vendor}" has been added.`})),eO.reset(),en(null),ea(!1),ep(null),eh(null),eP.current&&(eP.current.value="")}catch(e){console.error("Error saving receipt:",e),eE({title:"Save Failed",description:"Could not save your receipt. Please try again.",variant:"destructive"})}finally{Y(!1)}},e$=async r=>{if(!e)return;let s=t.find(e=>e.id===r);if(s&&window.confirm(`Are you sure you want to delete the receipt from "${s?.vendor}"?`)){Y(!0);try{if(s.imageUrl&&s.imageUrl.startsWith("https://firebasestorage.googleapis.com"))try{let e=(0,V.KR)(L.IG,s.imageUrl);await (0,V.XR)(e)}catch(e){console.warn("Could not delete receipt image from storage:",s.imageUrl,e)}await (0,B.kd)((0,B.H9)(L.db,"users",e.uid,"receipts",r)),eE({title:"Receipt Deleted",description:`Receipt from "${s?.vendor}" removed.`,variant:"destructive"})}catch(e){console.error("Error deleting receipt:",e),eE({title:"Delete Error",description:"Could not delete receipt.",variant:"destructive"})}finally{Y(!1)}}},eL=(0,a.useMemo)(()=>eS.reduce((e,t)=>e+t.totalAmount,0),[eS]),eB=(0,a.useMemo)(()=>{let e={};return ee.forEach(t=>e[t]=0),eS.forEach(t=>{void 0!==e[t.costType]?e[t.costType]+=t.totalAmount:e[t.costType]=t.totalAmount}),e},[eS]),eV=async e=>{eA(!0),ew(null),eE({title:"Getting Tax Advice",description:"Please wait..."});try{let t=await G(e);ew(t)}catch(e){console.error("Error getting tax advice:",e),eE({title:"AI Error",description:"Failed to get tax advice.",variant:"destructive"}),ew({advice:"Could not retrieve advice at this time.",disclaimer:"Please try again later."})}finally{eA(!1)}};return o&&!e?(0,s.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,s.jsx)(N.A,{className:"h-8 w-8 animate-spin text-primary","data-ai-hint":"loading spinner"}),(0,s.jsx)("p",{className:"ml-2",children:"Loading page..."})]}):(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold flex items-center",children:[(0,s.jsx)(A.A,{className:"mr-3 h-8 w-8 text-primary","data-ai-hint":"document file"})," Receipts & Cost Management"]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)(l.$,{onClick:()=>eD(),disabled:U||eg,children:[(0,s.jsx)(C.A,{className:"mr-2 h-5 w-5"})," Add New Receipt"]}),(0,s.jsxs)(l.$,{variant:"outline",onClick:()=>{eF.reset(),ew(null),ey(!0)},children:[(0,s.jsx)(P,{className:"mr-2 h-5 w-5"})," Get Tax Advice"]})]})]}),(0,s.jsxs)(m.Zp,{children:[(0,s.jsx)(m.aR,{children:(0,s.jsxs)(m.ZB,{className:"flex items-center",children:[(0,s.jsx)(k,{className:"mr-2 h-5 w-5 text-primary"})," Filter Receipts"]})}),(0,s.jsxs)(m.Wu,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end",children:[(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Cost Type"}),(0,s.jsxs)(h.l6,{value:ek,onValueChange:eI,children:[(0,s.jsx)(h.bq,{children:(0,s.jsx)(h.yv,{placeholder:"All Cost Types"})}),(0,s.jsxs)(h.gC,{children:[(0,s.jsx)(h.eb,{value:"all",children:"All Cost Types"}),ee.map(e=>(0,s.jsx)(h.eb,{value:e,children:e},e))]})]})]}),(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Start Date"}),(0,s.jsxs)(f.AM,{children:[(0,s.jsx)(f.Wv,{asChild:!0,children:(0,s.jsxs)(l.$,{variant:"outline",className:(0,v.cn)("w-full justify-start text-left font-normal",!eT&&"text-muted-foreground"),children:[(0,s.jsx)(I.A,{className:"mr-2 h-4 w-4"}),eT?(0,w.GP)(eT,"PPP"):(0,s.jsx)("span",{children:"Pick a start date"})]})}),(0,s.jsx)(f.hl,{className:"w-auto p-0",children:(0,s.jsx)(x.V,{mode:"single",selected:eT,onSelect:e_,initialFocus:!0})})]})]}),(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"End Date"}),(0,s.jsxs)(f.AM,{children:[(0,s.jsx)(f.Wv,{asChild:!0,children:(0,s.jsxs)(l.$,{variant:"outline",className:(0,v.cn)("w-full justify-start text-left font-normal",!eq&&"text-muted-foreground"),children:[(0,s.jsx)(I.A,{className:"mr-2 h-4 w-4"}),eq?(0,w.GP)(eq,"PPP"):(0,s.jsx)("span",{children:"Pick an end date"})]})}),(0,s.jsx)(f.hl,{className:"w-auto p-0",children:(0,s.jsx)(x.V,{mode:"single",selected:eq,onSelect:eM,initialFocus:!0,disabled:{before:eT}})})]})]}),(0,s.jsxs)(l.$,{onClick:()=>{eI("all"),e_(void 0),eM(void 0)},variant:"outline",className:"self-end",children:[(0,s.jsx)(T.A,{className:"mr-2 h-4 w-4"})," Clear Filters"]})]})]}),(0,s.jsx)(W,{open:es,onOpenChange:e=>{(U||eg)&&e||(ea(e),!e&&(ep(null),eh(null),ef(!1),eP.current&&(eP.current.value="")))},children:(0,s.jsxs)(J,{className:"sm:max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(H,{children:[(0,s.jsx)(Z,{children:ei?"Edit Receipt":"Add New Receipt"}),Q&&(0,s.jsx)(Q,{children:"Fill in the details for your expense. Use camera or upload a file."})]}),(0,s.jsx)(d.lV,{...eO,children:(0,s.jsxs)("form",{onSubmit:eO.handleSubmit(eG),className:"space-y-4 p-1",children:[(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Receipt Image"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[(0,s.jsxs)(l.$,{type:"button",variant:"outline",onClick:()=>el(!0),className:"w-full sm:w-auto",children:[(0,s.jsx)(_,{className:"mr-2 h-4 w-4"})," Capture with Camera"]}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground hidden sm:block",children:"OR"}),(0,s.jsx)(c.p,{id:"receipt-upload-input",type:"file",accept:"image/png, image/jpeg, image/webp, application/pdf",className:"w-full sm:flex-1",onChange:e=>{let t=e.target.files?.[0];if(t){eh(t.name);let e=new FileReader;e.onloadend=()=>{ep(e.result)},e.readAsDataURL(t)}else eh(null),ep(null)},ref:eP})]}),eu&&(0,s.jsxs)("div",{className:"mt-2 text-center",children:[(0,s.jsx)(D.default,{src:eu,alt:"Receipt preview",width:150,height:200,className:"rounded-md object-contain mx-auto border","data-ai-hint":"receipt document"}),em&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Preview of: ",em]})]}),(0,s.jsx)(d.Rr,{children:"Max 5MB. PDF, JPG, PNG, WEBP."}),(0,s.jsxs)(l.$,{type:"button",onClick:eU,disabled:!eu||eg||U,variant:"outline",className:"w-full mt-2",children:[eg?(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(q.A,{className:"mr-2 h-4 w-4"}),eg?"Parsing...":"Auto-fill with AI (from image)"]})]}),(0,s.jsx)(d.zB,{control:eO.control,name:"vendor",render:({field:e})=>(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Vendor Name"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g., Fresh Produce Market",...e})}),(0,s.jsx)(d.C5,{})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(d.zB,{control:eO.control,name:"date",render:({field:e})=>(0,s.jsxs)(d.eI,{className:"flex flex-col",children:[(0,s.jsx)(d.lR,{children:"Date of Receipt"}),(0,s.jsxs)(f.AM,{children:[(0,s.jsx)(f.Wv,{asChild:!0,children:(0,s.jsx)(d.MJ,{children:(0,s.jsxs)(l.$,{variant:"outline",className:(0,v.cn)("w-full pl-3 text-left font-normal",!e.value&&"text-muted-foreground"),children:[e.value?(0,w.GP)(e.value,"PPP"):(0,s.jsx)("span",{children:"Pick a date"}),(0,s.jsx)(I.A,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,s.jsx)(f.hl,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(x.V,{mode:"single",selected:e.value,onSelect:e.onChange,initialFocus:!0})})]}),(0,s.jsx)(d.C5,{})]})}),(0,s.jsx)(d.zB,{control:eO.control,name:"totalAmount",render:({field:e})=>(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Total Amount ($)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{type:"number",step:"0.01",placeholder:"e.g., 45.99",...e})}),(0,s.jsx)(d.C5,{})]})})]}),(0,s.jsx)(d.zB,{control:eO.control,name:"costType",render:({field:e})=>(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Cost Type"}),(0,s.jsxs)(h.l6,{onValueChange:e.onChange,value:e.value,defaultValue:e.value,children:[(0,s.jsx)(d.MJ,{children:(0,s.jsx)(h.bq,{children:(0,s.jsx)(h.yv,{placeholder:"Select a cost type"})})}),(0,s.jsx)(h.gC,{children:ee.map(e=>(0,s.jsx)(h.eb,{value:e,children:e},e))})]}),(0,s.jsx)(d.C5,{})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(d.zB,{control:eO.control,name:"assignedToEventId",render:({field:e})=>(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Assign to Event ID (Optional)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g., event123",...e})}),(0,s.jsx)(d.Rr,{children:"Link this expense to a specific event."}),(0,s.jsx)(d.C5,{})]})}),(0,s.jsx)(d.zB,{control:eO.control,name:"assignedToMenuId",render:({field:e})=>(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Assign to Menu ID (Optional)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g., menu456",...e})}),(0,s.jsx)(d.Rr,{children:"Link this expense to a specific menu."}),(0,s.jsx)(d.C5,{})]})})]}),(0,s.jsx)(d.zB,{control:eO.control,name:"notes",render:({field:e})=>(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Notes (Optional)"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(u.T,{placeholder:"e.g., Specific items, reason for expense",...e})}),(0,s.jsx)(d.C5,{})]})}),(0,s.jsxs)(K,{children:[(0,s.jsx)(X,{asChild:!0,children:(0,s.jsx)(l.$,{type:"button",variant:"outline",disabled:U||eg,children:"Cancel"})}),(0,s.jsx)(l.$,{type:"submit",disabled:U||eg,children:U?(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4 animate-spin"}):ei?"Save Changes":"Add Receipt"})]})]})})]})}),(0,s.jsx)(W,{open:eo,onOpenChange:e=>{!e&&eC.current?.srcObject&&(eC.current.srcObject.getTracks().forEach(e=>e.stop()),eC.current.srcObject=null,ec(null)),el(e)},children:(0,s.jsxs)(J,{className:"sm:max-w-md",children:[(0,s.jsx)(H,{children:(0,s.jsx)(Z,{children:"Capture Receipt with Camera"})}),!1===ed&&(0,s.jsxs)(g.Fc,{variant:"destructive",children:[(0,s.jsx)(g.XL,{children:"Camera Access Required"}),(0,s.jsx)(g.TN,{children:"Please allow camera access in your browser settings to use this feature. You might need to refresh the page after granting permission."})]}),(0,s.jsx)("video",{ref:eC,className:(0,v.cn)("w-full aspect-video rounded-md bg-muted",{hidden:ex}),autoPlay:!0,playsInline:!0,muted:!0}),(0,s.jsx)("canvas",{ref:eR,className:"hidden"}),ex&&eu&&(0,s.jsx)(D.default,{src:eu,alt:"Captured receipt",width:400,height:300,className:"rounded-md object-contain mx-auto border","data-ai-hint":"receipt scan"}),(0,s.jsx)(K,{className:"sm:justify-between",children:ex?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.$,{type:"button",variant:"outline",onClick:()=>{ef(!1),ep(null),eh(null)},children:"Retake"}),(0,s.jsx)(l.$,{type:"button",onClick:()=>{el(!1)},children:"Use This Image"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(X,{asChild:!0,children:(0,s.jsx)(l.$,{type:"button",variant:"outline",children:"Cancel"})}),(0,s.jsx)(l.$,{type:"button",onClick:()=>{if(eC.current&&eR.current){let e=eC.current,t=eR.current;t.width=e.videoWidth,t.height=e.videoHeight;let r=t.getContext("2d");r&&(r.drawImage(e,0,0,t.width,t.height),ep(t.toDataURL("image/jpeg")),eh(`cam_capture_${Date.now()}.jpg`),ef(!0))}},disabled:!0!==ed,children:"Capture Photo"})]})})]})}),(0,s.jsx)(W,{open:ev,onOpenChange:ey,children:(0,s.jsxs)(J,{className:"sm:max-w-lg",children:[(0,s.jsxs)(H,{children:[(0,s.jsx)(Z,{children:"AI Tax Advice Assistant"}),Q&&(0,s.jsx)(Q,{children:"Ask a tax-related question based on your region. This is not professional advice."})]}),(0,s.jsx)(d.lV,{...eF,children:(0,s.jsxs)("form",{onSubmit:eF.handleSubmit(eV),className:"space-y-4",children:[(0,s.jsx)(d.zB,{control:eF.control,name:"region",render:({field:e})=>(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Your Country/Region"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{placeholder:"e.g., Australia, California, UK",...e})}),(0,s.jsx)(d.C5,{})]})}),(0,s.jsx)(d.zB,{control:eF.control,name:"query",render:({field:e})=>(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Your Tax Question"}),(0,s.jsx)(d.MJ,{children:(0,s.jsx)(u.T,{placeholder:"e.g., What are common tax deductions for private chefs?",...e})}),(0,s.jsx)(d.C5,{})]})}),(0,s.jsxs)(l.$,{type:"submit",disabled:eN,className:"w-full",children:[eN?(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(P,{className:"mr-2 h-4 w-4"}),eN?"Getting Advice...":"Ask AI"]})]})}),eb&&(0,s.jsxs)("div",{className:"mt-6 space-y-3 rounded-md border bg-muted/50 p-4",children:[(0,s.jsx)("h4",{className:"font-semibold",children:"AI Response:"}),(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:eb.advice}),(0,s.jsx)("p",{className:"text-xs italic text-muted-foreground",children:eb.disclaimer})]}),(0,s.jsx)(K,{className:"mt-4",children:(0,s.jsx)(X,{asChild:!0,children:(0,s.jsx)(l.$,{type:"button",variant:"outline",children:"Close"})})})]})}),(0,s.jsxs)(m.Zp,{children:[(0,s.jsx)(m.aR,{children:(0,s.jsx)(m.ZB,{children:"Expenses Summary"})}),(0,s.jsx)(m.Wu,{children:o?(0,s.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,s.jsx)(N.A,{className:"h-6 w-6 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-2",children:"Loading summary..."})]}):0===eS.length&&t.length>0?(0,s.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"No receipts match the current filters."}):(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold mb-2",children:"By Cost Type:"}),Object.entries(eB).map(([e,t])=>(t??0)>0&&(0,s.jsxs)("div",{className:"flex justify-between text-sm py-1 border-b last:border-b-0",children:[(0,s.jsxs)("span",{children:[e,":"]}),(0,s.jsxs)("span",{className:"font-medium",children:["$",(t??0).toFixed(2)]})]},e)),Object.values(eB).every(e=>(e??0)===0)&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"No expenses for selected filters."})]}),(0,s.jsxs)("div",{className:"flex flex-col justify-end items-end",children:[(0,s.jsxs)("div",{className:"text-lg font-semibold flex items-center",children:[(0,s.jsx)(M.A,{className:"mr-1 h-5 w-5 text-green-600","data-ai-hint":"money cost"}),"Total (Filtered): $",eL.toFixed(2)]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Total of ",eS.length," receipt(s) matching filters."]})]})]})})]}),(0,s.jsxs)(m.Zp,{children:[(0,s.jsx)(m.aR,{children:(0,s.jsx)(m.ZB,{children:"Uploaded Receipts"})}),(0,s.jsx)(m.Wu,{children:o&&0===t.length?(0,s.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,s.jsx)(N.A,{className:"h-6 w-6 animate-spin text-primary"}),(0,s.jsx)("p",{className:"ml-2",children:"Loading receipts..."})]}):eS.length>0?(0,s.jsxs)(p.XI,{children:[(0,s.jsx)(p.A0,{children:(0,s.jsxs)(p.Hj,{children:[(0,s.jsx)(p.nd,{children:"Vendor"}),(0,s.jsx)(p.nd,{children:"Date"}),(0,s.jsx)(p.nd,{className:"text-right",children:"Amount"}),(0,s.jsx)(p.nd,{children:"Cost Type"}),(0,s.jsx)(p.nd,{children:"Assigned To"}),(0,s.jsx)(p.nd,{children:"File/Notes"}),(0,s.jsx)(p.nd,{className:"text-right w-[120px]",children:"Actions"})]})}),(0,s.jsx)(p.BF,{children:eS.map(e=>(0,s.jsxs)(p.Hj,{children:[(0,s.jsx)(p.nA,{className:"font-medium",children:e.vendor}),(0,s.jsx)(p.nA,{children:(0,w.GP)(new Date(e.date),"PP")}),(0,s.jsxs)(p.nA,{className:"text-right",children:["$",e.totalAmount.toFixed(2)]}),(0,s.jsx)(p.nA,{children:e.costType}),(0,s.jsxs)(p.nA,{className:"text-xs",children:[e.assignedToEventId&&(0,s.jsxs)("div",{children:["Event: ",e.assignedToEventId]}),e.assignedToMenuId&&(0,s.jsxs)("div",{children:["Menu: ",e.assignedToMenuId]})]}),(0,s.jsxs)(p.nA,{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:[e.fileName&&(0,s.jsx)("div",{className:"font-medium text-foreground",children:e.fileName}),e.imageUrl&&(0,s.jsx)("a",{href:e.imageUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-500 hover:underline",children:"(View Image)"}),e.notes&&(0,s.jsx)("div",{className:"italic",children:e.notes})]}),(0,s.jsxs)(p.nA,{className:"text-right",children:[(0,s.jsxs)(l.$,{variant:"ghost",size:"icon",onClick:()=>eD(e),className:"mr-1",disabled:U||eg,children:[(0,s.jsx)(E.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Edit"})]}),(0,s.jsxs)(l.$,{variant:"ghost",size:"icon",onClick:()=>e$(e.id),className:"text-destructive hover:text-destructive",disabled:U||eg,children:[(0,s.jsx)(O.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Delete"})]})]})]},e.id))})]}):(0,s.jsx)("p",{className:"text-muted-foreground text-center py-8",children:0===t.length?"No receipts uploaded yet. Start by adding your first expense!":"No receipts match the current filters. Try adjusting or clearing them."})})]}),(0,s.jsxs)(m.Zp,{className:"mt-8",children:[(0,s.jsx)(m.aR,{children:(0,s.jsx)(m.ZB,{children:"Financial Tools & Future Features"})}),(0,s.jsxs)(m.Wu,{className:"space-y-3 text-sm text-muted-foreground",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Event Profitability:"})," In the future, you'll be able to filter receipts by Event ID to see specific cost breakdowns and calculate profitability for each event."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Invoice Generation:"})," Upon event completion and confirmation, invoices will be automatically generated for both you and the customer, accessible through your respective dashboards."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"AI Cost Insights:"}),' We\'re working on AI tools to provide deeper insights into your spending patterns, helping you optimize menu pricing and purchasing. (Placeholder: A button "Get AI Insights on Event Costs" could appear here when an event is selected/filtered).']})]})]}),(0,s.jsxs)(g.Fc,{className:"mt-8",children:[(0,s.jsx)(F.A,{className:"h-4 w-4"}),(0,s.jsx)(g.XL,{children:"Payout & Financial Information"}),(0,s.jsx)(g.TN,{children:(0,s.jsxs)("ul",{className:"list-disc list-inside text-xs space-y-1",children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Initial Fund Distribution:"})," Upon customer booking confirmation, 46% of the event cost is released to the chef and 4% to FindAChef immediately."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Escrow & Final Release:"})," The remaining 50% is held by FindAChef. This portion is released to the chef after the event is confirmed complete by the customer (typically via QR code scan at the event)."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Public Ticketed Events:"})," For events you host and sell tickets for via The Chef's Wall, payouts are generally scheduled 7 days *before* the event date to assist with upfront costs (subject to terms)."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Cancellations by Chef:"})," If a chef cancels an event, a full refund is issued to the customer. Admin will be notified to assist and manage chef accountability, which may include penalties if a replacement cannot be found."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Cancellations by Customer:"}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"If a customer cancels more than 20 days before the event, a 50% refund is typically processed."}),(0,s.jsx)("li",{children:"If a customer cancels less than 20 days before the event, a 20% refund is processed. In this case, 15% of the total event cost goes to the chef and 15% to FindAChef."}),(0,s.jsxs)("li",{children:["Refer to the full ",(0,s.jsx)("a",{href:"/terms#cancellation",className:"underline hover:text-primary",children:"Terms of Service"})," for complete cancellation policy details."]})]})]}),(0,s.jsx)("li",{children:"Always ensure all receipts for an event are uploaded promptly for accurate cost tracking and potential tax purposes."})]})})]}),(0,s.jsx)("div",{className:"flex justify-end mt-6",children:(0,s.jsxs)(l.$,{onClick:()=>{if(0===eS.length)return void eE({title:"No Data",description:"Receipt list (with current filters) is empty.",variant:"default"});let e=new Blob([["Vendor,Date,Total Amount,Cost Type,Assigned to Event ID,Assigned to Menu ID,Notes,File Name,Image URL",...eS.map(e=>[`"${(e.vendor||"").replace(/"/g,'""')}"`,(0,w.GP)(e.date,"yyyy-MM-dd"),e.totalAmount.toFixed(2),`"${(e.costType||"").replace(/"/g,'""')}"`,`"${(e.assignedToEventId||"").replace(/"/g,'""')}"`,`"${(e.assignedToMenuId||"").replace(/"/g,'""')}"`,`"${(e.notes||"").replace(/"/g,'""')}"`,`"${(e.fileName||"").replace(/"/g,'""')}"`,`"${(e.imageUrl||"").replace(/"/g,'""')}"`].join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a");if(void 0!==t.download){let r=URL.createObjectURL(e);t.setAttribute("href",r),t.setAttribute("download","filtered_receipts_export.csv"),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(r)}eE({title:"Export Successful",description:"Filtered receipts exported to CSV."})},variant:"outline",disabled:0===eS.length,children:[(0,s.jsx)(S.A,{className:"mr-2 h-5 w-5"})," Export Filtered Data (CSV)"]})})]})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64777:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return o}});let s=r(60687),a=r(51215),i=r(29294),n=r(41968);function o(e){let{moduleIds:t}=e,r=i.workAsyncStorage.getStore();if(void 0===r)return null;let o=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files;o.push(...t)}}return 0===o.length?null:(0,s.jsx)(s.Fragment,{children:o.map(e=>{let t=r.assetPrefix+"/_next/"+(0,n.encodeURIPath)(e);return e.endsWith(".css")?(0,s.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style"},e):((0,a.preload)(t,{as:"script",fetchPriority:"low"}),null)})})}},64963:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let s=r(60687),a=r(43210),i=r(56780),n=r(64777);function o(e){return{default:e&&"default"in e?e.default:e}}let l={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},d=function(e){let t={...l,...e},r=(0,a.lazy)(()=>t.loader().then(o)),d=t.loading;function c(e){let o=d?(0,s.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,l=!t.ssr||!!t.loading,c=l?a.Suspense:a.Fragment,u=t.ssr?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.PreloadChunks,{moduleIds:t.modules}),(0,s.jsx)(r,{...e})]}):(0,s.jsx)(i.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(r,{...e})});return(0,s.jsx)(c,{...l?{fallback:o}:{},children:u})}return c.displayName="LoadableComponent",c}},69678:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]])},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},73496:e=>{"use strict";e.exports=require("http2")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},74998:e=>{"use strict";e.exports=require("perf_hooks")},77030:e=>{"use strict";e.exports=require("node:net")},77598:e=>{"use strict";e.exports=require("node:crypto")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},79748:e=>{"use strict";e.exports=require("fs/promises")},81630:e=>{"use strict";e.exports=require("http")},84297:e=>{"use strict";e.exports=require("async_hooks")},84401:(e,t,r)=>{"use strict";r.d(t,{AM:()=>$,hl:()=>B,Wv:()=>L});var s=r(60687),a=r(43210),i=r(70569),n=r(98599),o=r(11273),l=r(31355),d=r(1359),c=r(32547),u=r(96963),p=r(55509),m=r(25028),h=r(46059),x=r(14163),f=r(8730),g=r(65551),j=r(63376),v=r(11490),y="Popover",[b,w]=(0,o.A)(y,[p.Bk]),N=(0,p.Bk)(),[A,C]=b(y),R=e=>{let{__scopePopover:t,children:r,open:i,defaultOpen:n,onOpenChange:o,modal:l=!1}=e,d=N(t),c=a.useRef(null),[m,h]=a.useState(!1),[x=!1,f]=(0,g.i)({prop:i,defaultProp:n,onChange:o});return(0,s.jsx)(p.bL,{...d,children:(0,s.jsx)(A,{scope:t,contentId:(0,u.B)(),triggerRef:c,open:x,onOpenChange:f,onOpenToggle:a.useCallback(()=>f(e=>!e),[f]),hasCustomAnchor:m,onCustomAnchorAdd:a.useCallback(()=>h(!0),[]),onCustomAnchorRemove:a.useCallback(()=>h(!1),[]),modal:l,children:r})})};R.displayName=y;var P="PopoverAnchor";a.forwardRef((e,t)=>{let{__scopePopover:r,...i}=e,n=C(P,r),o=N(r),{onCustomAnchorAdd:l,onCustomAnchorRemove:d}=n;return a.useEffect(()=>(l(),()=>d()),[l,d]),(0,s.jsx)(p.Mz,{...o,...i,ref:t})}).displayName=P;var k="PopoverTrigger",I=a.forwardRef((e,t)=>{let{__scopePopover:r,...a}=e,o=C(k,r),l=N(r),d=(0,n.s)(t,o.triggerRef),c=(0,s.jsx)(x.sG.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":z(o.open),...a,ref:d,onClick:(0,i.m)(e.onClick,o.onOpenToggle)});return o.hasCustomAnchor?c:(0,s.jsx)(p.Mz,{asChild:!0,...l,children:c})});I.displayName=k;var T="PopoverPortal",[_,q]=b(T,{forceMount:void 0}),M=e=>{let{__scopePopover:t,forceMount:r,children:a,container:i}=e,n=C(T,t);return(0,s.jsx)(_,{scope:t,forceMount:r,children:(0,s.jsx)(h.C,{present:r||n.open,children:(0,s.jsx)(m.Z,{asChild:!0,container:i,children:a})})})};M.displayName=T;var E="PopoverContent",O=a.forwardRef((e,t)=>{let r=q(E,e.__scopePopover),{forceMount:a=r.forceMount,...i}=e,n=C(E,e.__scopePopover);return(0,s.jsx)(h.C,{present:a||n.open,children:n.modal?(0,s.jsx)(F,{...i,ref:t}):(0,s.jsx)(S,{...i,ref:t})})});O.displayName=E;var F=a.forwardRef((e,t)=>{let r=C(E,e.__scopePopover),o=a.useRef(null),l=(0,n.s)(t,o),d=a.useRef(!1);return a.useEffect(()=>{let e=o.current;if(e)return(0,j.Eq)(e)},[]),(0,s.jsx)(v.A,{as:f.DX,allowPinchZoom:!0,children:(0,s.jsx)(D,{...e,ref:l,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,i.m)(e.onCloseAutoFocus,e=>{e.preventDefault(),d.current||r.triggerRef.current?.focus()}),onPointerDownOutside:(0,i.m)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;d.current=2===t.button||r},{checkForDefaultPrevented:!1}),onFocusOutside:(0,i.m)(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),S=a.forwardRef((e,t)=>{let r=C(E,e.__scopePopover),i=a.useRef(!1),n=a.useRef(!1);return(0,s.jsx)(D,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(i.current||r.triggerRef.current?.focus(),t.preventDefault()),i.current=!1,n.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(i.current=!0,"pointerdown"===t.detail.originalEvent.type&&(n.current=!0));let s=t.target;r.triggerRef.current?.contains(s)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&n.current&&t.preventDefault()}})}),D=a.forwardRef((e,t)=>{let{__scopePopover:r,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:n,disableOutsidePointerEvents:o,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:h,onInteractOutside:x,...f}=e,g=C(E,r),j=N(r);return(0,d.Oh)(),(0,s.jsx)(c.n,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:i,onUnmountAutoFocus:n,children:(0,s.jsx)(l.qW,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:x,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:h,onDismiss:()=>g.onOpenChange(!1),children:(0,s.jsx)(p.UC,{"data-state":z(g.open),role:"dialog",id:g.contentId,...j,...f,ref:t,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),U="PopoverClose";function z(e){return e?"open":"closed"}a.forwardRef((e,t)=>{let{__scopePopover:r,...a}=e,n=C(U,r);return(0,s.jsx)(x.sG.button,{type:"button",...a,ref:t,onClick:(0,i.m)(e.onClick,()=>n.onOpenChange(!1))})}).displayName=U,a.forwardRef((e,t)=>{let{__scopePopover:r,...a}=e,i=N(r);return(0,s.jsx)(p.i3,{...i,...a,ref:t})}).displayName="PopoverArrow";var G=r(4780);let $=R,L=I,B=a.forwardRef(({className:e,align:t="center",sideOffset:r=4,...a},i)=>(0,s.jsx)(M,{children:(0,s.jsx)(O,{ref:i,align:t,sideOffset:r,className:(0,G.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));B.displayName=O.displayName},86447:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]])},91645:e=>{"use strict";e.exports=require("net")},91821:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>l,TN:()=>c,XL:()=>d});var s=r(60687),a=r(43210),i=r(24224),n=r(4780);let o=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=a.forwardRef(({className:e,variant:t,...r},a)=>(0,s.jsx)("div",{ref:a,role:"alert",className:(0,n.cn)(o({variant:t}),e),...r}));l.displayName="Alert";let d=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("h5",{ref:r,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",e),...t}));d.displayName="AlertTitle";let c=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",e),...t}));c.displayName="AlertDescription"},91840:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]])},93993:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/chef/dashboard/receipts/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/chef/dashboard/receipts/page.tsx","default")},94735:e=>{"use strict";e.exports=require("events")},95427:(e,t,r)=>{"use strict";r.d(t,{ai:()=>i});var s=r(37612),a=r(56758);process.env.GOOGLE_API_KEY?console.log("Genkit: GOOGLE_API_KEY found (first 5 chars):",process.env.GOOGLE_API_KEY.substring(0,5)+"..."):console.warn("Genkit: GOOGLE_API_KEY is NOT defined in environment variables. AI features requiring this key (especially server-side flows or Genkit dev server) will fail.");let i=(0,s.genkit)({plugins:[(0,a.YF)({})]})},96373:(e,t,r)=>{Promise.resolve().then(r.bind(r,93993))}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,6706,1658,474,3033,2105,417,399,3437,5509,9345,3084,8598,2628,8574],()=>r(954));module.exports=s})();