(()=>{var e={};e.id=1621,e.ids=[1621],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3662:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82614).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11048:(e,t,s)=>{Promise.resolve().then(s.bind(s,95788))},11516:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82614).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},14975:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82614).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},24200:(e,t,s)=>{Promise.resolve().then(s.bind(s,47051))},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29596:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82614).A)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},33873:e=>{"use strict";e.exports=require("path")},33886:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82614).A)("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]])},34631:e=>{"use strict";e.exports=require("tls")},34729:(e,t,s)=>{"use strict";s.d(t,{T:()=>n});var a=s(60687),r=s(43210),i=s(4780);let n=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...t}));n.displayName="Textarea"},36558:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82614).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},36644:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82614).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},37366:e=>{"use strict";e.exports=require("dns")},41936:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82614).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},47051:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/customer/dashboard/messages/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/customer/dashboard/messages/page.tsx","default")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},71766:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>l});var a=s(65239),r=s(48088),i=s(88170),n=s.n(i),o=s(30893),d={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);s.d(t,d);let l={children:["",{children:["customer",{children:["dashboard",{children:["messages",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,47051)),"/home/user/studio/src/app/customer/dashboard/messages/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,13391)),"/home/user/studio/src/app/customer/dashboard/layout.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,32416)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/home/user/studio/src/app/customer/dashboard/messages/page.tsx"],m={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/customer/dashboard/messages/page",pathname:"/customer/dashboard/messages",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},89667:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var a=s(60687),r=s(43210),i=s(4780);let n=r.forwardRef(({className:e,type:t,...s},r)=>(0,a.jsx)("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...s}));n.displayName="Input"},91645:e=>{"use strict";e.exports=require("net")},92876:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82614).A)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]])},93500:(e,t,s)=>{"use strict";s.d(t,{$v:()=>f,EO:()=>p,Lt:()=>d,Rx:()=>g,Zr:()=>v,ck:()=>h,r7:()=>x,tv:()=>l,wd:()=>u});var a=s(60687),r=s(43210),i=s(97895),n=s(4780),o=s(29523);let d=i.bL,l=i.l9,c=i.ZL,m=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(i.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:s}));m.displayName=i.hJ.displayName;let p=r.forwardRef(({className:e,...t},s)=>(0,a.jsxs)(c,{children:[(0,a.jsx)(m,{}),(0,a.jsx)(i.UC,{ref:s,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));p.displayName=i.UC.displayName;let u=({className:e,...t})=>(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t});u.displayName="AlertDialogHeader";let h=({className:e,...t})=>(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});h.displayName="AlertDialogFooter";let x=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(i.hE,{ref:s,className:(0,n.cn)("text-lg font-semibold",e),...t}));x.displayName=i.hE.displayName;let f=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(i.VY,{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));f.displayName=i.VY.displayName;let g=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(i.rc,{ref:s,className:(0,n.cn)((0,o.r)(),e),...t}));g.displayName=i.rc.displayName;let v=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(i.ZD,{ref:s,className:(0,n.cn)((0,o.r)({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));v.displayName=i.ZD.displayName},94735:e=>{"use strict";e.exports=require("events")},95788:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>F});var a,r=s(60687),i=s(43210),n=s(44493),o=s(89667),d=s(29523),l=s(34729),c=s(32584),m=s(11516);let p=(0,s(82614).A)("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);var u=s(41936),h=s(92876),x=s(36558),f=s(99196),g=s(36644),v=s(33886),y=s(3662),b=s(97025),j=s(14975),N=s(85866),w=s(29596),k=s(18780),P=s(33784),A=s(75535),C=s(73437),q=s(29867),_=s(16189),I=s(93500),E="https://js.stripe.com/v3",M=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,D=function(){for(var e=document.querySelectorAll('script[src^="'.concat(E,'"]')),t=0;t<e.length;t++){var s=e[t];if(M.test(s.src))return s}return null},S=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",s=document.createElement("script");s.src="".concat(E).concat(t);var a=document.head||document.body;if(!a)throw Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(s),s},R=function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"4.6.0",startTime:t})},T=null,$=null,B=null,U=function(){return a?a:a=(null!==T?T:(T=new Promise(function(e,t){if("undefined"==typeof window||"undefined"==typeof document)return void e(null);if(window.Stripe,window.Stripe)return void e(window.Stripe);try{var s,a=D();a?a&&null!==B&&null!==$&&(a.removeEventListener("load",B),a.removeEventListener("error",$),null==(s=a.parentNode)||s.removeChild(a),a=S(null)):a=S(null),B=function(){window.Stripe?e(window.Stripe):t(Error("Stripe.js not available"))},$=function(){t(Error("Failed to load Stripe.js"))},a.addEventListener("load",B),a.addEventListener("error",$)}catch(e){t(e);return}})).catch(function(e){return T=null,Promise.reject(e)})).catch(function(e){return a=null,Promise.reject(e)})};Promise.resolve().then(function(){return U()}).catch(function(e){console.warn(e)});var z=s(30036);let H=(0,z.default)(async()=>{},{loadableGenerated:{modules:["app/customer/dashboard/messages/page.tsx -> @stripe/react-stripe-js"]},ssr:!1,loading:()=>(0,r.jsxs)("div",{className:"text-center py-4",children:[(0,r.jsx)(m.A,{className:"h-6 w-6 animate-spin mx-auto"})," Initializing Payment Gateway..."]})}),L=(0,z.default)(async()=>{},{loadableGenerated:{modules:["app/customer/dashboard/messages/page.tsx -> @/components/stripe-payment-form"]},ssr:!1,loading:()=>(0,r.jsxs)("div",{className:"text-center py-4",children:[(0,r.jsx)(m.A,{className:"h-6 w-6 animate-spin mx-auto"})," Loading Payment Form..."]})});function F(){let{user:e,userProfile:t}=(0,k.A)(),{toast:s}=(0,q.dj)(),a=(0,_.useRouter)(),E=(0,_.useSearchParams)(),M=(0,i.useRef)(null);(0,_.usePathname)();let[D,S]=(0,i.useState)([]),[R,T]=(0,i.useState)(null),[$,B]=(0,i.useState)([]),[U,z]=(0,i.useState)(""),[F,O]=(0,i.useState)(!0),[G,Z]=(0,i.useState)(!1),[Y,K]=(0,i.useState)(!1),[J,W]=(0,i.useState)(!1),[V,X]=(0,i.useState)(!1),[Q,ee]=(0,i.useState)("idle"),[et,es]=(0,i.useState)(null),[ea,er]=(0,i.useState)(!1),[ei,en]=(0,i.useState)(""),eo=e=>{T(e),z(""),ee("idle"),es(null),E.get("requestId")!==e.id&&a.replace(`/customer/dashboard/messages?requestId=${e.id}`,{scroll:!1})},ed=async()=>{if(!e||!t||!R||!U.trim())return;K(!0);let a=(0,A.H9)(P.db,"customerRequests",R.id);try{let s=(0,A.rJ)(a,"messages");await (0,A.gS)(s,{requestId:R.id,senderId:e.uid,senderName:t.name||e.displayName||"Customer",senderAvatarUrl:t.profilePictureUrl||e.photoURL||void 0,senderRole:"customer",text:U,timestamp:(0,A.O5)()});let r=R.status;("proposal_sent"===R.status||"chef_accepted"===R.status)&&(r="awaiting_customer_response"),await (0,A.mZ)(a,{updatedAt:(0,A.O5)(),status:r}),z("")}catch(e){console.error("Error sending message:",e),s({title:"Error",description:"Could not send message.",variant:"destructive"})}finally{K(!1)}},el=async e=>{X(!1),e.success&&e.paymentIntentId?(ee("awaiting_confirmation"),s({title:"Payment Processed!",description:"Finalizing your booking with the chef..."}),await ec(e.paymentIntentId)):(ee("failed"),es(e.error||"Payment failed. Please try again or contact support."),s({title:"Payment Failed",description:e.error||"An unknown error occurred.",variant:"destructive"}))},ec=async r=>{if(!R||!R.activeProposal||!e||!t){ee("failed"),es("Missing critical information to create booking."),s({title:"Booking Error",description:"Missing critical information.",variant:"destructive"});return}er(!0);let i=(0,A.H9)(P.db,"customerRequests",R.id),n=`You accepted the proposal from Chef ${R.activeProposal.chefName}. Booking confirmed. Payment ID: ${r.substring(0,10)}...`;try{let o=(0,A.wP)(P.db),d=t.name||e.displayName||"Customer";o.update(i,{status:"booked",updatedAt:(0,A.O5)()});let l=R.eventDate instanceof Date?A.Dc.fromDate(R.eventDate):R.eventDate,c=(0,A.H9)((0,A.rJ)(P.db,"bookings")),m={customerId:e.uid,customerName:d,chefId:R.activeProposal.chefId,chefName:R.activeProposal.chefName,chefAvatarUrl:R.activeProposal.chefAvatarUrl||void 0,eventTitle:R.activeProposal.menuTitle||R.eventType||"Booked Event",eventDate:l,pax:R.pax,totalPrice:R.activeProposal.menuPricePerHead*R.pax,pricePerHead:R.activeProposal.menuPricePerHead,status:"confirmed",menuTitle:R.activeProposal.menuTitle,location:R.location||void 0,requestId:R.id,paymentIntentId:r,createdAt:(0,A.O5)(),updatedAt:(0,A.O5)()};o.set(c,m);let p={chefId:m.chefId,date:m.eventDate,title:`Booking: ${m.eventTitle}`,customerName:m.customerName,pax:m.pax,menuName:m.menuTitle||"Custom Event",pricePerHead:m.pricePerHead||0,location:m.location,notes:`Booking confirmed for request ID: ${R.id}. Booking ID: ${c.id}`,status:"Confirmed",isWallEvent:!1},u=(0,A.H9)(P.db,`users/${m.chefId}/calendarEvents`,c.id);o.set(u,{...p,createdAt:(0,A.O5)(),updatedAt:(0,A.O5)()});let h=(0,A.rJ)(i,"messages"),x=(0,A.H9)(h);o.set(x,{requestId:R.id,senderId:"system",senderRole:"system",text:n,timestamp:(0,A.O5)()}),await o.commit(),ee("confirmed"),s({title:"Booking Confirmed!",description:`Your event with Chef ${m.chefName} is confirmed. Booking ID: ${c.id.substring(0,6)}... Check 'My Booked Events'.`,duration:7e3}),W(!1),a.push("/customer/dashboard/events")}catch(t){console.error("Error accepting proposal and creating booking:",t),ee("failed");let e=t instanceof Error?t.message:"Could not complete booking.";es(`Booking finalization failed. Details: ${e}`),s({title:"Booking Error",description:`Could not complete booking. Details: ${e}`,variant:"destructive"})}finally{er(!1)}},em=async a=>{if(!R||!R.activeProposal||!e||!t)return;if(ee("idle"),es(null),"accept"===a){W(!0),ee("payment_processing");return}er(!0);let r=(0,A.H9)(P.db,"customerRequests",R.id),i=`You declined the proposal from Chef ${R.activeProposal.chefName}.`;try{let e=(0,A.wP)(P.db);e.update(r,{status:"proposal_declined",activeProposal:null,updatedAt:(0,A.O5)()});let t=(0,A.rJ)(r,"messages"),a=(0,A.H9)(t);e.set(a,{requestId:R.id,senderId:"system",senderRole:"system",text:i,timestamp:(0,A.O5)()}),await e.commit(),s({title:"Proposal Declined",variant:"default",description:"The chef has been notified."})}catch(t){console.error("Error declining proposal:",t);let e=t instanceof Error?t.message:"Could not decline proposal.";s({title:"Error",description:`Could not decline proposal. Details: ${e}`,variant:"destructive"})}finally{er(!1)}},ep=D.filter(e=>e.eventType.toLowerCase().includes(ei.toLowerCase())||e.activeProposal?.chefName&&e.activeProposal.chefName.toLowerCase().includes(ei.toLowerCase())||e.proposingChef?.name&&e.proposingChef.name.toLowerCase().includes(ei.toLowerCase())),eu=e=>e?e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):"Unknown",eh=R&&R.activeProposal&&("proposal_sent"===R.status||"chef_accepted"===R.status),ex=R&&("customer_confirmed"===R.status||"booked"===R.status||"proposal_declined"===R.status||"cancelled_by_customer"===R.status);return(0,r.jsxs)("div",{className:"h-[calc(100vh-var(--header-height,10rem))] flex flex-col md:flex-row gap-6",children:[(0,r.jsxs)(n.Zp,{className:"w-full md:w-1/3 lg:w-1/4 flex flex-col shadow-lg",children:[(0,r.jsxs)(n.aR,{className:"border-b p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(n.ZB,{className:"text-xl flex items-center",children:[(0,r.jsx)(p,{className:"mr-2 h-5 w-5 text-primary","data-ai-hint":"inbox mail"})," My Requests"]}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:ep.length})]}),(0,r.jsxs)("div",{className:"relative mt-2",children:[(0,r.jsx)(u.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(o.p,{placeholder:"Search by event or chef...",className:"pl-8",value:ei,onChange:e=>en(e.target.value)})]})]}),(0,r.jsx)(n.Wu,{className:"p-0 flex-grow overflow-y-auto",children:F?(0,r.jsxs)("div",{className:"p-4 text-center text-muted-foreground flex items-center justify-center h-full",children:[(0,r.jsx)(m.A,{className:"h-5 w-5 animate-spin mr-2"})," Loading requests..."]}):ep.length>0?(0,r.jsx)("div",{className:"divide-y",children:ep.map(e=>(0,r.jsx)("div",{className:`p-4 hover:bg-muted/50 cursor-pointer ${R?.id===e.id?"bg-muted":""}`,onClick:()=>eo(e),children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsxs)(c.eu,{className:"h-10 w-10",children:[(0,r.jsx)(c.BK,{src:e.activeProposal?.chefAvatarUrl||e.proposingChef?.profilePictureUrl||void 0,alt:e.activeProposal?.chefName||e.proposingChef?.name||e.eventType.charAt(0),"data-ai-hint":"chef avatar"}),(0,r.jsx)(c.q5,{children:e.activeProposal?.chefName?e.activeProposal.chefName.substring(0,1).toUpperCase():e.proposingChef?e.proposingChef.name?.substring(0,1).toUpperCase():e.eventType.substring(0,1).toUpperCase()})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("p",{className:"text-sm font-semibold truncate",children:e.activeProposal?.chefName?`Chef ${e.activeProposal.chefName}`:e.proposingChef?.name?`Chef ${e.proposingChef.name}`:e.eventType}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:e.updatedAt?(0,C.GP)(new Date(e.updatedAt),"PP"):e.createdAt?(0,C.GP)(new Date(e.createdAt),"PP"):"N/A"})]}),(0,r.jsx)("p",{className:"text-xs font-medium text-primary",children:eu(e.status)}),(0,r.jsxs)("p",{className:"text-xs truncate text-muted-foreground",children:["Event: ",e.eventType]})]})]})},e.id))}):(0,r.jsx)("p",{className:"p-4 text-center text-muted-foreground",children:"No requests found."})})]}),R?(0,r.jsxs)(n.Zp,{className:"w-full md:w-2/3 lg:w-3/4 flex flex-col shadow-lg",children:[(0,r.jsxs)(n.aR,{className:"border-b p-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)(c.eu,{className:"h-10 w-10",children:[(0,r.jsx)(c.BK,{src:R.activeProposal?.chefAvatarUrl||R.proposingChef?.profilePictureUrl||void 0,alt:R.activeProposal?.chefName||R.proposingChef?.name||R.eventType.charAt(0),"data-ai-hint":"chef avatar"}),(0,r.jsx)(c.q5,{children:R.activeProposal?.chefName?R.activeProposal.chefName.substring(0,1).toUpperCase():R.proposingChef?R.proposingChef.name?.substring(0,1).toUpperCase():R.eventType.substring(0,1).toUpperCase()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(n.ZB,{className:"text-lg",children:R.activeProposal?.chefName?`Chat with Chef ${R.activeProposal.chefName}`:R.proposingChef?.name?`Chat with Chef ${R.proposingChef.name}`:R.eventType}),(0,r.jsxs)(n.BT,{className:"text-xs",children:["Request ID: ",R.id.substring(0,8),"... | Status: ",eu(R.status)]})]})]}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground space-y-0.5 text-right self-start sm:self-center",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)(h.A,{className:"inline h-3 w-3 mr-1","data-ai-hint":"calendar icon"})," Event Date: ",R.eventDate?(0,C.GP)(R.eventDate,"PP"):"N/A"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)(Users,{className:"inline h-3 w-3 mr-1","data-ai-hint":"users group"})," PAX: ",R.pax]}),(0,r.jsxs)("p",{children:[(0,r.jsx)(x.A,{className:"inline h-3 w-3 mr-1","data-ai-hint":"money dollar sign"})," Budget: $",R.budget]})]})]}),(0,r.jsxs)(n.Wu,{className:"p-6 flex-grow overflow-y-auto space-y-4",children:[G?(0,r.jsxs)("div",{className:"flex justify-center items-center h-full",children:[(0,r.jsx)(m.A,{className:"h-5 w-5 animate-spin mr-2"}),"Loading messages..."]}):0!==$.length||R.activeProposal||"idle"!==Q||ex?(0,r.jsxs)(r.Fragment,{children:[$.map(s=>(0,r.jsx)("div",{className:`flex ${s.senderId===e?.uid?"justify-end":"justify-start"}`,children:(0,r.jsxs)("div",{className:"flex items-end gap-2 max-w-[75%]",children:[s.senderId!==e?.uid&&"system"!==s.senderRole&&(0,r.jsxs)(c.eu,{className:"h-6 w-6",children:[(0,r.jsx)(c.BK,{src:s.senderAvatarUrl||void 0,alt:s.senderName||"U","data-ai-hint":"user avatar"}),(0,r.jsx)(c.q5,{children:s.senderName?s.senderName.charAt(0).toUpperCase():"chef"===s.senderRole?"C":"S"})]}),"system"===s.senderRole&&(0,r.jsx)(f.A,{className:"h-5 w-5 text-muted-foreground flex-shrink-0 self-center mr-1","data-ai-hint":"info icon"}),(0,r.jsxs)("div",{className:`px-3 py-2 rounded-xl shadow-sm ${s.senderId===e?.uid?"bg-primary text-primary-foreground":"system"===s.senderRole?"bg-amber-100 dark:bg-amber-800/30 text-amber-700 dark:text-amber-300 text-xs italic text-center w-full":"bg-muted"}`,children:[(0,r.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:s.text}),(0,r.jsx)("p",{className:`text-xs mt-1 ${s.senderId===e?.uid?"text-primary-foreground/70 text-right":"system"===s.senderRole?"hidden":"text-muted-foreground/70 text-left"}`,children:s.timestamp?(0,C.GP)(new Date(s.timestamp),"p"):"Sending..."})]}),s.senderId===e?.uid&&t&&(0,r.jsxs)(c.eu,{className:"h-6 w-6",children:[(0,r.jsx)(c.BK,{src:t.profilePictureUrl||e?.photoURL||void 0,alt:t.name||"Me","data-ai-hint":"user avatar"}),(0,r.jsx)(c.q5,{children:t.name?t.name.charAt(0).toUpperCase():"M"})]})]})},s.id)),(0,r.jsx)("div",{ref:M})]}):(0,r.jsx)("div",{className:"text-center text-muted-foreground py-8",children:"No messages yet. Await a chef's proposal or send a message if applicable."}),R.activeProposal&&("proposal_sent"===R.status||"chef_accepted"===R.status)&&"idle"===Q&&!ex&&(0,r.jsxs)(n.Zp,{className:"my-4 p-4 border shadow-md bg-sky-50 dark:bg-sky-800/30 border-sky-200 dark:border-sky-700",children:[(0,r.jsx)(n.aR,{className:"p-0 pb-2",children:(0,r.jsxs)(n.ZB,{className:"text-md flex items-center text-sky-700 dark:text-sky-300",children:[(0,r.jsx)(g.A,{className:"mr-2 h-5 w-5","data-ai-hint":"document file"}),"Proposal from Chef ",R.activeProposal.chefName]})}),(0,r.jsxs)(n.Wu,{className:"p-0 text-sm space-y-1 text-sky-800 dark:text-sky-200",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)(v.A,{className:"inline h-4 w-4 mr-1 text-muted-foreground","data-ai-hint":"briefcase icon"}),"Menu: ",(0,r.jsx)("strong",{children:R.activeProposal.menuTitle})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)(x.A,{className:"inline h-4 w-4 mr-1 text-muted-foreground","data-ai-hint":"money dollar"}),"Price: ",(0,r.jsxs)("strong",{children:["$",R.activeProposal.menuPricePerHead.toFixed(2)," per head"]})," (Total: $",(R.activeProposal.menuPricePerHead*R.pax).toFixed(2),")"]}),R.activeProposal.notes&&(0,r.jsxs)("p",{children:[(0,r.jsx)(f.A,{className:"inline h-4 w-4 mr-1 text-muted-foreground","data-ai-hint":"info icon"}),"Notes: ",R.activeProposal.notes]})]}),eh&&(0,r.jsxs)(n.wL,{className:"p-0 pt-3 flex gap-2",children:[(0,r.jsxs)(d.$,{onClick:()=>em("accept"),size:"sm",className:"bg-green-600 hover:bg-green-700",disabled:"idle"!==Q||ea||V,children:[(0,r.jsx)(y.A,{className:"h-4 w-4 mr-1.5","data-ai-hint":"check circle"})," Accept & Proceed to Pay"]}),(0,r.jsxs)(d.$,{onClick:()=>em("decline"),size:"sm",variant:"outline",disabled:"idle"!==Q||ea||V,children:[(0,r.jsx)(b.A,{className:"h-4 w-4 mr-1.5","data-ai-hint":"cross circle"})," Decline Proposal"]})]})]}),"customer_confirmed"===R.status&&"confirmed"!==Q&&"awaiting_confirmation"!==Q&&(0,r.jsxs)("div",{className:"text-sm text-green-700 dark:text-green-400 mt-2 font-medium p-3 rounded-md bg-green-50 dark:bg-green-800/30 border border-green-200 dark:border-green-700 text-center",children:[(0,r.jsx)(y.A,{className:"inline h-5 w-5 mr-2","data-ai-hint":"check circle"})," You have accepted the proposal! Booking is being finalized."]}),"booked"===R.status&&"confirmed"!==Q&&(0,r.jsxs)("div",{className:"text-sm text-green-700 dark:text-green-400 mt-2 font-medium p-3 rounded-md bg-green-50 dark:bg-green-800/30 border border-green-200 dark:border-green-700 text-center",children:[(0,r.jsx)(y.A,{className:"inline h-5 w-5 mr-2","data-ai-hint":"check circle"})," This request has been booked. Check 'My Booked Events'."]}),"proposal_declined"===R.status&&(0,r.jsxs)("div",{className:"text-sm text-red-700 dark:text-red-400 mt-2 font-medium p-3 rounded-md bg-red-50 dark:bg-red-800/30 border border-red-200 dark:border-red-700 text-center",children:[(0,r.jsx)(b.A,{className:"inline h-5 w-5 mr-2","data-ai-hint":"cross circle"})," You have declined this proposal."]}),"awaiting_confirmation"===Q&&(0,r.jsxs)("div",{className:"text-sm text-blue-600 dark:text-blue-400 mt-2 font-medium p-3 rounded-md bg-blue-50 dark:bg-blue-800/30 border border-blue-200 dark:border-blue-700 text-center flex items-center justify-center",children:[(0,r.jsx)(m.A,{className:"animate-spin h-5 w-5 mr-2"})," Payment processed. Finalizing your booking, please wait..."]}),"confirmed"===Q&&(0,r.jsxs)("div",{className:"text-sm text-green-700 dark:text-green-400 mt-2 font-medium p-3 rounded-md bg-green-50 dark:bg-green-800/30 border border-green-200 dark:border-green-700 text-center",children:[(0,r.jsx)(y.A,{className:"inline h-5 w-5 mr-2","data-ai-hint":"check circle"})," Booking confirmed! Check 'My Booked Events' for details."]}),"failed"===Q&&et&&(0,r.jsxs)("div",{className:"text-sm text-red-700 dark:text-red-400 mt-2 font-medium p-3 rounded-md bg-red-50 dark:bg-red-800/30 border border-red-200 dark:border-red-700 text-center",children:[(0,r.jsx)(j.A,{className:"inline h-5 w-5 mr-2","data-ai-hint":"warning triangle"})," ",et]})]}),(0,r.jsxs)(n.wL,{className:"p-4 border-t flex flex-col space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center text-xs text-muted-foreground p-2 rounded-md bg-muted/50 border border-dashed w-full",children:[(0,r.jsx)(j.A,{className:"h-4 w-4 mr-2 text-yellow-600 flex-shrink-0","data-ai-hint":"warning triangle"}),(0,r.jsx)("span",{children:"Remember: Keep all communication and payment on FindAChef. Do not share personal contact details."})]}),(0,r.jsxs)("div",{className:"flex w-full items-center space-x-2",children:[(0,r.jsx)(l.T,{placeholder:ex||"idle"!==Q||ea||V?"Conversation ended or action pending.":"Type your message...",value:U,onChange:e=>z(e.target.value),className:"flex-1 min-h-[40px] max-h-[120px]",rows:1,disabled:Y||ex||"idle"!==Q||ea||V,onKeyDown:e=>{"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),!U.trim()||ex||"idle"!==Q||ea||V||ed())}}),(0,r.jsxs)(d.$,{type:"button",size:"icon",onClick:ed,disabled:Y||!U.trim()||ex||"idle"!==Q||ea||V,children:[Y?(0,r.jsx)(m.A,{className:"animate-spin h-5 w-5"}):(0,r.jsx)(N.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"sr-only",children:"Send"})]})]})]})]}):(0,r.jsxs)("div",{className:"w-full md:w-2/3 lg:w-3/4 flex flex-col items-center justify-center text-center p-10 bg-muted/30 rounded-lg shadow-lg",children:[(0,r.jsx)(p,{className:"h-16 w-16 text-muted-foreground mb-4","data-ai-hint":"empty inbox messages"}),(0,r.jsx)("p",{className:"text-lg font-semibold text-muted-foreground",children:"Select a request from the left to view messages and details."}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your conversations with chefs will appear here."})]}),R&&R.activeProposal&&(0,r.jsx)(I.Lt,{open:J,onOpenChange:e=>{(V||ea)&&e||("awaiting_confirmation"!==Q||V||e||ee("idle"),W(e))},children:(0,r.jsxs)(I.EO,{children:[(0,r.jsxs)(I.wd,{children:[(0,r.jsxs)(I.r7,{className:"flex items-center",children:[(0,r.jsx)(w.A,{className:"mr-2 h-5 w-5 text-primary","data-ai-hint":"credit card"}),"Confirm Booking & Payment"]}),(0,r.jsxs)(I.$v,{className:"text-left space-y-2 pt-2",children:[(0,r.jsxs)("p",{children:["You are about to accept the proposal from ",(0,r.jsxs)("strong",{children:["Chef ",R.activeProposal.chefName]})," for: ",(0,r.jsxs)("strong",{children:['"',R.activeProposal.menuTitle||R.eventType,'"']}),"."]}),(0,r.jsxs)("p",{children:["Total Price: ",(0,r.jsxs)("strong",{className:"text-lg",children:["AUD ",(R.activeProposal.menuPricePerHead*R.pax).toFixed(2)]}),"."]}),"payment_processing"===Q&&!V&&!ea&&(0,r.jsxs)("div",{className:"text-sm text-blue-600 flex items-center justify-center py-2",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 animate-spin mr-2"})," Verifying payment details..."]}),(ea||"awaiting_confirmation"===Q)&&!et&&(0,r.jsxs)("div",{className:"text-sm text-blue-600 flex items-center justify-center py-2",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 animate-spin mr-2"})," Finalizing your booking, please wait..."]}),et&&"failed"===Q&&(0,r.jsxs)("div",{className:"text-sm text-destructive flex items-center justify-center py-2",children:[(0,r.jsx)(j.A,{className:"h-4 w-4 mr-2"})," ",et]})]})]}),"payment_processing"===Q&&(0,r.jsx)(H,{children:(0,r.jsx)(L,{customerName:t?.name||e?.displayName||"Customer",customerEmail:e?.email||"",totalPrice:R.activeProposal.menuPricePerHead*R.pax,onPaymentAttemptComplete:el,isProcessingPayment:V,setIsProcessingPayment:X,requestId:R.id,customerId:e?.uid||""})}),(0,r.jsx)(I.ck,{className:"mt-2",children:(0,r.jsx)(I.Zr,{onClick:()=>{W(!1),ee("idle"),es(null),X(!1),er(!1)},disabled:V||ea||"awaiting_confirmation"===Q,children:"Cancel"})})]})})]})}},97025:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82614).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},99196:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(82614).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[4447,6706,1658,417,399,3437,7895,2628,2776],()=>s(71766));module.exports=a})();